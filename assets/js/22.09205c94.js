(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{384:function(s,a,t){"use strict";t.r(a);var r=t(11),e=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"linux日志分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux日志分析"}},[s._v("#")]),s._v(" linux日志分析")]),s._v(" "),a("h2",{attrs:{id:"前置知识补充"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置知识补充"}},[s._v("#")]),s._v(" 前置知识补充")]),s._v(" "),a("p",[s._v("常见日志文件")]),s._v(" "),a("p",[s._v("Linux系统中的日志文件通常存储在"),a("code",[s._v("/var/log")]),s._v("目录下，记录下我感兴趣的日志文件")]),s._v(" "),a("ul",[a("li",[s._v("/var/log/syslog：记录系统的各种信息和错误。")]),s._v(" "),a("li",[s._v("/var/log/auth.log：记录身份验证相关的信息，如ssh登录和认证失败。")]),s._v(" "),a("li",[s._v("/var/log/httpd/：记录Apache HTTP服务器的访问和错误日志（若安装了Apache）。")]),s._v(" "),a("li",[s._v("/var/log/nginx/：记录Nginx服务器的访问和错误日志（若安装了Nginx）。")]),s._v(" "),a("li",[s._v("/var/log/secure：记录安全相关的消息。")]),s._v(" "),a("li",[s._v("/var/log/kern.log：记录内核生成的日志信息。")]),s._v(" "),a("li",[s._v("/var/log/dmesg：记录系统启动时内核产生的消息。")]),s._v(" "),a("li",[s._v("/var/log/boot.log：记录系统启动过程中的消息。")]),s._v(" "),a("li",[s._v("/var/log/messages：记录系统的广泛消息，包括启动和应用程序信息。")])]),s._v(" "),a("p",[s._v("一些重点日志")]),s._v(" "),a("p",[a("code",[s._v("/var/log/auth.log")])]),s._v(" "),a("p",[s._v("auth.log 会记录ssh登录，sudo权限等内容。它通常包含系统关于用户登录、登录失败、权限提升（如 sudo 操作）、认证请求、会话启动和关闭等方面的信息。")]),s._v(" "),a("ul",[a("li",[s._v('用户注册："new user"，创建新的用户')]),s._v(" "),a("li",[s._v("用户登录：成功的 "),a("code",[s._v("SSH")]),s._v(" 登录（通过 "),a("code",[s._v("sshd")]),s._v(" 服务），登录的时间、用户名、来源 IP 地址等信息")]),s._v(" "),a("li",[s._v("登录失败：失败的 "),a("code",[s._v("SSH")]),s._v(" 登录尝试，登录的时间、用户名、来源 IP 地址等信息")]),s._v(" "),a("li",[s._v("用户注销：用户注销信息，包括成功或失败的会话关闭")]),s._v(" "),a("li",[s._v("权限提升：用户尝试使用 "),a("code",[s._v("sudo")]),s._v(" 或其他权限提升命令，包括成功或失败的尝试")]),s._v(" "),a("li",[s._v("su 命令（切换用户）：用户通过 su 命令切换用户的日志，记录目标用户和源用户")]),s._v(" "),a("li",[s._v("SSH 公钥认证：使用公钥认证登录过程，会记录登录成功失败的信息")])]),s._v(" "),a("p",[a("code",[s._v("/var/log/syslog")])]),s._v(" "),a("p",[s._v("系统级别的日志文件，可能会包含 useradd、adduser 或 usermod 等命令的相关记录。")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Nov 18 12:34:56 server useradd[12345]: new user 'testuser' added\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("code",[s._v("/var/log/nginx/access.log")])]),s._v(" "),a("p",[s._v("Nginx 的访问日志，记录了所有客户端对 Nginx 服务器的访问请求，包括请求的 URL、请求方法、客户端 IP 地址、响应状态码、响应大小等信息。")]),s._v(" "),a("h2",{attrs:{id:"环境及要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境及要求"}},[s._v("#")]),s._v(" 环境及要求")]),s._v(" "),a("p",[s._v("账号root密码linuxrz")]),s._v(" "),a("p",[s._v("ssh root@IP")]),s._v(" "),a("ul",[a("li",[s._v('1.有多少IP在爆破主机ssh的root帐号，如果有多个使用","分割')]),s._v(" "),a("li",[s._v('2.ssh爆破成功登陆的IP是多少，如果有多个使用","分割')]),s._v(" "),a("li",[s._v('3.爆破用户名字典是什么？如果有多个使用","分割')]),s._v(" "),a("li",[s._v("4.登陆成功的IP共爆破了多少次")]),s._v(" "),a("li",[s._v("5.黑客登陆主机后新建了一个后门用户，用户名是多少")])]),s._v(" "),a("h2",{attrs:{id:"_1-有多少ip在爆破主机ssh的root帐号-如果有多个使用-分割"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-有多少ip在爆破主机ssh的root帐号-如果有多个使用-分割"}},[s._v("#")]),s._v(' 1.有多少IP在爆破主机ssh的root帐号，如果有多个使用","分割')]),s._v(" "),a("p",[s._v("linux日志系统会保存ssh的记录，一般来说，SSH登录尝试会记录在 /var/log/auth.log.1（这是固定的）")]),s._v(" "),a("p",[s._v("常见的爆破攻击痕迹")]),s._v(" "),a("ul",[a("li",[s._v("攻击者在用暴力破解的方式测试不同的用户名和密码")]),s._v(" "),a("li",[s._v("Failed password for root from 192.168.1.100 记录到某ip爆破root用户")]),s._v(" "),a("li",[s._v("Failed password for invalid user admin from 192.168.1.100 记录到某ip尝试爆破不存在的admin用户")])]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Nov 18 12:34:56 server sshd[12345]: Failed password for root from 192.168.1.100 port 54321 ssh2\nNov 18 12:34:57 server sshd[12345]: Failed password for invalid user admin from 192.168.1.100 port 54321 ssh2\nNov 18 12:34:58 server sshd[12345]: Connection closed by authenticating user root 192.168.1.100 port 54321 [preauth]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("查看"),a("code",[s._v("auth.log")]),s._v('文件，找找包含"Failed password for root"的记录，提取ip')]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" auth.log.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed password for root"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $11}'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nr")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("cat auth.log.1  将日志文件 auth.log.1 的内容输出到标准输出")]),s._v(" "),a("li",[s._v('grep -a "Failed password for root" 过滤日志文件中的内容，仅保留包含字符串 Failed password for root 的行')]),s._v(" "),a("li",[s._v("awk '{print $11}' 在"),a("code",[s._v("SSH")]),s._v("日志中，第 11 列通常是登录尝试来源的 IP 地址，提取ip")]),s._v(" "),a("li",[s._v("sort 对提取出的 IP 地址进行排序")]),s._v(" "),a("li",[s._v("uniq -c 统计每个"),a("code",[s._v("IP")]),s._v("爆破次数")]),s._v(" "),a("li",[s._v("sort -nr 按次数降序排序")]),s._v(" "),a("li",[s._v("more 分页显示结果")])]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("4 192.168.200.2\n1 192.168.200.32\n1 192.168.200.31\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("flag{192.168.200.2,192.168.200.32,192.168.200.31}")]),s._v(" "),a("h2",{attrs:{id:"_2-ssh爆破成功登陆的ip是多少-如果有多个使用-分割"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ssh爆破成功登陆的ip是多少-如果有多个使用-分割"}},[s._v("#")]),s._v(' 2.ssh爆破成功登陆的IP是多少，如果有多个使用","分割')]),s._v(" "),a("p",[s._v("关于"),a("code",[s._v("ssh")]),s._v("登录成功的日志记录信息")]),s._v(" "),a("p",[a("strong",[s._v("Ubuntu/Debian 系统")])]),s._v(" "),a("p",[s._v("日志存储在 /var/log/auth.log 中，登录成功的记录类似：")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Nov 18 12:45:10 server sshd[12345]: Accepted password for root from 192.168.1.100 port 54321 ssh2\nNov 18 12:45:10 server sshd[12345]: pam_unix(sshd:session): session opened for user root by (uid=0)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("CentOS/RHEL 系统")])]),s._v(" "),a("p",[s._v("日志存储在 /var/log/secure 中，登录成功的记录类似：")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Nov 18 12:45:10 server sshd[12345]: Accepted password for root from 192.168.1.100 port 54321 ssh2\nNov 18 12:45:10 server sshd[12345]: pam_unix(sshd:session): session opened for user root by (uid=0)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("找一下成功登录的ip记录")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("cat auth.log.1 | grep -a \"Accepted \" | awk '{print $11}' | sort | uniq -c | sort -nr | more\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("flag{192.168.200.2}")]),s._v(" "),a("h2",{attrs:{id:"_3-爆破用户名字典是什么-如果有多个使用-分割"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-爆破用户名字典是什么-如果有多个使用-分割"}},[s._v("#")]),s._v(' 3.爆破用户名字典是什么？如果有多个使用","分割')]),s._v(" "),a("p",[s._v("在ssh日志中，登录失败的记录中，会记录尝试的用户名")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Nov 18 12:34:57 server sshd[12345]: Failed password for invalid user admin from 192.168.1.100 port 54321 ssh2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("查一下爆破的用户名")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" auth.log.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed password for invalid user"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $11}'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nr")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行的结果：")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("5 user\n5 hello\n5 from\n1 test3\n1 test2\n1 test1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("这里是错的，惯性思维直接简单修改了一下上面的命令。在匹配类似日志时，错误的匹配到了一个"),a("code",[s._v("from")]),s._v("，这是为什么？把包含"),a("code",[s._v("Failed password for invalid user")]),s._v("的行整个都打出来看看")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ctf@linux$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" auth.log.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed password for invalid user"')]),s._v("\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:40:50 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7461")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user test1 from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.35 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33874")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:41:04 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7465")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user test2 from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.35 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51640")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:41:13 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7468")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user test3 from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.35 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48168")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:41 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7475")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user user from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36149")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:47 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7478")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user user from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44425")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:50 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7480")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user user from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("38791")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:54 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7482")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user user from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37489")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:56 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7484")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user user from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35575")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:46:59 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7486")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user hello from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35833")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:02 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7489")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user hello from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37653")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:04 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7491")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user hello from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37917")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:08 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7493")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user hello from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41957")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:10 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7495")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user hello from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39685")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:26 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7525")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user  from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37013")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:30 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7528")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user  from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37545")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:32 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7530")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user  from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39111")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:35 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7532")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user  from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35173")]),s._v(" ssh2\nAug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 07:47:39 linux-rz sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7534")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" invalid user  from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.2 port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45807")]),s._v(" ssh2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("通过日志可以发现，最后匹配到from的列因为"),a("strong",[s._v("用户名为空")]),s._v("，从而匹配到了后面的from")]),s._v(" "),a("p",[s._v("flag{user,hello,test3,test2,test1}")]),s._v(" "),a("h2",{attrs:{id:"_4-登陆成功的ip共爆破了多少次"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-登陆成功的ip共爆破了多少次"}},[s._v("#")]),s._v(" 4.登陆成功的IP共爆破了多少次")]),s._v(" "),a("p",[s._v("通过要求2可以知道，ip："),a("code",[s._v("192.168.200.2")]),s._v("在成功登上root了，找一下他的爆破记录")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" auth.log.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed password for root"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.200.2"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Aug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2\nAug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2\nAug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2\nAug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_5-黑客登陆主机后新建了一个后门用户-用户名是多少"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-黑客登陆主机后新建了一个后门用户-用户名是多少"}},[s._v("#")]),s._v(" 5.黑客登陆主机后新建了一个后门用户，用户名是多少")]),s._v(" "),a("p",[s._v("查看新建的用户的常见步骤：")]),s._v(" "),a("p",[a("strong",[s._v("确定日志文件")]),s._v(":")]),s._v(" "),a("p",[s._v("通常与用户登录和用户管理活动相关的日志文件是 "),a("code",[s._v("/var/log/auth.log")]),s._v(" 或其备份文件如 "),a("code",[s._v("/var/log/auth.log.1")])]),s._v(" "),a("p",[a("strong",[s._v("搜索创建用户的关键字")]),s._v("：")]),s._v(" "),a("p",[s._v("使用 grep 命令搜索与创建用户相关的关键字，如 new user。这样可以找到所有新建用户的日志条目。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/log/auth.log.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"new user"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("提取新用户信息")])]),s._v(" "),a("p",[s._v("从日志中提取新用户的详细信息，包括用户名、创建时间等。")]),s._v(" "),a("p",[s._v("例如，假设你得到了如下输出：")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这条日志显示了创建的新用户 "),a("code",[s._v("test2")])]),s._v(" "),a("p",[a("strong",[s._v("分析执行上下文")])]),s._v(" "),a("p",[s._v("确认新用户的创建是否由合法用户执行，或是否有可疑的远程登录记录。")]),s._v(" "),a("p",[s._v("可以使用以下命令查找所有用户登录的情况，以确定是否有可疑的登录行为：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accepted"')]),s._v(" /var/log/auth.log.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("进一步确认")])]),s._v(" "),a("p",[s._v("结合其他日志文件，如 "),a("code",[s._v("/var/log/syslog")]),s._v("，查看是否有异常的命令执行或系统变更。")]),s._v(" "),a("p",[s._v("**总结")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("确定相关日志文件")]),s._v("。")]),s._v(" "),a("li",[a("strong",[s._v("搜索特定关键字")]),s._v("，找到新用户创建的记录。")]),s._v(" "),a("li",[a("strong",[s._v("提取并分析详细信息")]),s._v("，确认新用户的合法性。")]),s._v(" "),a("li",[a("strong",[s._v("结合其他日志文件")]),s._v("，确认是否有异常活动。")])]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("/var/log/auth.log")]),s._v("里查询到新建两个用户，不知道哪个是后门用户")]),s._v(" "),a("div",{staticClass:"language-plaintext line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[s._v("Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh\nAug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("这道题先创建的test2，后创建的debian，为什么说黑客创建的用户是test2呢？")]),s._v(" "),a("p",[s._v("参考、致谢：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/administratorlws/article/details/139560740",target:"_blank",rel:"noopener noreferrer"}},[s._v("玄机——第一章 应急响应-Linux日志分析 wp"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/qq_46343633/article/details/139443874",target:"_blank",rel:"noopener noreferrer"}},[s._v("玄机靶第一章 应急响应-Linux日志分析"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);