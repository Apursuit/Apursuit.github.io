(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{440:function(a,s,t){"use strict";t.r(s);var e=t(11),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("大学课程"),s("code",[a._v("linux操作系统")]),a._v("平时作业，简单记录FTP搭建过程")]),a._v(" "),s("ul",[s("li",[a._v("ftp服务端：CentOS 7")]),a._v(" "),s("li",[a._v("用户：root")])]),a._v(" "),s("p",[a._v("附前置基础教程：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.51cto.com/u_12192/10885134",target:"_blank",rel:"noopener noreferrer"}},[a._v("centos 是否最小化安装 centos7最小化安装步骤"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1829993",target:"_blank",rel:"noopener noreferrer"}},[a._v("服务器安装Centos7"),s("OutboundLink")],1)])]),a._v(" "),s("h2",{attrs:{id:"ip问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ip问题"}},[a._v("#")]),a._v(" ip问题")]),a._v(" "),s("p",[a._v("问题：安装centos后，ssh连接不显示ipv4")]),a._v(" "),s("p",[a._v("解决方案：")]),a._v(" "),s("p",[a._v("参考文章"),s("br"),a._v(" "),s("a",{attrs:{href:"https://blog.csdn.net/keepkind/article/details/128890618",target:"_blank",rel:"noopener noreferrer"}},[a._v("centos解决不显示ipv4"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("到"),s("code",[a._v("/etc/sysconfig/network-scripts")]),a._v("目录下修改配置文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/sysconfig/network-scripts\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" ifcfg-ens33\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("将最后的ONBOOT=no改为ONEBOOT=yes")]),a._v(" "),s("p",[a._v("重启")]),a._v(" "),s("h2",{attrs:{id:"dns无法解析域名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dns无法解析域名"}},[a._v("#")]),a._v(" dns无法解析域名")]),a._v(" "),s("p",[a._v("问题描述：可以ping通8.8.8.8，ping不通域名")]),a._v(" "),s("p",[a._v("解决方案：")]),a._v(" "),s("p",[a._v("修改"),s("code",[a._v("/etc/resolv.conf")]),a._v("文件，添加nameserver dns服务器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/resolv.conf\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("谷歌、cloudflare、阿里云、腾讯dns")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Generated by NetworkManager")]),a._v("\nsearch localdomain\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.8")]),a._v(".8.8\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.8")]),a._v(".4.4\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.1")]),a._v(".1.1\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v(".0.1\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("223.5")]),a._v(".5.5\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("223.6")]),a._v(".6.6\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("114.114")]),a._v(".114.114\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("114.114")]),a._v(".115.115\nnameserver "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("119.29")]),a._v(".29.29\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("h2",{attrs:{id:"换源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#换源"}},[a._v("#")]),a._v(" 换源")]),a._v(" "),s("p",[a._v("换源，修改CentOS7默认源配置文件"),s("code",[a._v("/etc/yum.repos.d/CentOS-Base.repo")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /etc/yum.repos.d/CentOS-Base.repo\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/yum.repos.d/CentOS-Base.repo\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("粘贴入以下配置文件")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("base")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("CentOS-$releasever - Base - mirrors.aliyun.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("failovermethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("priority")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/$releasever/os/$basearch/")]),a._v("\n        http://mirrors.aliyuncs.com/centos/$releasever/os/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/os/$basearch/\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("updates")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("CentOS-$releasever - Updates - mirrors.aliyun.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("failovermethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("priority")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/$releasever/updates/$basearch/")]),a._v("\n        http://mirrors.aliyuncs.com/centos/$releasever/updates/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/updates/$basearch/\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("extras")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("CentOS-$releasever - Extras - mirrors.aliyun.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("failovermethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("priority")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/$releasever/extras/$basearch/")]),a._v("\n        http://mirrors.aliyuncs.com/centos/$releasever/extras/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/extras/$basearch/\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("centosplus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("CentOS-$releasever - Plus - mirrors.aliyun.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("failovermethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("priority")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/$releasever/centosplus/$basearch/")]),a._v("\n        http://mirrors.aliyuncs.com/centos/$releasever/centosplus/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/centosplus/$basearch/\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("contrib")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("CentOS-$releasever - Contrib - mirrors.aliyun.com")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("failovermethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("priority")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/$releasever/contrib/$basearch/")]),a._v("\n        http://mirrors.aliyuncs.com/centos/$releasever/contrib/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/contrib/$basearch/\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br")])]),s("p",[a._v("更新")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum clean all\nyum makecache\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("安装个vim验证一下")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"关闭fu-k安全配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭fu-k安全配置"}},[a._v("#")]),a._v(" 关闭fu*k安全配置")]),a._v(" "),s("p",[a._v("放行ftp或者临时关闭防火墙，centos默认开启防火墙会阻止ftp连接")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl stop firewalld\nsetenforce "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\nsetsebool "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ftpd_anon_write on\nsetsebool "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ftpd_full_access on\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"安装vsftpd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装vsftpd"}},[a._v("#")]),a._v(" 安装vsftpd")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" vsftpd "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/1.png",alt:"1"}})]),a._v(" "),s("p",[a._v("创建一个"),s("code",[a._v("高危root")]),a._v("权限用户，用户的主目录是"),s("code",[a._v("/var/ftp/pub")]),a._v("，shell是"),s("code",[a._v("/sbin/nologin")]),a._v("，禁止登录")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v(" root "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" /var/ftp/pub "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /sbin/nologin ftpuser \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("更新"),s("code",[a._v("ftpuser")]),a._v("用户密码")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("passwd")]),a._v(" ftpuser\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改配置文件"),s("code",[a._v("/etc/vsftpd/vsftpd.conf")]),a._v("，反选出非注释内容（后续发现反选的做法对于新手来说并不友好）")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/vsftpd\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" vsftpd.conf vsftpd.conf.bak\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"^#"')]),a._v(" vsftpd.conf.bak "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" vsftpd.conf\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" vsftpd.conf\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/vsftpd/vsftpd.conf\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改为下面内容")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# listen 修改为YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# listen_ipv6 修改为NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br")])]),s("p",[a._v("启动服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl start vsftpd.service \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("检查服务状态，ftp服务默认在21端口")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" net-tools "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("netstat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-npal")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("tcp6       0      0 :::21                   :::*                    LISTEN      62749/vsftpd\nunix  2      [ ]         DGRAM                    87793    62749/vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h2",{attrs:{id:"配置匿名用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置匿名用户"}},[a._v("#")]),a._v(" 配置匿名用户")]),a._v(" "),s("p",[a._v("给ftp服务设置一些权限，使匿名用户、本地用户可以访问")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 允许匿名用户访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户下载，上传及修改权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_upload_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_mkdir_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户默认范围目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 匿名用户可进行的操作权限，读写")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 本地用户登录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br")])]),s("p",[a._v("创建ftp目录")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/ftp/pub\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/ftp/pub/upload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("777")]),a._v(" /var/ftp/pub\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[s("code",[a._v("直接")]),a._v("成功连接到ftp服务器，以匿名用户身份连接了ftp服务器")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/3.png",alt:"3"}})]),a._v(" "),s("h2",{attrs:{id:"配置本地用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置本地用户"}},[a._v("#")]),a._v(" 配置本地用户")]),a._v(" "),s("p",[a._v("把"),s("code",[a._v("anonmous_enable")]),a._v("修改为"),s("code",[a._v("NO")]),a._v("，此时需要用户登录才能连接了")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),s("p",[a._v("关于ftp登录root用户，如果有尝试的话会发现无法成功登录，因为ftp默认在"),s("code",[a._v("user_list")]),a._v("、"),s("code",[a._v("ftpusers")]),a._v("禁用了root用户。另外，"),s("code",[a._v("user_list")]),a._v("文件默认作为黑名单，如果在"),s("code",[a._v("vsftpd.conf")]),a._v("配置文件里设置配置项"),s("code",[a._v("userlist_deny")]),a._v("值为"),s("code",[a._v("NO")]),a._v("，则"),s("code",[a._v("user_list")]),a._v("文件作为白名单，值为"),s("code",[a._v("YES")]),a._v("时，则``user_list`文件作为黑名单")])]),a._v(" "),s("p",[a._v("本地用户配置：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/vsftpd/vsftpd.conf\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("内容：")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 允许匿名用户访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户下载，上传及修改权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_upload_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_mkdir_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户默认范围目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 匿名用户可进行的操作权限，读写")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 本地用户登录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置本地用户目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_writeable_chroot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br")])]),s("p",[a._v("给本地用户"),s("code",[a._v("ftpuser")]),a._v("对ftp目录授权")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" ftpuser:root /var/ftp/pub\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("755")]),a._v(" /var/ftp/pub\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("另外，ftp默认不允许"),s("code",[a._v("nologin")]),a._v("用户登录连接，需要修改"),s("code",[a._v("/etc/shells")]),a._v("文件，添加"),s("code",[a._v("/sbin/nologin")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/shells\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("添加")]),a._v(" "),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("/sbin/nologin\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("授权本地用户"),s("code",[a._v("ftpuser")]),a._v("对ftp目录的权限")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/ftp/pub\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/ftp/pub/upload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("777")]),a._v(" /var/ftp/pub\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("重启服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl restart vsftpd.service\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[a._v("警告")]),a._v(" "),s("p",[a._v("注意，新建本地用户密码要至少8位，否则认证失败且无法连接")])]),a._v(" "),s("p",[a._v("测试本地用户的登录、上传、下载权限")]),a._v(" "),s("p",[a._v("lftp命令交互")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("lftp ftpuser@192.168.237.129\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("如果有tls自签证书加密，忽略证书信任：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" ssl:verify-certificate no\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("put "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".txt "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 上传")]),a._v("\nget "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".txt "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("111")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 创建文件夹")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rmdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("111")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除文件夹")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/18.png",alt:"18"}})]),a._v(" "),s("p",[a._v("filezlla验证上传、下载、创建目录")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/19.png",alt:"19"}})]),a._v(" "),s("p",[s("code",[a._v("root")]),a._v("用户登录，需要取消安全配置文件"),s("code",[a._v("user_list")]),a._v("、"),s("code",[a._v("ftpusers")]),a._v("中的"),s("code",[a._v("root")]),a._v("用户限制")]),a._v(" "),s("p",[a._v("删除配置文件里的root")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/vsftpd/user_list\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/vsftpd/ftpusers\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("保存退出")]),a._v(" "),s("p",[a._v("把文件属组给"),s("code",[a._v("root")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" root:root /var/ftp/pub\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("777")]),a._v(" /var/ftp/pub\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("重启服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl restart vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/23.png",alt:"23"}})]),a._v(" "),s("p",[a._v("使用nologin用户登录时需要修改配置文件才能登录，使用其他交互shell时，可以直接登录")]),a._v(" "),s("p",[a._v("可以测试一下其他交互shell的用户：")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("user_list")]),a._v("文件里有以下注释")]),a._v(" "),s("div",{staticClass:"language-plaintext line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-plaintext"}},[s("code",[a._v("# vsftpd userlist\n# If userlist_deny=NO, only allow users in this file\n# If userlist_deny=YES (default), never allow users in this file, and\n# do not even prompt for a password.\n# Note that the default vsftpd pam config also checks /etc/vsftpd/ftpusers\n# for users that are denied.\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("如果配置项"),s("code",[a._v("userlist_deny")]),a._v("值为NO，则只允许"),s("code",[a._v("user_list")]),a._v("文件里的用户登录，如果配置项"),s("code",[a._v("userlist_deny")]),a._v("值为YES，则禁止"),s("code",[a._v("user_list")]),a._v("文件里的用户登录")]),a._v(" "),s("p",[a._v("简单说，yes时，是黑名单，no时，是白名单。默认是黑名单，也不需要管这个(毫不相干)")]),a._v(" "),s("p",[a._v("测试了一圈发现：")]),a._v(" "),s("ul",[s("li",[a._v("需要新增配置文件"),s("code",[a._v("chroot_list")]),a._v("，把本地登录用户追加进去")]),a._v(" "),s("li",[a._v("新建本地用户shell为"),s("code",[a._v("/bin/bash")]),a._v("时成功了")]),a._v(" "),s("li",[s("s",[a._v("随机添加了几个配置项")])])]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 允许匿名用户访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户下载，上传及修改权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_upload_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_mkdir_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户默认范围目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 匿名用户可进行的操作权限，读写")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 本地用户登录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置本地用户目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_writeable_chroot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br")])]),s("p",[a._v("创建本地用户，并设置密码")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" /home/test2 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/bash test2\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("passwd")]),a._v(" test2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("追加到ftp用户本地登录列表，并重启ftp服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"test2"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /etc/vsftpd/chroot_list\nsystemctl restart vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://the0n3.top/medias/ftp%E6%90%AD%E5%BB%BA/5.png",alt:"5"}})]),a._v(" "),s("h2",{attrs:{id:"tls加密"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls加密"}},[a._v("#")]),a._v(" TLS加密")]),a._v(" "),s("p",[a._v("ftp默认是明文传输，需要使用sftp协议，或者使用ssl/tls加密传输")]),a._v(" "),s("p",[a._v("生成证书、密钥，安装 openssl")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" openssl\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/4.png",alt:"4"}})]),a._v(" "),s("p",[a._v("创建一个文件夹，存放证书和密钥文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /etc/vsftpd/certs \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("使用 OpenSSL 生成一个自签名的证书和私钥")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("openssl req "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x509")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-nodes")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-days")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("365")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-newkey")]),a._v(" rsa:2048 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-keyout")]),a._v(" /etc/vsftpd/certs/vsftpd.key "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-out")]),a._v(" /etc/vsftpd/certs/vsftpd.crt\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/6.png",alt:"6"}})]),a._v(" "),s("h2",{attrs:{id:"配置ftp使用tls加密"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置ftp使用tls加密"}},[a._v("#")]),a._v(" 配置ftp使用TLS加密")]),a._v(" "),s("p",[a._v("在配置文件"),s("code",[a._v("/etc/vsftpd/vsftpd.conf")]),a._v("末尾追加一下内容，配置ftp使用自签名的TLS证书、私钥加密")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("rsa_cert_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/certs/vsftpd.crt")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("rsa_private_key_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/certs/vsftpd.key")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_local_data_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_local_logins_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_anon_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置ftp日志，方便调试")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/log/xferlog")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_ftp_protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("debug_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("p",[a._v("重启ftp服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl restart vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("连接ftps服务")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/7.png",alt:"7"}})]),a._v(" "),s("p",[a._v("在上面的配置文件里已经允许了本地用户的读写上传，在实测上传时，出现"),s("code",[a._v("响应:\t553 Could not create file.")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/8.png",alt:"8"}})]),a._v(" "),s("p",[a._v("问题描述：")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("SELinux")]),a._v("的安全配置里，禁止ftp用户写入文件")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/9.png",alt:"9"}})]),a._v(" "),s("p",[a._v("解决方案：修改安全配置，允许ftp用户写入文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("setsebool "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ftpd_anon_write on\nsetsebool "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ftpd_full_access on\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("重启ftp服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl restart vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("再次上传文件，成功上传")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/10.png",alt:"10"}})]),a._v(" "),s("h2",{attrs:{id:"使用ftp命令交互"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用ftp命令交互"}},[a._v("#")]),a._v(" 使用ftp命令交互")]),a._v(" "),s("ul",[s("li",[a._v("ftp服务端：centos 7")]),a._v(" "),s("li",[a._v("ip：192.168.237.129")]),a._v(" "),s("li",[a._v("ftp客户端：centos 7")]),a._v(" "),s("li",[a._v("ip：192.168.237.131")])]),a._v(" "),s("blockquote",[s("p",[a._v("配置tls加密后，似乎需要用lftp连接")])]),a._v(" "),s("p",[a._v("linux安装"),s("code",[a._v("lftp")]),a._v("工具连接ftp服务器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" lftp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("连接ftp服务器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("lftp test2@192.168.237.129\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("问题描述：")]),a._v(" "),s("p",[a._v("输入密码连接后，尝试任意命令都会回复"),s("code",[a._v("Fatal error: Certificate verification: Not trusted")])]),a._v(" "),s("p",[a._v("解决方案：禁用证书验证")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" ssl:verify-certificate no\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("用法")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("目录名"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("目录名"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nget "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("文件名"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\nput "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("文件名"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/11.png",alt:"11"}})]),a._v(" "),s("h2",{attrs:{id:"虚拟用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟用户"}},[a._v("#")]),a._v(" 虚拟用户")]),a._v(" "),s("p",[s("code",[a._v("最安全的一种认证模式，是专门创建出一个账号来登录FTP传输服务的，而且这个账号不能用于以SSH方式登录服务器")])]),a._v(" "),s("p",[a._v("在配置文件"),s("code",[a._v("/etc/vsftpd/vsftpd.conf")]),a._v("后追加虚拟用户相关配置项")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置虚拟用户")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/chroot_list")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("virtual_use_local_privs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("virtual")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_writeable_chroot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_config_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vusers_dir")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 被动模式配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_min_port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_max_port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30999")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br")])]),s("h3",{attrs:{id:"虚拟用户的创建与认证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟用户的创建与认证"}},[a._v("#")]),a._v(" 虚拟用户的创建与认证")]),a._v(" "),s("p",[a._v("创建用于进行 FTP 认证的用户数据库文件"),s("code",[a._v("vuser.list")]),a._v("，奇数行为账户名，偶数行为密码。例如，分别创建zhangsan 和 lisi 两个用户，密码123456")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" vuser.list\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[a._v("zhangsan\n123456\nlisi\n123456\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/12.png",alt:"12"}})]),a._v(" "),s("p",[a._v("由于明文信息既不安全，也不符合让vsftpd服务程序直接加载的格式，因此需要使用"),s("code",[a._v("db_load")]),a._v("命令用哈希（hash）算法将原始的明文信息文件转换成数据库文件，并且降低数据库文件的权限（避免其他人看到数据库文件的内容），然后再把原始的明文信息文件删除")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("db_load "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-T")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("hash")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" vuser.list vuser.db\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("600")]),a._v(" vuser.db\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" vuser.list\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/13.png",alt:"13"}})]),a._v(" "),s("p",[a._v("创建vsftpd服务程序用于存储文件的根目录以及用于虚拟用户映射的系统本地用户。vsftpd 服务用于存储文件的根目录指的是，当虚拟用户登录后所访问的默认位置")]),a._v(" "),s("p",[a._v("由于Linux 系统中的每一个文件都有所有者、所属组属性，例如使用虚拟账户“张三”新建了一个文件，但是系统中找不到账户“张三”，就会导致这个文件的权限出现错误。为此，需要再创建一个可以映射到虚拟用户的系统本地用户。简单来说，就是让虚拟用户默认登录到与之有映射关系的这个系统本地用户的家目录中。虚拟用户创建的文件的属性也都归属于这个系统本地用户，从而避免 Linux系统无法处理虚拟用户所创建文件的属性权限")]),a._v(" "),s("p",[a._v("为了方便管理FTP服务器上的数据，可以把这个系统本地用户的家目录设置为/var目录（该目录用来存放经常发生改变的数据）。并且为了安全起见，将这个系统本地用户设置为不允许登录FTP服务器，这不会影响虚拟用户登录，而且还能够避免黑客通过这个系统本地用户进行登录")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" /var/ftproot  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /sbin/nologin  virtual\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Rf")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("755")]),a._v(" /var/ftproot/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("新建一个用于虚拟用户认证的PAM文件"),s("code",[a._v("/etc/pam.d/vsftpd.vu")])]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("auth     required  pam_userdb.so db")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vuser")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("account  required  pam_userdb.so db")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vuser")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/14.png",alt:"14"}})]),a._v(" "),s("p",[a._v("把配置文件"),s("code",[a._v("vsftpd.conf")]),a._v("里pam_service_name参数的值认证文件名一并修改将 PAM 认证文件的名称修改为vsftpd.vu，")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/15.png",alt:"15"}})]),a._v(" "),s("h3",{attrs:{id:"虚拟用户设置不同权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟用户设置不同权限"}},[a._v("#")]),a._v(" 虚拟用户设置不同权限")]),a._v(" "),s("p",[a._v("账户zhangsan和lisi都是用于vsftpd服务程序认证的虚拟账户")]),a._v(" "),s("ul",[s("li",[a._v("允许张三上传、创建、修改、查看、删除文件")]),a._v(" "),s("li",[a._v("只允许李四查看文件")])]),a._v(" "),s("p",[a._v("通过vsftpd服务程序来实现这些功能")]),a._v(" "),s("p",[a._v("需新建一个目录，在里面分别创建两个以zhangsan和lisi命名的文件，其中在名为zhangsan的文件中写入允许的相关权限（使用匿名用户的参数）：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /etc/vsftpd/vusers_dir/\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /etc/vsftpd/vusers_dir/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" lisi\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" zhangsan\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("用户zhangsan的权限文件配置内容")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftproot/vuser/zhangsan")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_upload_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_mkdir_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_other_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("p",[a._v("在ftp配置文件"),s("code",[a._v("/etc/vsftpd/vsftpd.conf")]),a._v("里追加虚拟用户的配置文件路径")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_config_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vusers_dir")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("给虚拟用户"),s("code",[a._v("virtual")]),a._v("赋予ftp根目录所有权")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" virtual:virtual /var/ftproot\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("给张三用户创建专属目录")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/ftproot/vuser/zhangsan\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" virtual:virtual /var/ftproot/vuser/zhangsan\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("755")]),a._v(" /var/ftproot/vuser/zhangsan\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("最终我的配置文件内容：")]),a._v(" "),s("div",{staticClass:"language-ini line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 允许匿名用户访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户下载，上传及修改权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_upload_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_mkdir_write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置匿名用户默认范围目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 匿名用户可进行的操作权限，读写")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anon_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 本地用户登录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置本地用户目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_root")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/ftp/pub")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_writeable_chroot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd.vu")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# SSL加密配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_anon_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_tlsv1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_sslv2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_sslv3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Since ssl_enable is NO, remove these lines or adjust according to the SSL usage")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("rsa_cert_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/certs/vsftpd.crt")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("rsa_private_key_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/certs/vsftpd.key")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_local_data_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_local_logins_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_anon_data_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("force_anon_logins_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("ssl_ciphers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("HIGH")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置ftp日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/log/xferlog")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_ftp_protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("debug_ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置虚拟用户")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/chroot_list")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("virtual_use_local_privs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("virtual")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("allow_writeable_chroot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_config_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vusers_dir")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 被动模式配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_min_port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_max_port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30999")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br"),s("span",{staticClass:"line-number"},[a._v("47")]),s("br"),s("span",{staticClass:"line-number"},[a._v("48")]),s("br"),s("span",{staticClass:"line-number"},[a._v("49")]),s("br"),s("span",{staticClass:"line-number"},[a._v("50")]),s("br"),s("span",{staticClass:"line-number"},[a._v("51")]),s("br"),s("span",{staticClass:"line-number"},[a._v("52")]),s("br"),s("span",{staticClass:"line-number"},[a._v("53")]),s("br"),s("span",{staticClass:"line-number"},[a._v("54")]),s("br"),s("span",{staticClass:"line-number"},[a._v("55")]),s("br"),s("span",{staticClass:"line-number"},[a._v("56")]),s("br"),s("span",{staticClass:"line-number"},[a._v("57")]),s("br"),s("span",{staticClass:"line-number"},[a._v("58")]),s("br"),s("span",{staticClass:"line-number"},[a._v("59")]),s("br"),s("span",{staticClass:"line-number"},[a._v("60")]),s("br"),s("span",{staticClass:"line-number"},[a._v("61")]),s("br"),s("span",{staticClass:"line-number"},[a._v("62")]),s("br"),s("span",{staticClass:"line-number"},[a._v("63")]),s("br"),s("span",{staticClass:"line-number"},[a._v("64")]),s("br"),s("span",{staticClass:"line-number"},[a._v("65")]),s("br"),s("span",{staticClass:"line-number"},[a._v("66")]),s("br"),s("span",{staticClass:"line-number"},[a._v("67")]),s("br"),s("span",{staticClass:"line-number"},[a._v("68")]),s("br"),s("span",{staticClass:"line-number"},[a._v("69")]),s("br")])]),s("p",[a._v("虚拟用户写入配置文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"virtual"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /etc/vsfptd/chroot_list\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("重启服务")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl restart vsftpd\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("验证内容包括：")]),a._v(" "),s("ul",[s("li",[a._v("（1）： 张三不仅可以登录，还可以创建、改名和删除文件")]),a._v(" "),s("li",[a._v("（2）： 李四只能登录，没有其他权限")])]),a._v(" "),s("p",[a._v("登录测试发现：")]),a._v(" "),s("ul",[s("li",[a._v("用户张三可以登录、下载、上传、创建目录、删除文件等")]),a._v(" "),s("li",[a._v("用户李四只能登录、下载，不能删除文件、创建目录、上传文件等")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/17.png",alt:"17"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/16.png",alt:"16"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/21.png",alt:"21"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/22.png",alt:"22"}})]),a._v(" "),s("p",[a._v("过程很多坑，不一定是配置文件的问题，可能是防火墙、selinux，也可能是权限....其他")]),a._v(" "),s("h2",{attrs:{id:"难道-这就是这副身躯的极限了吗"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#难道-这就是这副身躯的极限了吗"}},[a._v("#")]),a._v(" 难道...这就是这副身躯的极限了吗......")]),a._v(" "),s("p",[a._v("语法错误、配置错误、权限错误、不熟悉linux....随处可见的绊脚石，难道这就是这副身躯的极限了吗...还有其他解决方法吗？")]),a._v(" "),s("p",[a._v("有的有的，兄弟！")]),a._v(" "),s("p",[a._v("做了那么久，发现我也是只猴子，分享一个简单的方法来"),s("code",[a._v("优雅")]),a._v("地实现这个作业")]),a._v(" "),s("p",[a._v("或许你也可以"),s("code",[a._v("思路清晰")]),a._v("、"),s("code",[a._v("脚踏实地")]),s("s",[a._v("投机取巧、瞒天过海")]),a._v("，摆脱配置文件的烦扰，完成作业")]),a._v(" "),s("p",[a._v("推荐"),s("code",[a._v("windows")]),a._v("软件"),s("code",[a._v("小皮面板")]),a._v("，"),s("a",{attrs:{href:"https://public.xp.cn/upgrades/phpStudy_64.zip",target:"_blank",rel:"noopener noreferrer"}},[a._v("点击下载小皮面板"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/24.png",alt:"24"}})]),a._v(" "),s("p",[a._v("到左侧的ftp栏配置ftp")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/25.png",alt:"25"}})]),a._v(" "),s("p",[a._v("配置对应用户的权限")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/26.png",alt:"26"}})]),a._v(" "),s("p",[a._v("简单验证")]),a._v(" "),s("p",[s("img",{attrs:{src:"/medias/ftp%E6%90%AD%E5%BB%BA/27.png",alt:"27"}})]),a._v(" "),s("p",[a._v("最后，测试后建议及时关闭，避免因不安全的ftp用户、权限配置引发安全问题")]),a._v(" "),s("p",[a._v("参考、致谢：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/Wine_streetQAQ/article/details/129719390",target:"_blank",rel:"noopener noreferrer"}},[a._v("centos 是否最小化安装 centos7最小化安装步骤"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1829993",target:"_blank",rel:"noopener noreferrer"}},[a._v("服务器安装Centos7"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/keepkind/article/details/128890618",target:"_blank",rel:"noopener noreferrer"}},[a._v("centos解决不显示ipv4"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/branwel/article/details/102907927",target:"_blank",rel:"noopener noreferrer"}},[a._v("解决Centos-7 修改DNS后还无法解析地址问题"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/yxyc666/article/details/141705431",target:"_blank",rel:"noopener noreferrer"}},[a._v("Centos7将yum源更换为国内源保姆级教程"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/lorogy/article/details/136171858",target:"_blank",rel:"noopener noreferrer"}},[a._v("【centos】【vsftpd】FTP本地用户登录配置"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://www.bigbey.com/archives/cd73d9e8-1dd6-45df-8235-44d47e8535f9https://www.bigbey.com/archives/cd73d9e8-1dd6-45df-8235-44d47e8535f9",target:"_blank",rel:"noopener noreferrer"}},[a._v("FTP上传文件，报553 Could not create file"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://developer.aliyun.com/article/1099383",target:"_blank",rel:"noopener noreferrer"}},[a._v("CentOS7下vsftpd over SSL/TLS加密传输配置实践"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://help.aliyun.com/zh/ecs/how-to-construct-vsftp-and-configure-virtual-users#noPMw",target:"_blank",rel:"noopener noreferrer"}},[a._v("如何搭建VSFTP及配置虚拟用户"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);